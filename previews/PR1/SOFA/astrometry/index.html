<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Astrometry · AstroCouch.jl</title><meta name="title" content="Astrometry · AstroCouch.jl"/><meta property="og:title" content="Astrometry · AstroCouch.jl"/><meta property="twitter:title" content="Astrometry · AstroCouch.jl"/><meta name="description" content="Documentation for AstroCouch.jl."/><meta property="og:description" content="Documentation for AstroCouch.jl."/><meta property="twitter:description" content="Documentation for AstroCouch.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">The SOFA sub-package</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Introduction</a></li><li class="is-active"><a class="tocitem" href>Astrometry</a></li><li><a class="tocitem" href="../calendars/">Calendars</a></li><li><a class="tocitem" href="../coefficients/">Coefficients</a></li><li><a class="tocitem" href="../ecliptic/">Ecliptic</a></li><li><a class="tocitem" href="../ephemerides/">Ephemerides</a></li><li><a class="tocitem" href="../equatorial/">Equatorial</a></li><li><a class="tocitem" href="../galactic/">Galactic</a></li><li><a class="tocitem" href="../geocentric/">Geocentric</a></li><li><a class="tocitem" href="../gnomonic/">Gnomonic</a></li><li><a class="tocitem" href="../precession/">Precession</a></li><li><a class="tocitem" href="../rotations/">Rotations</a></li><li><a class="tocitem" href="../spacemotion/">Space Motion</a></li><li><a class="tocitem" href="../starcatalogs/">Star Catalogs</a></li><li><a class="tocitem" href="../timescales/">Timescales</a></li><li><a class="tocitem" href="../vectorops/">Vectorops</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">The SOFA sub-package</a></li><li class="is-active"><a href>Astrometry</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Astrometry</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tamasgal/AstroCouch.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tamasgal/AstroCouch.jl/blob/main/docs/src/SOFA/astrometry.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="astrometry.jl"><a class="docs-heading-anchor" href="#astrometry.jl">astrometry.jl</a><a id="astrometry.jl-1"></a><a class="docs-heading-anchor-permalink" href="#astrometry.jl" title="Permalink"></a></h1><p>Missing docs:</p><ul><li>SOFA.eraApci</li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.ab" href="#AstroCouch.SOFA.ab"><code>AstroCouch.SOFA.ab</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ab(pnat::Vector{Float64}, v::Vector{Float64}, s::Float64, bm1::Float64)</code></pre><p>Apply aberration to transform natural direction into proper direction.</p><p><strong>Input</strong></p><ul><li><code>pnat</code> –  natural direction to source (unit vector).</li><li><code>v</code>    – observer barycentric velocity in units of light speed.</li><li><code>s</code>    – distance between the Sun and the observer in units of AU.</li><li><code>bm1</code>  – inverse Lorenz factor, i.e., (sqrt(1-v^2)).</li></ul><p><strong>Output</strong></p><ul><li><code>p</code>    – proper direction to source (unit vector).</li></ul><p><strong>Note</strong></p><ol><li><p>The algorithm is based on Expr. (7.40) in the Explanatory Supplement (Urban &amp; Seidelmann 2013), but with the following changes:</p><p>o  Rigorous rather than approximate normalization is applied.</p><p>o  The gravitational potential term from Expr. (7) in Klioner    (2003) is added, taking into account only the Sun&#39;s    contribution.  This has a maximum effect of about 0.4    microarcsecond.</p></li><li><p>In almost all cases, the maximum accuracy will be limited by the supplied velocity.  For example, if the ERFA eraEpv00 function is used, errors of up to 5 microarcseconds could occur.</p></li></ol><p><strong>References</strong></p><p>Urban, S. &amp; Seidelmann, P. K. (eds), Explanatory Supplement to the Astronomical Almanac, 3rd ed., University Science Books (2013).</p><p>Klioner, Sergei A., &quot;A practical relativistic model for micro- arcsecond astrometry in space&quot;, Astr. J. 125, 1580-1597 (2003).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L3-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apcg" href="#AstroCouch.SOFA.apcg"><code>AstroCouch.SOFA.apcg</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apcg(day1::Float64, day2::Float64, ebpv::Vector{Vector{Float64}},
     ehp::Vector{Float64})</code></pre><p>For a geocentric observer, prepare star-independent astrometry paramenters for transformations between ICRS and GCRS coordinates. The Earth ephemeris is supplied by the caller.</p><p>The parameters produced by this function are required in the parallax, light deflection and aberration parts of the astrometric transformation chain.</p><p><strong>Input</strong></p><ul><li><code>day1</code>   – TDB as a 2-part...</li><li><code>day2</code>   – ...Julian Date (Note 1)</li><li><code>ebpv</code>   – Earth barycentric pos/vel (AU, AU/day)</li><li><code>ehp</code>    – Earth heliocentric position (AU)</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any</p><p>convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">  date1          date2
2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li><li><p>All the vectors are with respect to BCRS axes.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><pre><code class="nohighlight hljs"> functions         observer        transformation

apcg apcg13    geocentric      ICRS &lt;-&gt; GCRS
apci apci13    terrestrial     ICRS &lt;-&gt; CIRS
apco apco13    terrestrial     ICRS &lt;-&gt; observed
apcs apcs13    space           ICRS &lt;-&gt; GCRS
aper aper13    terrestrial     update Earth rotation
apio apio13    terrestrial     CIRS &lt;-&gt; observed</code></pre><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used by eraAtciq* and eraAticq*.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L50-L130">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apcg13" href="#AstroCouch.SOFA.apcg13"><code>AstroCouch.SOFA.apcg13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apcg13(day1::Float64, day2::Float64)</code></pre><p>For a geocentric observer, prepare star-independent astrometry parameters for transformations between ICRS and GCRS coordinates.  The caller supplies the date, and ERFA models are used to predict the Earth ephemeris.</p><p>The parameters produced by this function are required in the parallax, light deflection and aberration parts of the astrometric transformation chain.</p><p><strong>Input</strong></p><ul><li><code>day1</code>   – TDB as a 2-part...</li><li><code>day2</code>   – ...Julian Date (Note 1)</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li><li><p>All the vectors are with respect to BCRS axes.</p></li><li><p>In cases where the caller wishes to supply his own Earth ephemeris, the function eraApcg can be used instead of the present function.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><p>functions       observer        transformation</p><p>apcg apcg13    geocentric      ICRS &lt;-&gt; GCRS   apci apci13    terrestrial     ICRS &lt;-&gt; CIRS   apco apco13    terrestrial     ICRS &lt;-&gt; observed   apcs apcs13    space           ICRS &lt;-&gt; GCRS   aper aper13    terrestrial     update Earth rotation   apio apio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used by atciq* and aticq*.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L137-L219">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apci" href="#AstroCouch.SOFA.apci"><code>AstroCouch.SOFA.apci</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apci(day1::Float64, day2::Float64, ebpv::Vector{Vector{Float64}},
     ehp::Vector{Float64}, x::Float64, y::Float64, s::Float64)</code></pre><p>For a terrestrial observer, prepare star-independent astrometry parameters for transformations between ICRS and geocentric CIRS coordinates.  The Earth ephemeris and CIP/CIO are supplied by the caller.</p><p>The parameters produced by this function are required in the parallax, light deflection, aberration, and bias-precession-nutation parts of the astrometric transformation chain.</p><p><strong>Input</strong></p><ul><li><code>day1</code>   – TDB as a 2-part...</li><li><code>day2</code>   – ...Julian Date (Note 1)</li><li><code>ebpv</code>   – Earth barycentric position/velocity (AU, AU/day)</li><li><code>ehp</code>    – Earth heliocentric position (AU)</li><li><code>x, y</code>   – CIP X,Y (components of unit vector)</li><li><code>s</code>      – the CIO locator s (radians)</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters</li></ul><p><strong>Note</strong></p><ol><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li><li><p>All the vectors are with respect to BCRS axes.</p></li><li><p>In cases where the caller does not wish to provide the Earth ephemeris and CIP/CIO, the function eraApci13 can be used instead of the present function.  This computes the required quantities using other ERFA functions.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><p>functions       observer        transformation</p><p>apcg apcg13    geocentric      ICRS &lt;-&gt; GCRS   apci apci13    terrestrial     ICRS &lt;-&gt; CIRS   apco apco13    terrestrial     ICRS &lt;-&gt; observed   apcs apcs13    space           ICRS &lt;-&gt; GCRS   aper aper13    terrestrial     update Earth rotation   apio apio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used by atciq and aticq.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L227-L315">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apci13" href="#AstroCouch.SOFA.apci13"><code>AstroCouch.SOFA.apci13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apci13(day1::Float64, day2::Float64)</code></pre><p>For a terrestrial observer, prepare star-independent astrometry parameters for transformations between ICRS and geocentric CIRS coordinates.  The caller supplies the date, and ERFA models are used to predict the Earth ephemeris and CIP/CIO.</p><p>The parameters produced by this function are required in the parallax, light deflection, aberration, and bias-precession-nutation parts of the astrometric transformation chain.</p><p><strong>Input</strong></p><ul><li><code>date1</code>  – TDB as a 2-part...</li><li><code>date2</code>  – ...Julian Date (Note 1)</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li><li><p>All the vectors are with respect to BCRS axes.</p></li><li><p>In cases where the caller wishes to supply his own Earth ephemeris and CIP/CIO, the function eraApci can be used instead of the present function.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><p>functions       observer        transformation</p><p>apcg apcg13    geocentric      ICRS &lt;-&gt; GCRS   apci apci13    terrestrial     ICRS &lt;-&gt; CIRS   apco apco13    terrestrial     ICRS &lt;-&gt; observed   apcs apcs13    space           ICRS &lt;-&gt; GCRS   aper aper13    terrestrial     update Earth rotation   apio apio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used by atciq and aticq.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L324-L406">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apco" href="#AstroCouch.SOFA.apco"><code>AstroCouch.SOFA.apco</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apco(day1::Float64, day2::Float64, ebpv::Vector{Vector{Float64}},
     ehp::Vector{Float64}, x::Float64, y::Float64, s::Float64,
     θ::Float64, elong::Float64, ϕ::Float64, hm::Float64,
     xp::Float64, yp::Float64, sp::Float64, refa::Float64, refb::Float64)</code></pre><p>For a terrestrial observer, prepare star-independent astrometry parameters for transformations between ICRS and observed coordinates. The caller supplies the Earth ephemeris, the Earth rotation information and the refraction constants as well as the site coordinates.</p><p><strong>Input</strong></p><ul><li><code>date1</code>  – TDB as a 2-part...</li><li><code>date2</code>  – ...Julian Date (Note 1)</li><li><code>ebpv</code>   – Earth barycentric PV (AU, AU/day, Note 2)</li><li><code>ehp</code>    – Earth heliocentric P (AU, Note 2)</li><li><code>x, y</code>   – CIP X,Y (components of unit vector)</li><li><code>s</code>      – the CIO locator s (radians)</li><li><code>theta</code>  – Earth rotation angle (radians)</li><li><code>elong</code>  – longitude (radians, east +ve, Note 3)</li><li><code>phi</code>    – latitude (geodetic, radians, Note 3)</li><li><code>hm</code>     – height above ellipsoid (m, geodetic, Note 3)</li><li><code>xp, yp</code> – polar motion coordinates (radians, Note 4)</li><li><code>sp</code>     – the TIO locator s&#39; (radians, Note 4)</li><li><code>refa</code>   – refraction constant A (radians, Note 5)</li><li><code>refb</code>   – refraction constant B (radians, Note 5)</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li><li><p>The vectors eb, eh, and all the astrom vectors, are with respect to BCRS axes.</p></li><li><p>The geographical coordinates are with respect to the ERFA_WGS84 reference ellipsoid.  TAKE CARE WITH THE LONGITUDE SIGN CONVENTION: the longitude required by the present function is right-handed, i.e. east-positive, in accordance with geographical convention.</p><p>The adjusted longitude stored in the astrom array takes into account the TIO locator and polar motion.</p></li><li><p>xp and yp are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions), measured along the meridians 0 and 90 deg west respectively.  sp is the TIO locator s&#39;, in radians, which positions the Terrestrial Intermediate Origin on the equator.  For many applications, xp, yp and (especially) sp can be set to zero.</p><p>Internally, the polar motion is stored in a form rotated onto the local meridian.</p></li><li><p>The refraction constants refa and refb are for use in a dZ = A<em>tan(Z)+B</em>tan^3(Z) model, where Z is the observed (i.e. refracted) zenith distance and dZ is the amount of refraction.</p></li><li><p>It is advisable to take great care with units, as even unlikely values of the input parameters are accepted and processed in accordance with the models used.</p></li><li><p>In cases where the caller does not wish to provide the Earth Ephemeris, the Earth rotation information and refraction constants, the function eraApco13 can be used instead of the present function. This starts from UTC and weather readings etc.  and computes suitable values using other ERFA functions.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><pre><code class="nohighlight hljs"> functions         observer        transformation</code></pre><p>eraApcg eraApcg13    geocentric      ICRS &lt;-&gt; GCRS   eraApci eraApci13    terrestrial     ICRS &lt;-&gt; CIRS   eraApco eraApco13    terrestrial     ICRS &lt;-&gt; observed   eraApcs eraApcs13    space           ICRS &lt;-&gt; GCRS   eraAper eraAper13    terrestrial     update Earth rotation   eraApio eraApio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used by eraAtioq, eraAtoiq, eraAtciq* and eraAticq*.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L422-L546">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apco13" href="#AstroCouch.SOFA.apco13"><code>AstroCouch.SOFA.apco13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apco13(day1::Float64, day2::Float64, dut1::Float64, elong::Float64,
       phi::Float64, hm::Float64, xp::Float64, yp::Float64,
       phpa::Float64, tc::Float64, rh::Float64, wl::Float64)</code></pre><p>For a terrestrial observer, prepare star-independent astrometry parameters for transformations between ICRS and observed coordinates. The caller supplies UTC, site coordinates, ambient air conditions and observing wavelength, and ERFA models are used to obtain the Earth ephemeris, CIP/CIO and refraction constants.</p><p>The parameters produced by this function are required in the parallax, light deflection, aberration, and bias-precession-nutation parts of the ICRS/CIRS transformations.</p><p><strong>Input</strong></p><ul><li><code>utc1</code>   – UTC as a 2-part...</li><li><code>utc2</code>   – ...quasi Julian Date (Notes 1,2)</li><li><code>dut1</code>   – UT1-UTC (seconds, Note 3)</li><li><code>elong</code>  – longitude (radians, east +ve, Note 4)</li><li><code>phi</code>    – latitude (geodetic, radians, Note 4)</li><li><code>hm</code>     – height above ellipsoid (m, geodetic, Notes 4,6)</li><li><code>xp, yp</code> – polar motion coordinates (radians, Note 5)</li><li><code>phpa</code>   – pressure at the observer (hPa = mB, Note 6)</li><li><code>tc</code>     – ambient temperature at the observer (deg C)</li><li><code>rh</code>     – relative humidity at the observer (range 0-1)</li><li><code>wl</code>     – wavelength (micrometers, Note 7)</li></ul><p><strong>Output</strong></p><ul><li>astrom`  – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>utc1+utc2 is quasi Julian Date (see Note 2), apportioned in any convenient way between the two arguments, for example where utc1 is the Julian Day Number and utc2 is the fraction of a day.</p><p>However, JD cannot unambiguously represent UTC during a leap second unless special measures are taken.  The convention in the present function is that the JD day represents UTC days whether the length is 86399, 86400 or 86401 SI seconds.</p><p>Applications should use the function eraDtf2d to convert from calendar date and time of day into 2-part quasi Julian Date, as it implements the leap-second-ambiguity convention just described.</p></li><li><p>The warning status &quot;dubious year&quot; flags UTCs that predate the introduction of the time scale or that are too far in the future to be trusted.  See eraDat for further details.</p></li><li><p>UT1-UTC is tabulated in IERS bulletins.  It increases by exactly one second at the end of each positive UTC leap second, introduced in order to keep UT1-UTC within +/- 0.9s.  n.b. This practice is under review, and in the future UT1-UTC may grow essentially without limit.</p></li><li><p>The geographical coordinates are with respect to the ERFA_WGS84 reference ellipsoid.  TAKE CARE WITH THE LONGITUDE SIGN: the longitude required by the present function is east-positive (i.e. right-handed), in accordance with geographical convention.</p></li><li><p>The polar motion xp,yp can be obtained from IERS bulletins.  The values are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.  For many applications, xp and yp can be set to zero.</p><p>Internally, the polar motion is stored in a form rotated onto the local meridian.</p></li><li><p>If hm, the height above the ellipsoid of the observing station in meters, is not known but phpa, the pressure in hPa (=mB), is available, an adequate estimate of hm can be obtained from the expression</p><pre><code class="nohighlight hljs">   hm = -29.3 * tsl * log ( phpa / 1013.25 );</code></pre><p>where tsl is the approximate sea-level air temperature in K (See Astrophysical Quantities, C.W.Allen, 3rd edition, section 52). Similarly, if the pressure phpa is not known, it can be estimated from the height of the observing station, hm, as follows:</p><pre><code class="nohighlight hljs">   phpa = 1013.25 * exp ( -hm / ( 29.3 * tsl ) );</code></pre><p>Note, however, that the refraction is nearly proportional to the pressure and that an accurate phpa value is important for precise work.</p></li><li><p>The argument wl specifies the observing wavelength in micrometers. The transition from optical to radio is assumed to occur at 100 micrometers (about 3000 GHz).</p></li><li><p>It is advisable to take great care with units, as even unlikely values of the input parameters are accepted and processed in accordance with the models used.</p></li><li><p>In cases where the caller wishes to supply his own Earth ephemeris, Earth rotation information and refraction constants, the function eraApco can be used instead of the present function.</p></li><li><p>This is one of several functions that inserts into the astrom  structure star-independent parameters needed for the chain of  astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and  portions of the transformation chain:</p><pre><code class="nohighlight hljs"> functions         observer        transformation</code></pre><p>eraApcg eraApcg13    geocentric      ICRS &lt;-&gt; GCRS   eraApci eraApci13    terrestrial     ICRS &lt;-&gt; CIRS   eraApco eraApco13    terrestrial     ICRS &lt;-&gt; observed   eraApcs eraApcs13    space           ICRS &lt;-&gt; GCRS   eraAper eraAper13    terrestrial     update Earth rotation   eraApio eraApio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to  compute the various ephemerides.  The others accept ephemerides  supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion,  parallax, light deflection, and aberration.  From GCRS to CIRS  comprises frame bias and precession-nutation.  From CIRS to  observed takes account of Earth rotation, polar motion, diurnal  aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS  transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used by  eraAtioq, eraAtoiq, eraAtciq* and eraAticq*.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L574-L706">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apcs" href="#AstroCouch.SOFA.apcs"><code>AstroCouch.SOFA.apcs</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apcs(day1::Float64, day2::Float64, pv::Vector{Vector{Float64}},
     ebpv::Vector{Vector{Float64}}, ehp::Vector{Float64})</code></pre><p>For an observer whose geocentric position and velocity are known, prepare star-independent astrometry parameters for transformations between ICRS and GCRS.  The Earth ephemeris is supplied by the caller.</p><p>The parameters produced by this function are required in the space motion, parallax, light deflection and aberration parts of the astrometric transformation chain.</p><p><strong>Input</strong></p><ul><li><code>day1</code>   – TDB as a 2-part...</li><li><code>day2</code>   – ...Julian Date (Note 1)</li><li><code>pv</code>     – observer&#39;s geocentric pos/vel (m, m/s)</li><li><code>ebpv</code>   – Earth barycentric PV (AU, AU/day)</li><li><code>ehp</code>    – Earth heliocentric P (AU)</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any</p><p>convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   day1          day2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li><li><p>All the vectors are with respect to BCRS axes.</p></li><li><p>Providing separate arguments for (i) the observer&#39;s geocentric position and velocity and (ii) the Earth ephemeris is done for convenience in the geocentric, terrestrial and Earth orbit cases. For deep space applications it maybe more convenient to specify zero geocentric position and velocity and to supply the observer&#39;s position and velocity information directly instead of with respect to the Earth.  However, note the different units: m and m/s for the geocentric vectors, AU and AU/day for the heliocentric and barycentric vectors.</p></li><li><p>In cases where the caller does not wish to provide the Earth ephemeris, the function eraApcs13 can be used instead of the present function.  This computes the Earth ephemeris using the ERFA function eraEpv00.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><pre><code class="nohighlight hljs"> functions        observer        transformation</code></pre><p>Apcg eraApcg13    geocentric      ICRS &lt;-&gt; GCRS   Apci eraApci13    terrestrial     ICRS &lt;-&gt; CIRS   Apco eraApco13    terrestrial     ICRS &lt;-&gt; observed   Apcs eraApcs13    space           ICRS &lt;-&gt; GCRS   Aper eraAper13    terrestrial     update Earth rotation   Apio eraApio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used by Atciq and Aticq.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L731-L828">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apcs13" href="#AstroCouch.SOFA.apcs13"><code>AstroCouch.SOFA.apcs13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apcs13(day1::Float64, day2::Float64, pv::Vector{Vector{Float64}})</code></pre><p>For an observer whose geocentric position and velocity are known, prepare star-independent astrometry parameters for transformations between ICRS and GCRS.  The Earth ephemeris is from ERFA models.</p><p>The parameters produced by this function are required in the space motion, parallax, light deflection and aberration parts of the astrometric transformation chain.</p><p><strong>Input</strong></p><ul><li><code>date1</code>  – TDB as a 2-part...</li><li><code>date2</code>  – ...Julian Date (Note 1)</li><li><code>pv</code>     – observer&#39;s geocentric pos/vel (Note 3)</li></ul><p><strong>Output</strong></p><ul><li>&#39;astrom` – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li><li><p>All the vectors are with respect to BCRS axes.</p></li><li><p>The observer&#39;s position and velocity pv are geocentric but with respect to BCRS axes, and in units of m and m/s.  No assumptions are made about proximity to the Earth, and the function can be used for deep space applications as well as Earth orbit and terrestrial.</p></li><li><p>In cases where the caller wishes to supply his own Earth ephemeris, the function eraApcs can be used instead of the present function.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><pre><code class="nohighlight hljs"> functions         observer        transformation</code></pre><p>eraApcg eraApcg13    geocentric      ICRS &lt;-&gt; GCRS   eraApci eraApci13    terrestrial     ICRS &lt;-&gt; CIRS   eraApco eraApco13    terrestrial     ICRS &lt;-&gt; observed   eraApcs eraApcs13    space           ICRS &lt;-&gt; GCRS   eraAper eraAper13    terrestrial     update Earth rotation   eraApio eraApio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used by eraAtciq* and eraAticq*.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L844-L930">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.aper" href="#AstroCouch.SOFA.aper"><code>AstroCouch.SOFA.aper</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aper(θ::Float64, a::Astrom)</code></pre><p>In the star-independent astrometry parameters, update only the Earth rotation angle, supplied by the caller explicitly.</p><p><strong>Input</strong></p><ul><li><code>theta</code>  – Earth rotation angle (radians, Note 2)</li><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>This function exists to enable sidereal-tracking applications to avoid wasteful recomputation of the bulk of the astrometry parameters: only the Earth rotation is updated.</p></li><li><p>For targets expressed as equinox based positions, such as classical geocentric apparent (RA,Dec), the supplied theta can be Greenwich apparent sidereal time rather than Earth rotation angle.</p></li><li><p>The function eraAper13 can be used instead of the present function, and starts from UT1 rather than ERA itself.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><pre><code class="nohighlight hljs"> functions         observer        transformation</code></pre><p>eraApcg eraApcg13    geocentric      ICRS &lt;-&gt; GCRS   eraApci eraApci13    terrestrial     ICRS &lt;-&gt; CIRS   eraApco eraApco13    terrestrial     ICRS &lt;-&gt; observed   eraApcs eraApcs13    space           ICRS &lt;-&gt; GCRS   eraAper eraAper13    terrestrial     update Earth rotation   eraApio eraApio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L938-L993">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.aper13" href="#AstroCouch.SOFA.aper13"><code>AstroCouch.SOFA.aper13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aper13(day1::Float64, day2::Float64, a::Astrom)</code></pre><p>In the star-independent astrometry parameters, update only the Earth rotation angle.  The caller provides UT1, (n.b. not UTC).</p><p><strong>Input</strong></p><ul><li><code>ut11</code>   – UT1 as a 2-part...</li><li><code>ut12</code>   – ...Julian Date (Note 1)</li><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>The UT1 date (n.b. not UTC) ut11+ut12 is a Julian Date, apportioned in any convenient way between the arguments ut11 and ut12.  For example, JD(UT1)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   ut11           ut12

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 and MJD methods are good compromises between resolution and convenience.  The date &amp; time method is best matched to the algorithm used: maximum precision is delivered when the ut11 argument is for 0hrs UT1 on the day in question and the ut12 argument lies in the range 0 to 1, or vice versa.</p></li><li><p>If the caller wishes to provide the Earth rotation angle itself, the function eraAper can be used instead.  One use of this technique is to substitute Greenwich apparent sidereal time and thereby to support equinox based transformations directly.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><pre><code class="nohighlight hljs"> functions         observer        transformation</code></pre><p>eraApcg eraApcg13    geocentric      ICRS &lt;-&gt; GCRS   eraApci eraApci13    terrestrial     ICRS &lt;-&gt; CIRS   eraApco eraApco13    terrestrial     ICRS &lt;-&gt; observed   eraApcs eraApcs13    space           ICRS &lt;-&gt; GCRS   eraAper eraAper13    terrestrial     update Earth rotation   eraApio eraApio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L999-L1069">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apio" href="#AstroCouch.SOFA.apio"><code>AstroCouch.SOFA.apio</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">apio(sp::Float64, θ::Float64, elong::Float64, ϕ::Float64, hm::Float64,
     xp::Float64, yp::Float64, refa::Float64, refb::Float64, a::Astrom)</code></pre><p>For a terrestrial observer, prepare star-independent astrometry parameters for transformations between CIRS and observed coordinates. The caller supplies the Earth orientation information and the refraction constants as well as the site coordinates.</p><p><strong>Input</strong></p><ul><li><code>sp</code>     – the TIO locator s&#39; (radians, Note 1)</li><li><code>theta</code>  – Earth rotation angle (radians)</li><li><code>elong</code>  – longitude (radians, east +ve, Note 2)</li><li><code>phi</code>    – geodetic latitude (radians, Note 2)</li><li><code>hm</code>     – height above ellipsoid (m, geodetic Note 2)</li><li><code>xp,yp</code>  – polar motion coordinates (radians, Note 3)</li><li><code>refa</code>   – refraction constant A (radians, Note 4)</li><li><code>refb</code>   – refraction constant B (radians, Note 4)</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>sp, the TIO locator s&#39;, is a tiny quantity needed only by the most precise applications.  It can either be set to zero or predicted using the ERFA function eraSp00.</p></li><li><p>The geographical coordinates are with respect to the ERFA_WGS84 reference ellipsoid.  TAKE CARE WITH THE LONGITUDE SIGN: the longitude required by the present function is east-positive (i.e. right-handed), in accordance with geographical convention.</p></li><li><p>The polar motion xp,yp can be obtained from IERS bulletins.  The values are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.  For many applications, xp and yp can be set to zero.</p><p>Internally, the polar motion is stored in a form rotated onto the local meridian.</p></li><li><p>The refraction constants refa and refb are for use in a dZ = A<em>tan(Z)+B</em>tan^3(Z) model, where Z is the observed (i.e. refracted) zenith distance and dZ is the amount of refraction.</p></li><li><p>It is advisable to take great care with units, as even unlikely values of the input parameters are accepted and processed in accordance with the models used.</p></li><li><p>In cases where the caller does not wish to provide the Earth rotation information and refraction constants, the function eraApio13 can be used instead of the present function.  This starts from UTC and weather readings etc. and computes suitable values using other ERFA functions.</p></li><li><p>This is one of several functions that inserts into the astrom structure star-independent parameters needed for the chain of astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and portions of the transformation chain:</p><pre><code class="nohighlight hljs"> functions         observer        transformation</code></pre><p>eraApcg eraApcg13    geocentric      ICRS &lt;-&gt; GCRS   eraApci eraApci13    terrestrial     ICRS &lt;-&gt; CIRS   eraApco eraApco13    terrestrial     ICRS &lt;-&gt; observed   eraApcs eraApcs13    space           ICRS &lt;-&gt; GCRS   eraAper eraAper13    terrestrial     update Earth rotation   eraApio eraApio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to compute the various ephemerides.  The others accept ephemerides supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion, parallax, light deflection, and aberration.  From GCRS to CIRS comprises frame bias and precession-nutation.  From CIRS to observed takes account of Earth rotation, polar motion, diurnal aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used by eraAtioq and eraAtoiq.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1074-L1162">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.apio13" href="#AstroCouch.SOFA.apio13"><code>AstroCouch.SOFA.apio13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs"> apio13(day1::Float64, day2::Float64, dut1::Float64, elong::Float64, ϕ::Float64,
        hm::Float64, xp::Float64, yp::Float64, phpa::Float64, tc::Float64,
        rh::Float64, wl::Float64, a::Astrom)</code></pre><p>For a terrestrial observer, prepare star-independent astrometry parameters for transformations between CIRS and observed coordinates. The caller supplies UTC, site coordinates, ambient air conditions and observing wavelength.</p><p><strong>Input</strong></p><ul><li><code>utc1</code>   – UTC as a 2-part...</li><li><code>utc2</code>   – ...quasi Julian Date (Notes 1,2)</li><li><code>dut1</code>   – UT1-UTC (seconds)</li><li><code>elong</code>  – longitude (radians, east +ve, Note 3)</li><li><code>phi</code>    – geodetic latitude (radians, Note 3)</li><li><code>hm</code>     – height above ellipsoid (m, geodetic Notes 4,6)</li><li><code>xp,yp</code>  – polar motion coordinates (radians, Note 5)</li><li><code>phpa</code>   – pressure at the observer (hPa = mB, Note 6)</li><li><code>tc</code>     – ambient temperature at the observer (deg C)</li><li><code>rh</code>     – relative humidity at the observer (range 0-1)</li><li><code>wl</code>     – wavelength (micrometers, Note 7)</li></ul><p><strong>Output</strong></p><ul><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Note</strong></p><ol><li><p>utc1+utc2 is quasi Julian Date (see Note 2), apportioned in any convenient way between the two arguments, for example where utc1 is the Julian Day Number and utc2 is the fraction of a day.</p><p>However, JD cannot unambiguously represent UTC during a leap second unless special measures are taken.  The convention in the present function is that the JD day represents UTC days whether the length is 86399, 86400 or 86401 SI seconds.</p><p>Applications should use the function eraDtf2d to convert from calendar date and time of day into 2-part quasi Julian Date, as it implements the leap-second-ambiguity convention just described.</p></li><li><p>The warning status &quot;dubious year&quot; flags UTCs that predate the introduction of the time scale or that are too far in the future to be trusted.  See eraDat for further details.</p></li><li><p>UT1-UTC is tabulated in IERS bulletins.  It increases by exactly one second at the end of each positive UTC leap second, introduced in order to keep UT1-UTC within +/- 0.9s.  n.b. This practice is under review, and in the future UT1-UTC may grow essentially without limit.</p></li><li><p>The geographical coordinates are with respect to the ERFA_WGS84 reference ellipsoid.  TAKE CARE WITH THE LONGITUDE SIGN: the longitude required by the present function is east-positive (i.e. right-handed), in accordance with geographical convention.</p></li><li><p>The polar motion xp,yp can be obtained from IERS bulletins.  The values are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.  For many applications, xp and yp can be set to zero.</p><p>Internally, the polar motion is stored in a form rotated onto the local meridian.</p></li><li><p>If hm, the height above the ellipsoid of the observing station in meters, is not known but phpa, the pressure in hPa (=mB), is available, an adequate estimate of hm can be obtained from the expression</p><pre><code class="nohighlight hljs">   hm = -29.3 * tsl * log ( phpa / 1013.25 );</code></pre><p>where tsl is the approximate sea-level air temperature in K (See Astrophysical Quantities, C.W.Allen, 3rd edition, section 52). Similarly, if the pressure phpa is not known, it can be estimated from the height of the observing station, hm, as follows:</p><pre><code class="nohighlight hljs">   phpa = 1013.25 * exp ( -hm / ( 29.3 * tsl ) );</code></pre><p>Note, however, that the refraction is nearly proportional to the pressure and that an accurate phpa value is important for precise work.</p></li><li><p>The argument wl specifies the observing wavelength in micrometers. The transition from optical to radio is assumed to occur at 100 micrometers (about 3000 GHz).</p></li><li><p>It is advisable to take great care with units, as even unlikely values of the input parameters are accepted and processed in accordance with the models used.</p></li><li><p>In cases where the caller wishes to supply his own Earth rotation information and refraction constants, the function eraApc can be used instead of the present function.</p></li><li><p>This is one of several functions that inserts into the astrom  structure star-independent parameters needed for the chain of  astrometric transformations ICRS &lt;-&gt; GCRS &lt;-&gt; CIRS &lt;-&gt; observed.</p><p>The various functions support different classes of observer and  portions of the transformation chain:</p><pre><code class="nohighlight hljs"> functions         observer        transformation</code></pre><p>eraApcg eraApcg13    geocentric      ICRS &lt;-&gt; GCRS   eraApci eraApci13    terrestrial     ICRS &lt;-&gt; CIRS   eraApco eraApco13    terrestrial     ICRS &lt;-&gt; observed   eraApcs eraApcs13    space           ICRS &lt;-&gt; GCRS   eraAper eraAper13    terrestrial     update Earth rotation   eraApio eraApio13    terrestrial     CIRS &lt;-&gt; observed</p><p>Those with names ending in &quot;13&quot; use contemporary ERFA models to  compute the various ephemerides.  The others accept ephemerides  supplied by the caller.</p><p>The transformation from ICRS to GCRS covers space motion,  parallax, light deflection, and aberration.  From GCRS to CIRS  comprises frame bias and precession-nutation.  From CIRS to  observed takes account of Earth rotation, polar motion, diurnal  aberration and parallax (unless subsumed into the ICRS &lt;-&gt; GCRS  transformation), and atmospheric refraction.</p></li><li><p>The context structure astrom produced by this function is used  by eraAtioq and eraAtoiq.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1184-L1312">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atcc13" href="#AstroCouch.SOFA.atcc13"><code>AstroCouch.SOFA.atcc13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atcc13(rc::Float64, dc::Float64, pr::Float64, pd::Float64, px::Float64,
       rv::Float64, day1::Float64, day2::Float64)</code></pre><p>Transform a star&#39;s ICRS catalog entry (epoch J2000.0) into ICRS astrometric place.</p><p><strong>Input</strong></p><ul><li><code>rc</code>    – ICRS right ascension at J2000.0 (radians, Note 1)</li><li><code>dc</code>    – ICRS declination at J2000.0 (radians, Note 1)</li><li><code>pr</code>    – RA proper motion (radians/year, Note 2)</li><li><code>pd</code>    – Dec proper motion (radians/year)</li><li><code>px</code>    – parallax (arcsec)</li><li><code>rv</code>    – radial velocity (km/s, +ve if receding)</li><li><code>date1</code> – TDB as a 2-part...</li><li><code>date2</code> – ...Julian Date (Note 3)</li></ul><p><strong>Output</strong></p><ul><li>ra, da` – ICRS astrometric RA,Dec (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>Star data for an epoch other than J2000.0 (for example from the Hipparcos catalog, which has an epoch of J1991.25) will require a preliminary call to eraPmsafe before use.</p></li><li><p>The proper motion in RA is dRA/dt rather than cos(Dec)*dRA/dt.</p></li><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1326-L1380">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atccq" href="#AstroCouch.SOFA.atccq"><code>AstroCouch.SOFA.atccq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atccq(rc::Float64, dc::Float64, pr::Float64, pd::Float64, px::Float64,
      rv::Float64, a::Astrom)</code></pre><p>Quick transformation of a star&#39;s ICRS catalog entry (epoch J2000.0) into ICRS astrometric place, given precomputed star-independent astrometry parameters.</p><p>Use of this function is appropriate when efficiency is important and where many star positions are to be transformed for one date.  The star-independent parameters can be obtained by calling one of the functions eraApci[13], eraApcg[13], eraApco[13] or eraApcs[13].</p><p>If the parallax and proper motions are zero the transformation has no effect.</p><p><strong>Input</strong></p><ul><li>`rc,dc   – ICRS RA,Dec at J2000.0 (radians)</li><li>`pr      – RA proper motion (radians/year, Note 3)</li><li>`pd      – Dec proper motion (radians/year)</li><li>`px      – parallax (arcsec)</li><li>`rv      – radial velocity (km/s, +ve if receding)</li><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Output</strong></p><ul><li><code>ra, dec</code> – RA, Dec of computed place</li></ul><p><strong>Note</strong></p><ol><li><p>All the vectors are with respect to BCRS axes.</p></li><li><p>Star data for an epoch other than J2000.0 (for example from the Hipparcos catalog, which has an epoch of J1991.25) will require a preliminary call to eraPmsafe before use.</p></li><li><p>The proper motion in RA is dRA/dt rather than cos(Dec)*dRA/dt.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1388-L1427">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atci13" href="#AstroCouch.SOFA.atci13"><code>AstroCouch.SOFA.atci13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atci13(rc::Float64, dc::Float64, pr::Float64, pd::Float64, px::Float64,
       rv::Float64, day1::Float64, day2::Float64)</code></pre><p>Transform ICRS star data, epoch J2000.0, to CIRS.</p><p><strong>Input</strong></p><ul><li><code>rc</code>    – ICRS right ascension at J2000.0 (radians, Note 1)</li><li><code>dc</code>    – ICRS declination at J2000.0 (radians, Note 1)</li><li><code>pr</code>    – RA proper motion (radians/year, Note 2)</li><li><code>pd</code>    – Dec proper motion (radians/year)</li><li><code>px</code>    – parallax (arcsec)</li><li><code>rv</code>    – radial velocity (km/s, +ve if receding)</li><li><code>date1</code> – TDB as a 2-part...</li><li><code>date2</code> – ...Julian Date (Note 3)</li></ul><p><strong>Output</strong></p><ul><li><code>ri, di</code> – CIRS geocentric RA,Dec (radians)</li><li><code>eo</code>     – equation of the origins (ERA-GST, Note 5)</li></ul><p><strong>Note</strong></p><ol><li><p>Star data for an epoch other than J2000.0 (for example from the Hipparcos catalog, which has an epoch of J1991.25) will require a preliminary call to eraPmsafe before use.</p></li><li><p>The proper motion in RA is dRA/dt rather than cos(Dec)*dRA/dt.</p></li><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li><li><p>The available accuracy is better than 1 milliarcsecond, limited mainly by the precession-nutation model that is used, namely IAU 2000A/2006.  Very close to solar system bodies, additional errors of up to several milliarcseconds can occur because of unmodeled light deflection; however, the Sun&#39;s contribution is taken into account, to first order.  The accuracy limitations of the ERFA function eraEpv00 (used to compute Earth position and velocity) can contribute aberration errors of up to 5 microarcseconds.  Light deflection at the Sun&#39;s limb is uncertain at the 0.4 mas level.</p></li><li><p>Should the transformation to (equinox based) apparent place be required rather than (CIO based) intermediate place, subtract the equation of the origins from the returned right ascension: RA = RI</p><ul><li>EO. (The eraAnp function can then be applied, as required, to</li></ul><p>keep the result in the conventional 0-2pi range.)</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1436-L1505">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atciq" href="#AstroCouch.SOFA.atciq"><code>AstroCouch.SOFA.atciq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atciq(rc::Float64, dc::Float64, pr::Float64, pd::Float64, px::Float64,
      rv::Float64, a::Astrom)</code></pre><p>Quick ICRS, epoch J2000.0, to CIRS transformation, given precomputed star-independent astrometry parameters.</p><p>Use of this function is appropriate when efficiency is important and where many star positions are to be transformed for one date.  The star-independent parameters can be obtained by calling one of the functions eraApci[13], eraApcg[13], eraApco[13] or eraApcs[13].</p><p>If the parallax and proper motions are zero the eraAtciqz function can be used instead.</p><p><strong>Input</strong></p><ul><li><code>rc, dc</code> – ICRS RA,Dec at J2000.0 (radians, Note 1)</li><li><code>pr</code>     – RA proper motion (radians/year, Note 2)</li><li><code>pd</code>     – Dec proper motion (radians/year)</li><li><code>px</code>     – parallax (arcsec)</li><li><code>rv</code>     – radial velocity (km/s, +ve if receding)</li><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Output</strong></p><ul><li><code>ra, dec</code> – RA, Dec of transformed coordinates.</li></ul><p><strong>Note</strong></p><ol><li><p>Star data for an epoch other than J2000.0 (for example from the Hipparcos catalog, which has an epoch of J1991.25) will require a preliminary call to eraPmsafe before use.</p></li><li><p>The proper motion in RA is dRA/dt rather than cos(Dec)*dRA/dt.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1515-L1551">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atciqn" href="#AstroCouch.SOFA.atciqn"><code>AstroCouch.SOFA.atciqn</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atciqn(rc::Float64, dc::Float64, pr::Float64, pd::Float64, px::Float64,
       rv::Float64, a::Astrom, n::Int, b::Vector{Ldbody})</code></pre><p>Quick ICRS, epoch J2000.0, to CIRS transformation, given precomputed star-independent astrometry parameters plus a list of light- deflecting bodies.</p><p>Use of this function is appropriate when efficiency is important and where many star positions are to be transformed for one date.  The star-independent parameters can be obtained by calling one of the functions eraApci[13], eraApcg[13], eraApco[13] or eraApcs[13].</p><p>If the only light-deflecting body to be taken into account is the Sun, the eraAtciq function can be used instead.  If in addition the parallax and proper motions are zero, the eraAtciqz function can be used.</p><p><strong>Input</strong></p><ul><li><code>rc, dc</code> – ICRS RA,Dec at J2000.0 (radians)</li><li><code>pr</code>     – RA proper motion (radians/year, Note 3)</li><li><code>pd</code>     – Dec proper motion (radians/year)</li><li><code>px</code>     – parallax (arcsec)</li><li><code>rv</code>     – radial velocity (km/s, +ve if receding)</li><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Output</strong></p><ul><li><code>ri, di</code> – CIRS RA,Dec (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>Star data for an epoch other than J2000.0 (for example from the Hipparcos catalog, which has an epoch of J1991.25) will require a preliminary call to eraPmsafe before use.</p></li><li><p>The proper motion in RA is dRA/dt rather than cos(Dec)*dRA/dt.</p></li><li><p>The struct b contains n entries, one for each body to be considered.  If n = 0, no gravitational light deflection will be applied, not even for the Sun.</p></li><li><p>The struct b should include an entry for the Sun as well as for any planet or other body to be taken into account.  The entries should be in the order in which the light passes the body.</p></li><li><p>In the entry in the b struct for body i, the mass parameter b[i].bm can, as required, be adjusted in order to allow for such effects as quadrupole field.</p></li><li><p>The deflection limiter parameter b[i].dl is phi^2/2, where phi is the angular separation (in radians) between star and body at which limiting is applied.  As phi shrinks below the chosen threshold, the deflection is artificially reduced, reaching zero for phi = 0. Example values suitable for a terrestrial observer, together with masses, are as follows:</p><p>body i     b[i].bm        b[i].dl</p><p>Sun        1.0            6e-6    Jupiter    0.00095435     3e-9    Saturn     0.00028574     3e-10</p></li><li><p>For efficiency, validation of the contents of the b array is omitted.  The supplied masses must be greater than zero, the position and velocity vectors must be right, and the deflection limiter greater than zero.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1563-L1631">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atciqz" href="#AstroCouch.SOFA.atciqz"><code>AstroCouch.SOFA.atciqz</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atciqz(rc::Float64, dc::Float64, a::Astrom)</code></pre><p>Quick ICRS to CIRS transformation, given precomputed star- independent astrometry parameters, and assuming zero parallax and proper motion.</p><p>Use of this function is appropriate when efficiency is important and where many star positions are to be transformed for one date.  The star-independent parameters can be obtained by calling one of the functions eraApci[13], eraApcg[13], eraApco[13] or eraApcs[13].</p><p>The corresponding function for the case of non-zero parallax and proper motion is eraAtciq.</p><p><strong>Input</strong></p><ul><li><code>rc</code>    – ICRS astrometric RA (radians)</li><li><code>dc</code>    – ICRS astrometric Dec (radians)</li><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Output</strong></p><ul><li><code>ri, di</code> – CIRS RA,Dec (radians)</li></ul><p><strong>Note</strong></p><p>All the vectors are with respect to BCRS axes.</p><p><strong>References</strong></p><p>Urban, S. &amp; Seidelmann, P. K. (eds), Explanatory Supplement to the Astronomical Almanac, 3rd ed., University Science Books (2013).</p><p>Klioner, Sergei A., &quot;A practical relativistic model for micro- arcsecond astrometry in space&quot;, Astr. J. 125, 1580-1597 (2003).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1646-L1682">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atco13" href="#AstroCouch.SOFA.atco13"><code>AstroCouch.SOFA.atco13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atco13(rc::Float64, dc::Float64, pr::Float64, pd::Float64, px::Float64,
       rv::Float64, utc1::Float64, utc2::Float64, dut1::Float64,
       elong::Float64, ϕ::Float64, rm::Float64, xp::Float64, yp::Float64,
       phpa::Float64, tc::Float64, rh::Float64, wl::Float64)</code></pre><p>ICRS RA,Dec to observed place.  The caller supplies UTC, site coordinates, ambient air conditions and observing wavelength.</p><p>SOFA models are used for the Earth ephemeris, bias-precession- nutation, Earth orientation and refraction.</p><p><strong>Input</strong></p><ul><li><code>rc, dc</code> – ICRS right ascension at J2000.0 (radians, Note 1)</li><li><code>pr</code>     – RA proper motion (radians/year, Note 2)</li><li><code>pd</code>     – Dec proper motion (radians/year)</li><li><code>px</code>     – parallax (arcsec)</li><li><code>rv</code>     – radial velocity (km/s, +ve if receding)</li><li><code>utc1</code>   – UTC as a 2-part...</li><li><code>utc2</code>   – ...quasi Julian Date (Notes 3-4)</li><li><code>dut1</code>   – UT1-UTC (seconds, Note 5)</li><li><code>elong</code>  – longitude (radians, east +ve, Note 6)</li><li><code>phi</code>    – latitude (geodetic, radians, Note 6)</li><li><code>hm</code>     – height above ellipsoid (m, geodetic, Notes 6,8)</li><li><code>xp, yp</code> – polar motion coordinates (radians, Note 7)</li><li><code>phpa</code>   – pressure at the observer (hPa = mB, Note 8)</li><li><code>tc</code>     – ambient temperature at the observer (deg C)</li><li><code>rh</code>     – relative humidity at the observer (range 0-1)</li><li><code>wl</code>     – wavelength (micrometers, Note 9)</li></ul><p><strong>Output</strong></p><ul><li><code>aob</code>    – observed azimuth (radians: N=0,E=90)</li><li><code>zob</code>    – observed zenith distance (radians)</li><li><code>hob</code>    – observed hour angle (radians)</li><li><code>dob</code>    – observed declination (radians)</li><li><code>rob</code>    – observed right ascension (CIO-based, radians)</li><li><code>eo</code>     – equation of the origins (ERA-GST)</li></ul><p><strong>Note</strong></p><ol><li><p>Star data for an epoch other than J2000.0 (for example from the Hipparcos catalog, which has an epoch of J1991.25) will require a preliminary call to eraPmsafe before use.</p></li><li><p>The proper motion in RA is dRA/dt rather than cos(Dec)*dRA/dt.</p></li><li><p>utc1+utc2 is quasi Julian Date (see Note 2), apportioned in any convenient way between the two arguments, for example where utc1 is the Julian Day Number and utc2 is the fraction of a day.</p><p>However, JD cannot unambiguously represent UTC during a leap second unless special measures are taken.  The convention in the present function is that the JD day represents UTC days whether the length is 86399, 86400 or 86401 SI seconds.</p><p>Applications should use the function eraDtf2d to convert from calendar date and time of day into 2-part quasi Julian Date, as it implements the leap-second-ambiguity convention just described.</p></li><li><p>The warning status &quot;dubious year&quot; flags UTCs that predate the introduction of the time scale or that are too far in the future to be trusted.  See eraDat for further details.</p></li><li><p>UT1-UTC is tabulated in IERS bulletins.  It increases by exactly one second at the end of each positive UTC leap second, introduced in order to keep UT1-UTC within +/- 0.9s.  n.b. This practice is under review, and in the future UT1-UTC may grow essentially without limit.</p></li><li><p>The geographical coordinates are with respect to the ERFA_WGS84 reference ellipsoid.  TAKE CARE WITH THE LONGITUDE SIGN: the longitude required by the present function is east-positive (i.e. right-handed), in accordance with geographical convention.</p><ol><li>The polar motion xp,yp can be obtained from IERS bulletins.  The</li></ol><p>values are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.  For many applications, xp and yp can be set to zero.</p></li><li><p>If hm, the height above the ellipsoid of the observing station in meters, is not known but phpa, the pressure in hPa (=mB), is available, an adequate estimate of hm can be obtained from the expression</p><pre><code class="nohighlight hljs">   hm = -29.3 * tsl * log ( phpa / 1013.25 );</code></pre><p>where tsl is the approximate sea-level air temperature in K (See Astrophysical Quantities, C.W.Allen, 3rd edition, section 52). Similarly, if the pressure phpa is not known, it can be estimated from the height of the observing station, hm, as follows:</p><pre><code class="nohighlight hljs">   phpa = 1013.25 * exp ( -hm / ( 29.3 * tsl ) );</code></pre><p>Note, however, that the refraction is nearly proportional to the pressure and that an accurate phpa value is important for precise work.</p></li><li><p>The argument wl specifies the observing wavelength in micrometers. The transition from optical to radio is assumed to occur at 100 micrometers (about 3000 GHz).</p></li><li><p>The accuracy of the result is limited by the corrections for  refraction, which use a simple A<em>tan(z) + B</em>tan^3(z) model.  Providing the meteorological parameters are known accurately and  there are no gross local effects, the predicted observed  coordinates should be within 0.05 arcsec (optical) or 1 arcsec  (radio) for a zenith distance of less than 70 degrees, better than  30 arcsec (optical or radio) at 85 degrees and better than 20  arcmin (optical) or 30 arcmin (radio) at the horizon.</p><p>Without refraction, the complementary functions eraAtco13 and  eraAtoc13 are self-consistent to better than 1 microarcsecond all  over the celestial sphere.  With refraction included, consistency  falls off at high zenith distances, but is still better than 0.05  arcsec at 85 degrees.</p></li><li><p>&quot;Observed&quot; Az,ZD means the position that would be seen by a  perfect geodetically aligned theodolite.  (Zenith distance is used  rather than altitude in order to reflect the fact that no  allowance is made for depression of the horizon.)  This is related  to the observed HA,Dec via the standard rotation, using the  geodetic latitude (corrected for polar motion), while the observed  HA and RA are related simply through the Earth rotation angle and  the site longitude.  &quot;Observed&quot; RA,Dec or HA,Dec thus means the  position that would be seen by a perfect equatorial with its polar  axis aligned to the Earth&#39;s axis of rotation.</p></li><li><p>It is advisable to take great care with units, as even unlikely  values of the input parameters are accepted and processed in  accordance with the models used.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1693-L1827">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atic13" href="#AstroCouch.SOFA.atic13"><code>AstroCouch.SOFA.atic13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atic13(ri::Float64, di::Float64, day1::Float64, day2::Float64)</code></pre><p>Transform star RA,Dec from geocentric CIRS to ICRS astrometric.</p><p><strong>Input</strong></p><ul><li><code>ri, di</code> – CIRS geocentric RA,Dec (radians)</li><li><code>date1</code>  – TDB as a 2-part...</li><li><code>date2</code>  – ...Julian Date (Note 1)</li></ul><p><strong>Output</strong></p><ul><li><code>rc, dc</code> – ICRS astrometric RA,Dec (radians)</li><li><code>eo</code>     – equation of the origins (ERA-GST, Note 4)</li></ul><p><strong>Note</strong></p><ol><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  For most applications of this function the choice will not be at all critical.</p><p>TT can be used instead of TDB without any significant impact on accuracy.</p></li><li><p>Iterative techniques are used for the aberration and light deflection corrections so that the functions eraAtic13 (or eraAticq) and eraAtci13 (or eraAtciq) are accurate inverses; even at the edge of the Sun&#39;s disk the discrepancy is only about 1 nanoarcsecond.</p></li><li><p>The available accuracy is better than 1 milliarcsecond, limited mainly by the precession-nutation model that is used, namely IAU 2000A/2006.  Very close to solar system bodies, additional errors of up to several milliarcseconds can occur because of unmodeled light deflection; however, the Sun&#39;s contribution is taken into account, to first order.  The accuracy limitations of the ERFA function eraEpv00 (used to compute Earth position and velocity) can contribute aberration errors of up to 5 microarcseconds.  Light deflection at the Sun&#39;s limb is uncertain at the 0.4 mas level.</p></li><li><p>Should the transformation to (equinox based) J2000.0 mean place be required rather than (CIO based) ICRS coordinates, subtract the equation of the origins from the returned right ascension: RA = RI</p><ul><li>EO.  (The eraAnp function can then be applied, as required, to</li></ul><p>keep the result in the conventional 0-2pi range.)</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1840-L1904">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.aticq" href="#AstroCouch.SOFA.aticq"><code>AstroCouch.SOFA.aticq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atic13(ri::Float64, di::Float64, day1::Float64, day2::Float64)</code></pre><p>Quick CIRS RA,Dec to ICRS astrometric place, given the star- independent astrometry parameters.</p><p>Use of this function is appropriate when efficiency is important and where many star positions are all to be transformed for one date.  The star-independent astrometry parameters can be obtained by calling one of the functions eraApci[13], eraApcg[13], eraApco[13] or eraApcs[13].</p><p><strong>Input</strong></p><ul><li><code>ri, di</code> – CIRS RA,Dec (radians)</li><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Output</strong></p><ul><li><code>rc, dc</code> – ICRS astrometric RA,Dec (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>Only the Sun is taken into account in the light deflection correction.</p></li><li><p>Iterative techniques are used for the aberration and light deflection corrections so that the functions eraAtic13 (or eraAticq) and eraAtci13 (or eraAtciq) are accurate inverses; even at the edge of the Sun&#39;s disk the discrepancy is only about 1 nanoarcsecond.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1911-L1941">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.aticqn" href="#AstroCouch.SOFA.aticqn"><code>AstroCouch.SOFA.aticqn</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">aticqn(ri::Float64, di::Float64, a::Astrom, n::Int, b::Vector{Ldbody})</code></pre><p>Quick CIRS to ICRS astrometric place transformation, given the star- independent astrometry parameters plus a list of light-deflecting bodies.</p><p>Use of this function is appropriate when efficiency is important and where many star positions are all to be transformed for one date.  The star-independent astrometry parameters can be obtained by calling one of the functions eraApci[13], eraApcg[13], eraApco[13] or eraApcs[13].</p><p>If the only light-deflecting body to be taken into account is the Sun, the eraAticq function can be used instead.</p><p><strong>Input</strong></p><ul><li><code>ri, di</code> – CIRS RA,Dec (radians)</li><li><code>astrom</code> – star-independent astrometry parameters:</li><li><code>n</code>      – number of bodies (Note 3)</li><li><code>b</code>      – data for each of the n bodies (Notes 3,4):</li></ul><p><strong>Output</strong></p><ul><li><code>rc, dc</code> – ICRS astrometric RA,Dec (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>Iterative techniques are used for the aberration and light deflection corrections so that the functions eraAticqn and eraAtciqn are accurate inverses; even at the edge of the Sun&#39;s disk the discrepancy is only about 1 nanoarcsecond.</p></li><li><p>If the only light-deflecting body to be taken into account is the Sun, the eraAticq function can be used instead.</p></li><li><p>The struct b contains n entries, one for each body to be considered.  If n = 0, no gravitational light deflection will be applied, not even for the Sun.</p></li><li><p>The struct b should include an entry for the Sun as well as for any planet or other body to be taken into account.  The entries should be in the order in which the light passes the body.</p></li><li><p>In the entry in the b struct for body i, the mass parameter b[i].bm can, as required, be adjusted in order to allow for such effects as quadrupole field.</p></li><li><p>The deflection limiter parameter b[i].dl is phi^2/2, where phi is the angular separation (in radians) between star and body at which limiting is applied.  As phi shrinks below the chosen threshold, the deflection is artificially reduced, reaching zero for phi = 0. Example values suitable for a terrestrial observer, together with masses, are as follows:</p><p>body i     b[i].bm        b[i].dl</p><p>Sun        1.0            6e-6    Jupiter    0.00095435     3e-9    Saturn     0.00028574     3e-10</p></li><li><p>For efficiency, validation of the contents of the b array is omitted.  The supplied masses must be greater than zero, the position and velocity vectors must be right, and the deflection limiter greater than zero.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L1971-L2036">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atio13" href="#AstroCouch.SOFA.atio13"><code>AstroCouch.SOFA.atio13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atio13(ri::Float64, di::Float64, utc1::Float64, utc2::Float64, dut1::Float64,
       elong::Float64, ϕ::Float64, hm::Float64, xp::Float64, yp::Float64,
       phpa::Float64, tc::Float64, rh::Float64, wl::Float64)</code></pre><p>CIRS RA,Dec to observed place.  The caller supplies UTC, site coordinates, ambient air conditions and observing wavelength.</p><p><strong>Input</strong></p><ul><li><code>ri</code>     – CIRS right ascension (CIO-based, radians)</li><li><code>di</code>     – CIRS declination (radians)</li><li><code>utc1</code>   – UTC as a 2-part...</li><li><code>utc2</code>   – ...quasi Julian Date (Notes 1,2)</li><li><code>dut1</code>   – UT1-UTC (seconds, Note 3)</li><li><code>elong</code>  – longitude (radians, east +ve, Note 4)</li><li><code>phi</code>    – geodetic latitude (radians, Note 4)</li><li><code>hm</code>     – height above ellipsoid (m, geodetic Notes 4,6)</li><li><code>xp, yp</code> – polar motion coordinates (radians, Note 5)</li><li><code>phpa</code>   – pressure at the observer (hPa = mB, Note 6)</li><li><code>tc</code>     – ambient temperature at the observer (deg C)</li><li><code>rh</code>     – relative humidity at the observer (range 0-1)</li><li><code>wl</code>     – wavelength (micrometers, Note 7)</li></ul><p><strong>Output</strong></p><ul><li><code>aob</code>    – observed azimuth (radians: N=0,E=90)</li><li><code>zob</code>    – observed zenith distance (radians)</li><li><code>hob</code>    – observed hour angle (radians)</li><li><code>dob</code>    – observed declination (radians)</li><li><code>rob</code>    – observed right ascension (CIO-based, radians)</li></ul><p><strong>Note</strong></p><ol><li><p>utc1+utc2 is quasi Julian Date (see Note 2), apportioned in any convenient way between the two arguments, for example where utc1 is the Julian Day Number and utc2 is the fraction of a day.</p><p>However, JD cannot unambiguously represent UTC during a leap second unless special measures are taken.  The convention in the present function is that the JD day represents UTC days whether the length is 86399, 86400 or 86401 SI seconds.</p><p>Applications should use the function eraDtf2d to convert from calendar date and time of day into 2-part quasi Julian Date, as it implements the leap-second-ambiguity convention just described.</p></li><li><p>The warning status &quot;dubious year&quot; flags UTCs that predate the introduction of the time scale or that are too far in the future to be trusted.  See eraDat for further details.</p></li><li><p>UT1-UTC is tabulated in IERS bulletins.  It increases by exactly one second at the end of each positive UTC leap second, introduced in order to keep UT1-UTC within +/- 0.9s.  n.b. This practice is under review, and in the future UT1-UTC may grow essentially without limit.</p></li><li><p>The geographical coordinates are with respect to the ERFA_WGS84 reference ellipsoid.  TAKE CARE WITH THE LONGITUDE SIGN: the longitude required by the present function is east-positive (i.e. right-handed), in accordance with geographical convention.</p></li><li><p>The polar motion xp,yp can be obtained from IERS bulletins.  The values are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.  For many applications, xp and yp can be set to zero.</p></li><li><p>If hm, the height above the ellipsoid of the observing station in meters, is not known but phpa, the pressure in hPa (=mB), is available, an adequate estimate of hm can be obtained from the expression</p><pre><code class="nohighlight hljs">   hm = -29.3 * tsl * log ( phpa / 1013.25 );</code></pre><p>where tsl is the approximate sea-level air temperature in K (See Astrophysical Quantities, C.W.Allen, 3rd edition, section 52). Similarly, if the pressure phpa is not known, it can be estimated from the height of the observing station, hm, as follows:</p><pre><code class="nohighlight hljs">   phpa = 1013.25 * exp ( -hm / ( 29.3 * tsl ) );</code></pre><p>Note, however, that the refraction is nearly proportional to the pressure and that an accurate phpa value is important for precise work.</p></li><li><p>The argument wl specifies the observing wavelength in micrometers. The transition from optical to radio is assumed to occur at 100 micrometers (about 3000 GHz).</p></li><li><p>&quot;Observed&quot; Az,ZD means the position that would be seen by a perfect geodetically aligned theodolite.  (Zenith distance is used rather than altitude in order to reflect the fact that no allowance is made for depression of the horizon.)  This is related to the observed HA,Dec via the standard rotation, using the geodetic latitude (corrected for polar motion), while the observed HA and RA are related simply through the Earth rotation angle and the site longitude.  &quot;Observed&quot; RA,Dec or HA,Dec thus means the position that would be seen by a perfect equatorial with its polar axis aligned to the Earth&#39;s axis of rotation.</p></li><li><p>The accuracy of the result is limited by the corrections for refraction, which use a simple A<em>tan(z) + B</em>tan^3(z) model. Providing the meteorological parameters are known accurately and there are no gross local effects, the predicted astrometric coordinates should be within 0.05 arcsec (optical) or 1 arcsec (radio) for a zenith distance of less than 70 degrees, better than 30 arcsec (optical or radio) at 85 degrees and better than 20 arcmin (optical) or 30 arcmin (radio) at the horizon.</p></li><li><p>The complementary functions eraAtio13 and eraAtoi13 are self-  consistent to better than 1 microarcsecond all over the celestial  sphere.</p></li><li><p>It is advisable to take great care with units, as even unlikely  values of the input parameters are accepted and processed in  accordance with the models used.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2061-L2179">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atioq" href="#AstroCouch.SOFA.atioq"><code>AstroCouch.SOFA.atioq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atioq(ri::Float64, di::Float64, a::Astrom)</code></pre><p>Use of this function is appropriate when efficiency is important and where many star positions are all to be transformed for one date.  The star-independent astrometry parameters can be obtained by calling eraApio[13] or eraApco[13].</p><p><strong>Input</strong></p><ul><li><code>ri</code>     – CIRS right ascension</li><li><code>di</code>     – CIRS declination</li><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Output</strong></p><ul><li><code>aob</code>    – observed azimuth (radians: N=0,E=90)</li><li><code>zob</code>    – observed zenith distance (radians)</li><li><code>hob</code>    – observed hour angle (radians)</li><li><code>dob</code>    – observed declination (radians)</li><li><code>rob</code>    – observed right ascension (CIO-based, radians)</li></ul><p><strong>Note</strong></p><ol><li><p>This function returns zenith distance rather than altitude in order to reflect the fact that no allowance is made for depression of the horizon.</p></li><li><p>The accuracy of the result is limited by the corrections for refraction, which use a simple A<em>tan(z) + B</em>tan^3(z) model. Providing the meteorological parameters are known accurately and there are no gross local effects, the predicted observed coordinates should be within 0.05 arcsec (optical) or 1 arcsec (radio) for a zenith distance of less than 70 degrees, better than 30 arcsec (optical or radio) at 85 degrees and better than 20 arcmin (optical) or 30 arcmin (radio) at the horizon.</p><p>Without refraction, the complementary functions eraAtioq and eraAtoiq are self-consistent to better than 1 microarcsecond all over the celestial sphere.  With refraction included, consistency falls off at high zenith distances, but is still better than 0.05 arcsec at 85 degrees.</p></li><li><p>It is advisable to take great care with units, as even unlikely values of the input parameters are accepted and processed in accordance with the models used.</p></li><li><p>The CIRS RA,Dec is obtained from a star catalog mean place by allowing for space motion, parallax, the Sun&#39;s gravitational lens effect, annual aberration and precession-nutation.  For star positions in the ICRS, these effects can be applied by means of the eraAtci13 (etc.) functions.  Starting from classical &quot;mean place&quot; systems, additional transformations will be needed first.</p></li><li><p>&quot;Observed&quot; Az,El means the position that would be seen by a perfect geodetically aligned theodolite.  This is obtained from the CIRS RA,Dec by allowing for Earth orientation and diurnal aberration, rotating from equator to horizon coordinates, and then adjusting for refraction.  The HA,Dec is obtained by rotating back into equatorial coordinates, and is the position that would be seen by a perfect equatorial with its polar axis aligned to the Earth&#39;s axis of rotation.  Finally, the RA is obtained by subtracting the HA from the local ERA.</p></li><li><p>The star-independent CIRS-to-observed-place parameters in ASTROM may be computed with eraApio[13] or eraApco[13].  If nothing has changed significantly except the time, eraAper[13] may be used to perform the requisite adjustment to the astrom structure.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2190-L2258">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atoc13" href="#AstroCouch.SOFA.atoc13"><code>AstroCouch.SOFA.atoc13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>atoc13(tp::Char, ob1::Float64, ob2::Float64, utc1::Float64, utc2::Float64,           dut1::Float64, elong::Float64, ϕ::Float64, hm::Float64, xp::Float64,           yp::Float64, phpa::Float64, tc::Float64, rh::Float64, wl::Float64)</p><p>Observed place at a groundbased site to to ICRS astrometric RA,Dec. The caller supplies UTC, site coordinates, ambient air conditions and observing wavelength.</p><p><strong>Input</strong></p><ul><li><code>type</code>   – type of coordinates - &quot;R&quot;, &quot;H&quot; or &quot;A&quot; (Notes 1,2)</li><li><code>ob1</code>    – observed Az, HA or RA (radians; Az is N=0,E=90)</li><li><code>ob2</code>    – observed ZD or Dec (radians)</li><li><code>utc1</code>   – UTC as a 2-part...</li><li><code>utc2</code>   – ...quasi Julian Date (Notes 3,4)</li><li><code>dut1</code>   – UT1-UTC (seconds, Note 5)</li><li><code>elong</code>  – longitude (radians, east +ve, Note 6)</li><li><code>phi</code>    – geodetic latitude (radians, Note 6)</li><li><code>hm</code>     – height above ellipsoid (m, geodetic Notes 6,8)</li><li><code>xp, yp</code> – polar motion coordinates (radians, Note 7)</li><li><code>phpa</code>   – pressure at the observer (hPa = mB, Note 8)</li><li><code>tc</code>     – ambient temperature at the observer (deg C)</li><li><code>rh</code>     – relative humidity at the observer (range 0-1)</li><li><code>wl</code>     – wavelength (micrometers, Note 9)</li></ul><p><strong>Output</strong></p><ul><li><code>rc, dc</code> – ICRS astrometric RA,Dec (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>&quot;Observed&quot; Az,ZD means the position that would be seen by a perfect geodetically aligned theodolite.  (Zenith distance is used rather than altitude in order to reflect the fact that no allowance is made for depression of the horizon.)  This is related to the observed HA,Dec via the standard rotation, using the geodetic latitude (corrected for polar motion), while the observed HA and RA are related simply through the Earth rotation angle and the site longitude.  &quot;Observed&quot; RA,Dec or HA,Dec thus means the position that would be seen by a perfect equatorial with its polar axis aligned to the Earth&#39;s axis of rotation.</p></li><li><p>Only the first character of the type argument is significant.  &quot;R&quot; or &quot;r&quot; indicates that ob1 and ob2 are the observed right ascension and declination; &quot;H&quot; or &quot;h&quot; indicates that they are hour angle (west +ve) and declination; anything else (&quot;A&quot; or &quot;a&quot; is recommended) indicates that ob1 and ob2 are azimuth (north zero, east 90 deg) and zenith distance.</p></li><li><p>utc1+utc2 is quasi Julian Date (see Note 2), apportioned in any convenient way between the two arguments, for example where utc1 is the Julian Day Number and utc2 is the fraction of a day.</p><p>However, JD cannot unambiguously represent UTC during a leap second unless special measures are taken.  The convention in the present function is that the JD day represents UTC days whether the length is 86399, 86400 or 86401 SI seconds.</p><p>Applications should use the function eraDtf2d to convert from calendar date and time of day into 2-part quasi Julian Date, as it implements the leap-second-ambiguity convention just described.</p></li><li><p>The warning status &quot;dubious year&quot; flags UTCs that predate the introduction of the time scale or that are too far in the future to be trusted.  See eraDat for further details.</p></li><li><p>UT1-UTC is tabulated in IERS bulletins.  It increases by exactly one second at the end of each positive UTC leap second, introduced in order to keep UT1-UTC within +/- 0.9s.  n.b. This practice is under review, and in the future UT1-UTC may grow essentially without limit.</p></li><li><p>The geographical coordinates are with respect to the ERFA_WGS84 reference ellipsoid.  TAKE CARE WITH THE LONGITUDE SIGN: the longitude required by the present function is east-positive (i.e. right-handed), in accordance with geographical convention.</p></li><li><p>The polar motion xp,yp can be obtained from IERS bulletins.  The values are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.  For many applications, xp and yp can be set to zero.</p></li><li><p>If hm, the height above the ellipsoid of the observing station in meters, is not known but phpa, the pressure in hPa (=mB), is available, an adequate estimate of hm can be obtained from the expression</p><pre><code class="nohighlight hljs">   hm = -29.3 * tsl * log ( phpa / 1013.25 );</code></pre><p>where tsl is the approximate sea-level air temperature in K (See Astrophysical Quantities, C.W.Allen, 3rd edition, section 52). Similarly, if the pressure phpa is not known, it can be estimated from the height of the observing station, hm, as follows:</p><pre><code class="nohighlight hljs">   phpa = 1013.25 * exp ( -hm / ( 29.3 * tsl ) );</code></pre><p>Note, however, that the refraction is nearly proportional to the pressure and that an accurate phpa value is important for precise work.</p></li><li><p>The argument wl specifies the observing wavelength in micrometers. The transition from optical to radio is assumed to occur at 100 micrometers (about 3000 GHz).</p></li><li><p>The accuracy of the result is limited by the corrections for  refraction, which use a simple A<em>tan(z) + B</em>tan^3(z) model.  Providing the meteorological parameters are known accurately and  there are no gross local effects, the predicted astrometric  coordinates should be within 0.05 arcsec (optical) or 1 arcsec  (radio) for a zenith distance of less than 70 degrees, better than  30 arcsec (optical or radio) at 85 degrees and better than 20  arcmin (optical) or 30 arcmin (radio) at the horizon.</p><p>Without refraction, the complementary functions eraAtco13 and  eraAtoc13 are self-consistent to better than 1 microarcsecond all  over the celestial sphere.  With refraction included, consistency  falls off at high zenith distances, but is still better than 0.05  arcsec at 85 degrees.</p></li><li><p>It is advisable to take great care with units, as even unlikely  values of the input parameters are accepted and processed in  accordance with the models used.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2290-L2415">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atoi13" href="#AstroCouch.SOFA.atoi13"><code>AstroCouch.SOFA.atoi13</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atoi13(tp::Char, ob1::Float64, ob2::Float64, utc1::Float64, utc2::Float64,
       dut1::Float64, elong::Float64, ϕ::Float64, hm::Float64, xp::Float64,
       yp::Float64, phpa::Float64, tc::Float64, rh::Float64, wl::Float64)</code></pre><p>Observed place to CIRS.  The caller supplies UTC, site coordinates, ambient air conditions and observing wavelength.</p><p><strong>Input</strong></p><ul><li><code>type</code>   – type of coordinates - &quot;R&quot;, &quot;H&quot; or &quot;A&quot; (Notes 1,2)</li><li><code>ob1</code>    – observed Az, HA or RA (radians; Az is N=0,E=90)</li><li><code>ob2</code>    – observed ZD or Dec (radians)</li><li><code>utc1</code>   – UTC as a 2-part...</li><li><code>utc2</code>   – ...quasi Julian Date (Notes 3,4)</li><li><code>dut1</code>   – UT1-UTC (seconds, Note 5)</li><li><code>elong</code>  – longitude (radians, east +ve, Note 6)</li><li><code>phi</code>    – geodetic latitude (radians, Note 6)</li><li><code>hm</code>     – height above the ellipsoid (meters, Notes 6,8)</li><li><code>xp, yp</code> – polar motion coordinates (radians, Note 7)</li><li><code>phpa</code>   – pressure at the observer (hPa = mB, Note 8)</li><li><code>tc</code>     – ambient temperature at the observer (deg C)</li><li><code>rh</code>     – relative humidity at the observer (range 0-1)</li><li><code>wl</code>     – wavelength (micrometers, Note 9)</li></ul><p><strong>Output</strong></p><ul><li><code>ri</code>     – CIRS right ascension (CIO-based, radians)</li><li><code>di</code>     – CIRS declination (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>&quot;Observed&quot; Az,ZD means the position that would be seen by a perfect geodetically aligned theodolite.  (Zenith distance is used rather than altitude in order to reflect the fact that no allowance is made for depression of the horizon.)  This is related to the observed HA,Dec via the standard rotation, using the geodetic latitude (corrected for polar motion), while the observed HA and RA are related simply through the Earth rotation angle and the site longitude.  &quot;Observed&quot; RA,Dec or HA,Dec thus means the position that would be seen by a perfect equatorial with its polar axis aligned to the Earth&#39;s axis of rotation.</p></li><li><p>Only the first character of the type argument is significant.  &quot;R&quot; or &quot;r&quot; indicates that ob1 and ob2 are the observed right ascension and declination; &quot;H&quot; or &quot;h&quot; indicates that they are hour angle (west +ve) and declination; anything else (&quot;A&quot; or &quot;a&quot; is recommended) indicates that ob1 and ob2 are azimuth (north zero, east 90 deg) and zenith distance.</p></li><li><p>utc1+utc2 is quasi Julian Date (see Note 2), apportioned in any convenient way between the two arguments, for example where utc1 is the Julian Day Number and utc2 is the fraction of a day.</p><p>However, JD cannot unambiguously represent UTC during a leap second unless special measures are taken.  The convention in the present function is that the JD day represents UTC days whether the length is 86399, 86400 or 86401 SI seconds.</p><p>Applications should use the function eraDtf2d to convert from calendar date and time of day into 2-part quasi Julian Date, as it implements the leap-second-ambiguity convention just described.</p></li><li><p>The warning status &quot;dubious year&quot; flags UTCs that predate the introduction of the time scale or that are too far in the future to be trusted.  See eraDat for further details.</p></li><li><p>UT1-UTC is tabulated in IERS bulletins.  It increases by exactly one second at the end of each positive UTC leap second, introduced in order to keep UT1-UTC within +/- 0.9s.  n.b. This practice is under review, and in the future UT1-UTC may grow essentially without limit.</p></li><li><p>The geographical coordinates are with respect to the ERFA_WGS84 reference ellipsoid.  TAKE CARE WITH THE LONGITUDE SIGN: the longitude required by the present function is east-positive (i.e. right-handed), in accordance with geographical convention.</p></li><li><p>The polar motion xp,yp can be obtained from IERS bulletins.  The values are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.  For many applications, xp and yp can be set to zero.</p></li><li><p>If hm, the height above the ellipsoid of the observing station in meters, is not known but phpa, the pressure in hPa (=mB), is available, an adequate estimate of hm can be obtained from the expression</p><pre><code class="nohighlight hljs">   hm = -29.3 * tsl * log ( phpa / 1013.25 );</code></pre><p>where tsl is the approximate sea-level air temperature in K (See Astrophysical Quantities, C.W.Allen, 3rd edition, section 52). Similarly, if the pressure phpa is not known, it can be estimated from the height of the observing station, hm, as follows:</p><pre><code class="nohighlight hljs">   phpa = 1013.25 * exp ( -hm / ( 29.3 * tsl ) );</code></pre><p>Note, however, that the refraction is nearly proportional to the pressure and that an accurate phpa value is important for precise work.</p></li><li><p>The argument wl specifies the observing wavelength in micrometers. The transition from optical to radio is assumed to occur at 100 micrometers (about 3000 GHz).</p></li><li><p>The accuracy of the result is limited by the corrections for  refraction, which use a simple A<em>tan(z) + B</em>tan^3(z) model.  Providing the meteorological parameters are known accurately and  there are no gross local effects, the predicted astrometric  coordinates should be within 0.05 arcsec (optical) or 1 arcsec  (radio) for a zenith distance of less than 70 degrees, better than  30 arcsec (optical or radio) at 85 degrees and better than 20  arcmin (optical) or 30 arcmin (radio) at the horizon.</p><p>Without refraction, the complementary functions eraAtio13 and  eraAtoi13 are self-consistent to better than 1 microarcsecond all  over the celestial sphere.  With refraction included, consistency  falls off at high zenith distances, but is still better than 0.05  arcsec at 85 degrees.</p></li><li><p>It is advisable to take great care with units, as even unlikely  values of the input parameters are accepted and processed in  accordance with the models used.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2428-L2553">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.atoiq" href="#AstroCouch.SOFA.atoiq"><code>AstroCouch.SOFA.atoiq</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">atoiq(tp::Char, ob1::Float64, ob2::Float64, a::Astrom)</code></pre><p>Quick observed place to CIRS, given the star-independent astrometry parameters.</p><p>Use of this function is appropriate when efficiency is important and where many star positions are all to be transformed for one date.  The star-independent astrometry parameters can be obtained by calling eraApio[13] or eraApco[13].</p><p><strong>Input</strong></p><ul><li><code>type</code>   – type of coordinates: &quot;R&quot;, &quot;H&quot; or &quot;A&quot; (Note 1)</li><li><code>ob1</code>    – observed Az, HA or RA (radians; Az is N=0,E=90)</li><li><code>ob2</code>    – observed ZD or Dec (radians)</li><li><code>astrom</code> – star-independent astrometry parameters:</li></ul><p><strong>Output</strong></p><ul><li><code>ri</code>     – CIRS right ascension (CIO-based, radians)</li><li><code>di</code>     – CIRS declination (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>&quot;Observed&quot; Az,Zd means the position that would be seen by a perfect geodetically aligned theodolite.  This is related to the observed HA,Dec via the standard rotation, using the geodetic latitude (corrected for polar motion), while the observed HA and RA are related simply through the Earth rotation angle and the site longitude.  &quot;Observed&quot; RA,Dec or HA,Dec thus means the position that would be seen by a perfect equatorial with its polar axis aligned to the Earth&#39;s axis of rotation.  By removing from the observed place the effects of atmospheric refraction and diurnal aberration, the CIRS RA,Dec is obtained.</p></li><li><p>Only the first character of the type argument is significant.  &quot;R&quot; or &quot;r&quot; indicates that ob1 and ob2 are the observed right ascension and declination; &quot;H&quot; or &quot;h&quot; indicates that they are hour angle (west +ve) and declination; anything else (&quot;A&quot; or &quot;a&quot; is recommended) indicates that ob1 and ob2 are azimuth (north zero, east 90 deg) and zenith distance.  (Zenith distance is used rather than altitude in order to reflect the fact that no allowance is made for depression of the horizon.)</p></li><li><p>The accuracy of the result is limited by the corrections for refraction, which use a simple A<em>tan(z) + B</em>tan^3(z) model. Providing the meteorological parameters are known accurately and there are no gross local effects, the predicted intermediate coordinates should be within 0.05 arcsec (optical) or 1 arcsec (radio) for a zenith distance of less than 70 degrees, better than 30 arcsec (optical or radio) at 85 degrees and better than 20 arcmin (optical) or 25 arcmin (radio) at the horizon.</p><p>Without refraction, the complementary functions eraAtioq and eraAtoiq are self-consistent to better than 1 microarcsecond all over the celestial sphere.  With refraction included, consistency falls off at high zenith distances, but is still better than 0.05 arcsec at 85 degrees.</p></li><li><p>It is advisable to take great care with units, as even unlikely values of the input parameters are accepted and processed in accordance with the models used.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2564-L2627">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.ld" href="#AstroCouch.SOFA.ld"><code>AstroCouch.SOFA.ld</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ld(bm::Float64, p::Vector{Float64}, q::Vector{Float64}, e::Vector{Float64},
   em::Float64, dlim::Float64)</code></pre><p>Apply light deflection by a solar-system body, as part of transforming coordinate direction into natural direction.</p><p><strong>Input</strong></p><ul><li><code>bm</code>     – mass of the gravitating body (solar masses)</li><li><code>p</code>      – direction from observer to source (unit vector)</li><li><code>q</code>      – direction from body to source (unit vector)</li><li><code>e</code>      – direction from body to observer (unit vector)</li><li><code>em</code>     – distance from body to observer (AU)</li><li><code>dlim</code>   – deflection limiter (Note 4)</li></ul><p><strong>Output</strong></p><ul><li><code>p1</code>     – observer to deflected source (unit vector)</li></ul><p><strong>Note</strong></p><ol><li><p>The algorithm is based on Expr. (70) in Klioner (2003) and Expr. (7.63) in the Explanatory Supplement (Urban &amp; Seidelmann 2013), with some rearrangement to minimize the effects of machine precision.</p></li><li><p>The mass parameter bm can, as required, be adjusted in order to allow for such effects as quadrupole field.</p></li><li><p>The barycentric position of the deflecting body should ideally correspond to the time of closest approach of the light ray to the body.</p></li><li><p>The deflection limiter parameter dlim is phi^2/2, where phi is the angular separation (in radians) between source and body at which limiting is applied.  As phi shrinks below the chosen threshold, the deflection is artificially reduced, reaching zero for phi = 0.</p></li><li><p>The returned vector p1 is not normalized, but the consequential departure from unit magnitude is always negligible.</p></li><li><p>The arguments p and p1 can be the same array.</p></li><li><p>To accumulate total light deflection taking into account the contributions from several bodies, call the present function for each body in succession, in decreasing order of distance from the observer.</p></li><li><p>For efficiency, validation is omitted.  The supplied vectors must be of unit magnitude, and the deflection limiter non-zero and positive.</p></li></ol><p><strong>References</strong></p><p>Urban, S. &amp; Seidelmann, P. K. (eds), Explanatory Supplement to the Astronomical Almanac, 3rd ed., University Science Books (2013).</p><p>Klioner, Sergei A., &quot;A practical relativistic model for micro- arcsecond astrometry in space&quot;, Astr. J. 125, 1580-1597 (2003).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2663-L2723">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.ldn" href="#AstroCouch.SOFA.ldn"><code>AstroCouch.SOFA.ldn</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ldn(n::Int, b::Vector{Ldbody}, ob::Vector{Float64}, sc::Vector{Float64})</code></pre><p>For a star, apply light deflection by multiple solar-system bodies, as part of transforming coordinate direction into natural direction.</p><p><strong>Input</strong></p><ul><li><code>n</code>     – number of bodies (note 1)</li><li><code>b</code>     – data for each of the n bodies (Notes 1,2):</li><li><code>bm</code>    – mass of the body (solar masses, Note 3)</li><li><code>dl</code>    – deflection limiter (Note 4)</li><li><code>pv</code>    – barycentric PV of the body (AU, AU/day)</li><li><code>ob</code>    – barycentric position of the observer (AU)</li><li><code>sc</code>    – observer to star coord direction (unit vector)</li></ul><p><strong>Output</strong></p><ul><li><code>sn</code>    – observer to deflected star (unit vector)</li></ul><p><strong>Note</strong></p><ol><li><p>The array b contains n entries, one for each body to be considered. If n = 0, no gravitational light deflection will be applied, not even for the Sun.</p></li><li><p>The array b should include an entry for the Sun as well as for any planet or other body to be taken into account.  The entries should be in the order in which the light passes the body.</p></li><li><p>In the entry in the b array for body i, the mass parameter b[i].bm can, as required, be adjusted in order to allow for such effects as quadrupole field.</p></li><li><p>The deflection limiter parameter b[i].dl is phi^2/2, where phi is the angular separation (in radians) between star and body at which limiting is applied.  As phi shrinks below the chosen threshold, the deflection is artificially reduced, reaching zero for phi = 0. Example values suitable for a terrestrial observer, together with masses, are as follows:</p><p>body i     b[i].bm        b[i].dl</p><p>Sun        1.0            6e-6    Jupiter    0.00095435     3e-9    Saturn     0.00028574     3e-10</p></li><li><p>For cases where the starlight passes the body before reaching the observer, the body is placed back along its barycentric track by the light time from that point to the observer.  For cases where the body is &quot;behind&quot; the observer no such shift is applied.  If a different treatment is preferred, the user has the option of instead using the eraLd function.  Similarly, eraLd can be used for cases where the source is nearby, not a star.</p></li><li><p>The returned vector sn is not normalized, but the consequential departure from unit magnitude is always negligible.</p></li><li><p>The arguments sc and sn can be the same array.</p></li><li><p>For efficiency, validation is omitted.  The supplied masses must be greater than zero, the position and velocity vectors must be right, and the deflection limiter greater than zero.</p></li></ol><p><strong>References</strong></p><p>Urban, S. &amp; Seidelmann, P. K. (eds), Explanatory Supplement to the Astronomical Almanac, 3rd ed., University Science Books (2013), Section 7.2.4.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2731-L2800">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.ldsun" href="#AstroCouch.SOFA.ldsun"><code>AstroCouch.SOFA.ldsun</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ldsun(p::Vector{Float64}, e::Vector{Float64}, em::Float64)</code></pre><p>Deflection of starlight by the Sun.</p><p><strong>Input</strong></p><ul><li><code>p</code>      – direction from observer to star (unit vector)</li><li><code>e</code>      – direction from Sun to observer (unit vector)</li><li><code>em</code>     – distance from Sun to observer (AU)</li></ul><p><strong>Output</strong></p><ul><li><code>p1</code>     – observer to deflected star (unit vector)</li></ul><p><strong>Note</strong></p><ol><li><p>The source is presumed to be sufficiently distant that its directions seen from the Sun and the observer are essentially the same.</p></li><li><p>The deflection is restrained when the angle between the star and the center of the Sun is less than a threshold value, falling to zero deflection for zero separation.  The chosen threshold value is within the solar limb for all solar-system applications, and is about 5 arcminutes for the case of a terrestrial observer.</p></li><li><p>The arguments p and p1 can be the same array.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2817-L2845">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pmpx" href="#AstroCouch.SOFA.pmpx"><code>AstroCouch.SOFA.pmpx</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pmpx(rc::Float64, dc::Float64, pr::Float64, pd::Float64, px::Float64,
     rv::Float64, pmt::Float64, pob::Vector{Float64})</code></pre><p>Proper motion and parallax.</p><p><strong>Input</strong></p><ul><li><code>rc, dc</code> – ICRS RA,Dec at catalog epoch (radians)</li><li><code>pr</code>     – RA proper motion (radians/year, Note 1)</li><li><code>pd</code>     – Dec proper motion (radians/year)</li><li><code>px</code>     – parallax (arcsec)</li><li><code>rv</code>     – radial velocity (km/s, +ve if receding)</li><li><code>pmt</code>    – proper motion time interval (SSB, Julian years)</li><li><code>pob</code>    – SSB to observer vector (AU)</li></ul><p><strong>Output</strong></p><ul><li><code>pco</code>    – coordinate direction (BCRS unit vector)</li></ul><p><strong>Note</strong></p><ol><li><p>The proper motion in RA is dRA/dt rather than cos(Dec)*dRA/dt.</p></li><li><p>The proper motion time interval is for when the starlight reaches the solar system barycenter.</p></li><li><p>To avoid the need for iteration, the Roemer effect (i.e. the small annual modulation of the proper motion coming from the changing light time) is applied approximately, using the direction of the star at the catalog epoch.</p></li></ol><p><strong>References</strong></p><p>1984 Astronomical Almanac, pp B39-B41.</p><p>Urban, S. &amp; Seidelmann, P. K. (eds), Explanatory Supplement to the Astronomical Almanac, 3rd ed., University Science Books (2013), Section 7.2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2852-L2891">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pmsafe" href="#AstroCouch.SOFA.pmsafe"><code>AstroCouch.SOFA.pmsafe</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pmsafe(ra::Float64, dec::Float64, pmr::Float64, pmd::Float64, px::Float64,
       rv::Float64, ep1a::Float64, ep1b::Float64, ep2a::Float64,
       ep2b::Float64)</code></pre><p>Star proper motion: update star catalog data for space motion, with special handling to handle the zero parallax case.</p><p><strong>Input</strong></p><ul><li><code>ra1</code>    – right ascension (radians), before</li><li><code>dec1</code>   – declination (radians), before</li><li><code>pmr1</code>   – RA proper motion (radians/year), before</li><li><code>pmd1</code>   – Dec proper motion (radians/year), before</li><li><code>px1</code>    – parallax (arcseconds), before</li><li><code>rv1</code>    – radial velocity (km/s, +ve = receding), before</li><li><code>ep1a</code>   – &quot;before&quot; epoch, part A (Note 1)</li><li><code>ep1b</code>   – &quot;before&quot; epoch, part B (Note 1)</li><li><code>ep2a</code>   – &quot;after&quot; epoch, part A (Note 1)</li><li><code>ep2b</code>   – &quot;after&quot; epoch, part B (Note 1)</li></ul><p><strong>Output</strong></p><ul><li><code>ra2</code>    – right ascension (radians), after</li><li><code>dec2</code>   – declination (radians), after</li><li><code>pmr2</code>   – RA proper motion (radians/year), after</li><li><code>pmd2</code>   – Dec proper motion (radians/year), after</li><li><code>px2</code>    – parallax (arcseconds), after</li><li><code>rv2</code>    – radial velocity (km/s, +ve = receding), after</li></ul><p><strong>Note</strong></p><ol><li><p>The starting and ending TDB epochs ep1a+ep1b and ep2a+ep2b are Julian Dates, apportioned in any convenient way between the two parts (A and B).  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   epNa            epNb

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>In accordance with normal star-catalog conventions, the object&#39;s right ascension and declination are freed from the effects of secular aberration.  The frame, which is aligned to the catalog equator and equinox, is Lorentzian and centered on the SSB.</p><p>The proper motions are the rate of change of the right ascension and declination at the catalog epoch and are in radians per TDB Julian year.</p><p>The parallax and radial velocity are in the same frame.</p></li><li><p>Care is needed with units.  The star coordinates are in radians and the proper motions in radians per Julian year, but the parallax is in arcseconds.</p></li><li><p>The RA proper motion is in terms of coordinate angle, not true angle.  If the catalog uses arcseconds for both RA and Dec proper motions, the RA proper motion will need to be divided by cos(Dec) before use.</p></li><li><p>Straight-line motion at constant speed, in the inertial frame, is assumed.</p></li><li><p>An extremely small (or zero or negative) parallax is overridden to ensure that the object is at a finite but very large distance, but not so large that the proper motion is equivalent to a large but safe speed (about 0.1c using the chosen constant).  A warning status of 1 is added to the status if this action has been taken.</p></li><li><p>If the space velocity is a significant fraction of c (see the constant VMAX in the function eraStarpv), it is arbitrarily set to zero.  When this action occurs, 2 is added to the status.</p></li><li><p>The relativistic adjustment carried out in the eraStarpv function involves an iterative calculation.  If the process fails to converge within a set number of iterations, 4 is added to the status.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L2907-L2995">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pvtob" href="#AstroCouch.SOFA.pvtob"><code>AstroCouch.SOFA.pvtob</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pvtob(elong::Float64, ϕ::Float64, hm::Float64, xp::Float64, yp::Float64,
      sp::Float64, θ::Float64)</code></pre><p>Position and velocity of a terrestrial observing station.</p><p><strong>Input</strong></p><ul><li><code>elong</code>  – longitude (radians, east +ve, Note 1)</li><li><code>phi</code>    – latitude (geodetic, radians, Note 1)</li><li><code>hm</code>     – height above ref. ellipsoid (geodetic, m)</li><li><code>xp, yp</code> – coordinates of the pole (radians, Note 2)</li><li><code>sp</code>     – the TIO locator s&#39; (radians, Note 2)</li><li><code>theta</code>  – Earth rotation angle (radians, Note 3)</li></ul><p><strong>Output</strong></p><ul><li><code>pv</code>     – position/velocity vector (m, m/s, CIRS)</li></ul><p><strong>Note</strong></p><ol><li><p>The terrestrial coordinates are with respect to the ERFA_WGS84 reference ellipsoid.</p></li><li><p>xp and yp are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions), measured along the meridians 0 and 90 deg west respectively.  sp is the TIO locator s&#39;, in radians, which positions the Terrestrial Intermediate Origin on the equator.  For many applications, xp, yp and (especially) sp can be set to zero.</p></li><li><p>If theta is Greenwich apparent sidereal time instead of Earth rotation angle, the result is with respect to the true equator and equinox of date, i.e. with the x-axis at the equinox rather than the celestial intermediate origin.</p></li><li><p>The velocity units are meters per UT1 second, not per SI second. This is unlikely to have any practical consequences in the modern era.</p></li><li><p>No validation is performed on the arguments.  Error cases that could lead to arithmetic exceptions are trapped by the eraGd2gc function, and the result set to zeros.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p><p>Urban, S. &amp; Seidelmann, P. K. (eds), Explanatory Supplement to the Astronomical Almanac, 3rd ed., University Science Books (2013), Section 7.4.3.3.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L3016-L3069">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.refco" href="#AstroCouch.SOFA.refco"><code>AstroCouch.SOFA.refco</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">refco(phpa::Float64, tc::Float64, rh::Float64, wl::Float64)</code></pre><p>Determine the constants A and B in the atmospheric refraction model dZ = A tan Z + B tan^3 Z.</p><p>Z is the &quot;observed&quot; zenith distance (i.e. affected by refraction) and dZ is what to add to Z to give the &quot;topocentric&quot; (i.e. in vacuo) zenith distance.</p><p><strong>Input</strong></p><ul><li><code>phpa</code> – pressure at the observer (hPa = millibar)</li><li><code>tc</code>   – ambient temperature at the observer (deg C)</li><li><code>rh</code>   – humidity at the observer (range 0-1)</li><li><code>wl</code>   – double    wavelength (micrometers)</li></ul><p><strong>Output</strong></p><ul><li><code>refa</code> – tan Z coefficient (radians)</li><li><code>refb</code> – tan^3 Z coefficient (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>The model balances speed and accuracy to give good results in applications where performance at low altitudes is not paramount. Performance is maintained across a range of conditions, and applies to both optical/IR and radio.</p></li><li><p>The model omits the effects of (i) height above sea level (apart from the reduced pressure itself), (ii) latitude (i.e. the flattening of the Earth), (iii) variations in tropospheric lapse rate and (iv) dispersive effects in the radio.  The model was tested using the following range of conditions:</p><p>lapse rates 0.0055, 0.0065, 0.0075 deg/meter   latitudes 0, 25, 50, 75 degrees   heights 0, 2500, 5000 meters ASL   pressures mean for height -10% to +5% in steps of 5%   temperatures -10 deg to +20 deg with respect to 280 deg at SL   relative humidity 0, 0.5, 1   wavelengths 0.4, 0.6, ... 2 micron, + radio   zenith distances 15, 45, 75 degrees</p><p>The accuracy with respect to raytracing through a model atmosphere was as follows:</p><pre><code class="nohighlight hljs">                   worst         RMS</code></pre><p>optical/IR           62 mas       8 mas   radio               319 mas      49 mas</p><p>For this particular set of conditions:</p><p>lapse rate 0.0065 K/meter   latitude 50 degrees   sea level   pressure 1005 mb   temperature 280.15 K   humidity 80%   wavelength 5740 Angstroms</p><p>the results were as follows:   ZD       raytrace     eraRefco   Saastamoinen</p><p>10         10.27        10.27        10.27   20         21.19        21.20        21.19   30         33.61        33.61        33.60   40         48.82        48.83        48.81   45         58.16        58.18        58.16   50         69.28        69.30        69.27   55         82.97        82.99        82.95   60        100.51       100.54       100.50   65        124.23       124.26       124.20   70        158.63       158.68       158.61   72        177.32       177.37       177.31   74        200.35       200.38       200.32   76        229.45       229.43       229.42   78        267.44       267.29       267.41   80        319.13       318.55       319.10</p><p>deg        arcsec       arcsec       arcsec</p><p>The values for Saastamoinen&#39;s formula (which includes terms up to tan^5) are taken from Hohenkerk and Sinclair (1985).</p></li><li><p>A wl value in the range 0-100 selects the optical/IR case and is wavelength in micrometers.  Any value outside this range selects the radio case.</p></li><li><p>Outlandish input parameters are silently limited to mathematically safe values.  Zero pressure is permissible, and causes zeroes to be returned.</p></li><li><p>The algorithm draws on several sources, as follows:</p><p>a) The formula for the saturation vapour pressure of water as a    function of temperature and temperature is taken from Equations    (A4.5-A4.7) of Gill (1982).</p><p>b) The formula for the water vapour pressure, given the saturation    pressure and the relative humidity, is from Crane (1976),    Equation (2.5.5).</p><p>c) The refractivity of air is a function of temperature, total    pressure, water-vapour pressure and, in the case of optical/IR,    wavelength.  The formulae for the two cases are developed from    Hohenkerk &amp; Sinclair (1985) and Rueger (2002).  The IAG (1999)    optical refractivity for dry air is used.</p><p>d) The formula for beta, the ratio of the scale height of the    atmosphere to the geocentric distance of the observer, is an    adaption of Equation (9) from Stone (1996).  The adaptations,    arrived at empirically, consist of (i) a small adjustment to the    coefficient and (ii) a humidity term for the radio case only.</p><p>e) The formulae for the refraction constants as a function of n-1    and beta are from Green (1987), Equation (4.31).</p></li></ol><p><strong>References</strong></p><p>Crane, R.K., Meeks, M.L. (ed), &quot;Refraction Effects in the Neutral Atmosphere&quot;, Methods of Experimental Physics: Astrophysics 12B, Academic Press, 1976.</p><p>Gill, Adrian E., &quot;Atmosphere-Ocean Dynamics&quot;, Academic Press, 1982.</p><p>Green, R.M., &quot;Spherical Astronomy&quot;, Cambridge University Press, 1987.</p><p>Hohenkerk, C.Y., &amp; Sinclair, A.T., NAO Technical Note No. 63, 1985.</p><p>IAG Resolutions adopted at the XXIIth General Assembly in Birmingham, 1999, Resolution 3.</p><p>Rueger, J.M., &quot;Refractive Index Formulae for Electronic Distance Measurement with Radio and Millimetre Waves&quot;, in Unisurv Report S-68, School of Surveying and Spatial Information Systems, University of New South Wales, Sydney, Australia, 2002.</p><p>Stone, Ronald C., P.A.S.P. 108, 1051-1058, 1996.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L3082-L3222">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.h20pres" href="#AstroCouch.SOFA.h20pres"><code>AstroCouch.SOFA.h20pres</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">h20pres(p::Float64, t::Float64, r::Float64)</code></pre><p>Calculate the water vapor pressure given temperature and pressure.</p><p><strong>Input</strong></p><ul><li><code>p</code>  – atmospheric pressure</li><li><code>t</code>  – atmospheric temperature</li><li><code>r</code>  – relative humidity</li></ul><p><strong>Output</strong></p><ul><li><code>wp</code> – water vapor pressure</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/astrometry.jl#L3248-L3263">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Introduction</a><a class="docs-footer-nextpage" href="../calendars/">Calendars »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 21 October 2025 08:49">Tuesday 21 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
