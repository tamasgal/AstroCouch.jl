<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Precession · AstroCouch.jl</title><meta name="title" content="Precession · AstroCouch.jl"/><meta property="og:title" content="Precession · AstroCouch.jl"/><meta property="twitter:title" content="Precession · AstroCouch.jl"/><meta name="description" content="Documentation for AstroCouch.jl."/><meta property="og:description" content="Documentation for AstroCouch.jl."/><meta property="twitter:description" content="Documentation for AstroCouch.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">The SOFA sub-package</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../astrometry/">Astrometry</a></li><li><a class="tocitem" href="../calendars/">Calendars</a></li><li><a class="tocitem" href="../coefficients/">Coefficients</a></li><li><a class="tocitem" href="../ecliptic/">Ecliptic</a></li><li><a class="tocitem" href="../ephemerides/">Ephemerides</a></li><li><a class="tocitem" href="../equatorial/">Equatorial</a></li><li><a class="tocitem" href="../galactic/">Galactic</a></li><li><a class="tocitem" href="../geocentric/">Geocentric</a></li><li><a class="tocitem" href="../gnomonic/">Gnomonic</a></li><li class="is-active"><a class="tocitem" href>Precession</a></li><li><a class="tocitem" href="../rotations/">Rotations</a></li><li><a class="tocitem" href="../spacemotion/">Space Motion</a></li><li><a class="tocitem" href="../starcatalogs/">Star Catalogs</a></li><li><a class="tocitem" href="../timescales/">Timescales</a></li><li><a class="tocitem" href="../vectorops/">Vectorops</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">The SOFA sub-package</a></li><li class="is-active"><a href>Precession</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Precession</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tamasgal/AstroCouch.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tamasgal/AstroCouch.jl/blob/main/docs/src/SOFA/precession.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="precession.jl"><a class="docs-heading-anchor" href="#precession.jl">precession.jl</a><a id="precession.jl-1"></a><a class="docs-heading-anchor-permalink" href="#precession.jl" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.bi00" href="#AstroCouch.SOFA.bi00"><code>AstroCouch.SOFA.bi00</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bi00()</code></pre><p>Frame bias components of IAU 2000 precession-nutation models; part of the Mathews-Herring-Buffett (MHB2000) nutation series, with additions.</p><p><strong>Output</strong></p><p>dpsibi,depsbi  double  longitude and obliquity corrections    dra            double  the ICRS RA of the J2000.0 mean equinox</p><p><strong>Note</strong></p><ol><li><p>The frame bias corrections in longitude and obliquity (radians) are required in order to correct for the offset between the GCRS pole and the mean J2000.0 pole.  They define, with respect to the GCRS frame, a J2000.0 mean pole that is consistent with the rest of the IAU 2000A precession-nutation model.</p></li><li><p>In addition to the displacement of the pole, the complete description of the frame bias requires also an offset in right ascension.  This is not part of the IAU 2000A model, and is from Chapront et al. (2002).  It is returned in radians.</p></li><li><p>This is a supplemented implementation of one aspect of the IAU 2000A nutation model, formally adopted by the IAU General Assembly in 2000, namely MHB2000 (Mathews et al. 2002).</p></li></ol><p><strong>References</strong></p><p>Chapront, J., Chapront-Touze, M. &amp; Francou, G., Astron.  Astrophys., 387, 700, 2002.</p><p>Mathews, P.M., Herring, T.A., Buffet, B.A., &quot;Modeling of nutation and precession: New nutation series for nonrigid Earth and insights into the Earth&#39;s interior&quot;, J.Geophys.Res., 107, B4, 2002.  The MHB2000 code itself was obtained on 2002 September 9 from ftp://maia.usno.navy.mil/conv2000/chapter5/IAU2000A.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3-L41">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.bp00" href="#AstroCouch.SOFA.bp00"><code>AstroCouch.SOFA.bp00</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bp00(day1::Float64, day2::Float64)</code></pre><p>Frame bias and precession, IAU 2000.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as a Julian Date (Note 1)</li><li><code>day2</code>  – ... Julian Date (Note 1)</li></ul><p><strong>Output</strong></p><ul><li><code>rb</code>    – frame bias matrix (Note 2)</li><li><code>rp</code>    – precession matrix (Note 3)</li><li><code>rbp</code>   – bias-precession matrix (Note 4)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    date1         date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix rb transforms vectors from GCRS to mean J2000.0 by applying frame bias.</p></li><li><p>The matrix rp transforms vectors from J2000.0 mean equator and equinox to mean equator and equinox of date by applying precession.</p></li><li><p>The matrix rbp transforms vectors from GCRS to mean equator and equinox of date by applying frame bias then precession.  It is the product rp x rb.</p></li><li><p>It is permissible to re-use the same array in the returned arguments.  The arrays are filled in the order given.</p></li></ol><p><strong>References</strong></p><p>&quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L49-L107">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.bp06" href="#AstroCouch.SOFA.bp06"><code>AstroCouch.SOFA.bp06</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bp06(day1::Float64, day2::Float64)</code></pre><p>Frame bias and precession, IAU 2006.</p><p>This function is part of the International Astronomical Union&#39;s SOFA (Standards of Fundamental Astronomy) software collection.</p><p>Status:  support function.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rb</code>    – frame bias matrix (Note 2)</li><li><code>rp</code>    – precession matrix (Note 3)</li><li><code>rbp</code>   – bias-precession matrix (Note 4)</li></ul><p><strong>Notes</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    date1         date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix rb transforms vectors from GCRS to mean J2000.0 by applying frame bias.</p></li><li><p>The matrix rp transforms vectors from mean J2000.0 to mean of date by applying precession.</p></li><li><p>The matrix rbp transforms vectors from GCRS to mean of date by applying frame bias then precession.  It is the product rp x rb.</p></li><li><p>It is permissible to re-use the same array in the returned arguments.  The arrays are filled in the order given.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p><p>Wallace, P.T. &amp; Capitaine, N., 2006, Astron.Astrophys. 459, 981</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L126-L185">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2i00a" href="#AstroCouch.SOFA.c2i00a"><code>AstroCouch.SOFA.c2i00a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2i00a(day1::Float64, day2::Float64)</code></pre><p>Form the celestial-to-intermediate matrix for a given date using the IAU 2000A precession-nutation model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rc2i</code>  – celestial-to-intermediate matrix (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix rc2i is the first stage in the transformation from celestial to terrestrial coordinates:</p><p>[TRS]  =  RPOM * R_3(ERA) * rc2i * [CRS]</p><pre><code class="nohighlight hljs">      =  rc2t * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), ERA is the Earth Rotation Angle and RPOM is the polar motion matrix.</p></li><li><p>A faster, but slightly less accurate, result (about 1 mas) can be obtained by using instead the eraC2i00b function.</p></li></ol><p><strong>References</strong></p><p>&quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L229-L291">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2i00b" href="#AstroCouch.SOFA.c2i00b"><code>AstroCouch.SOFA.c2i00b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2i00b(day1::Float64, day2::Float64)</code></pre><p>Form the celestial-to-intermediate matrix for a given date using the IAU 2000B precession-nutation model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as 2-part Julian Date (Note 1)</li><li><code>day2</code>  – ... Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rc2i</code>  – celestial-to-intermediate matrix (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix rc2i is the first stage in the transformation from celestial to terrestrial coordinates:</p><p>[TRS]  =  RPOM * R_3(ERA) * rc2i * [CRS]</p><pre><code class="nohighlight hljs">      =  rc2t * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), ERA is the Earth Rotation Angle and RPOM is the polar motion matrix.</p></li><li><p>The present function is faster, but slightly less accurate (about 1 mas), than the eraC2i00a function.</p></li></ol><p><strong>References</strong></p><p>&quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L298-L360">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2i06a" href="#AstroCouch.SOFA.c2i06a"><code>AstroCouch.SOFA.c2i06a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2i06a(day1::Float64, day2::Float64)</code></pre><p>Form the celestial-to-intermediate matrix for a given date using the IAU 2006 precession and IAU 2000A nutation models.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rc2i</code>  – celestial-to-intermediate matrix (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix rc2i is the first stage in the transformation from celestial to terrestrial coordinates:</p><p>[TRS]  =  RPOM * R_3(ERA) * rc2i * [CRS]</p><pre><code class="nohighlight hljs">      =  RC2T * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), ERA is the Earth Rotation Angle and RPOM is the polar motion matrix.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), 2004, IERS Conventions (2003), IERS Technical Note No. 32, BKG</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L367-L419">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2ibpn" href="#AstroCouch.SOFA.c2ibpn"><code>AstroCouch.SOFA.c2ibpn</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2ibpn(day1::Float64, day2::Float64, r::Matrix{Float64})</code></pre><p>Form the celestial-to-intermediate matrix for a given date given the bias-precession-nutation matrix.  IAU 2000.</p><p>#Input</p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... Julian Date</li><li><code>rbpn</code>  – celestial-to-true matrix (Note 2)</li></ul><p><strong>Output</strong></p><ul><li><code>rc2i</code>  – celestial-to-intermediate matrix (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix rbpn transforms vectors from GCRS to true equator (and CIO or equinox) of date.  Only the CIP (bottom row) is used.</p></li><li><p>The matrix rc2i is the first stage in the transformation from celestial to terrestrial coordinates:</p><p>[TRS] = RPOM * R_3(ERA) * rc2i * [CRS]</p><pre><code class="nohighlight hljs">     = RC2T * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), ERA is the Earth Rotation Angle and RPOM is the polar motion matrix.</p></li><li><p>Although its name does not include &quot;00&quot;, This function is in fact specific to the IAU 2000 models.</p></li></ol><p><strong>References</strong></p><p>&quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L428-L494">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2ixy" href="#AstroCouch.SOFA.c2ixy"><code>AstroCouch.SOFA.c2ixy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2ixy(day1::Float64, day2::Float64, x::Float64, y::Float64)</code></pre><p>Form the celestial to intermediate-frame-of-date matrix for a given date when the CIP X,Y coordinates are known.  IAU 2000.</p><p>#Input</p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... Julian Date</li><li><code>x, y</code>  – Celestial Intermediate Pole (Note 2)</li></ul><p><strong>Output</strong></p><ul><li><code>rc2i</code>  – celestial-to-intermediate matrix (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The Celestial Intermediate Pole coordinates are the x,y components of the unit vector in the Geocentric Celestial Reference System.</p></li><li><p>The matrix rc2i is the first stage in the transformation from celestial to terrestrial coordinates:</p><p>[TRS] = RPOM * R_3(ERA) * rc2i * [CRS]</p><pre><code class="nohighlight hljs">     = RC2T * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), ERA is the Earth Rotation Angle and RPOM is the polar motion matrix.</p></li><li><p>Although its name does not include &quot;00&quot;, This function is in fact specific to the IAU 2000 models.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L499-L558">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2ixys" href="#AstroCouch.SOFA.c2ixys"><code>AstroCouch.SOFA.c2ixys</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2ixys(x::Float64, y::Float64, s::Float64)</code></pre><p>Form the celestial to intermediate-frame-of-date matrix given the CIP X,Y and the CIO locator s.</p><p><strong>Input</strong></p><ul><li><code>x, y</code>  – Celestial Intermediate Pole (Note 1)</li><li><code>s</code>     – The CIO locator s (Note 2)</li></ul><p><strong>Output</strong></p><ul><li><code>rc2i</code>  – celestial-to-intermediate matrix (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The Celestial Intermediate Pole coordinates are the x,y components of the unit vector in the Geocentric Celestial Reference System.</p></li><li><p>The CIO locator s (in radians) positions the Celestial Intermediate Origin on the equator of the CIP.</p></li><li><p>The matrix rc2i is the first stage in the transformation from celestial to terrestrial coordinates:</p><p>[TRS] = RPOM * R_3(ERA) * rc2i * [CRS]</p><pre><code class="nohighlight hljs">     = RC2T * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), ERA is the Earth Rotation Angle and RPOM is the polar motion matrix.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L563-L602">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2t00a" href="#AstroCouch.SOFA.c2t00a"><code>AstroCouch.SOFA.c2t00a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2t00a(tt1::Float64, tt2::Float64, ut1::Float64, ut2::Float64, x::Float64,
       y::Float64)</code></pre><p>Form the celestial to terrestrial matrix given the date, the UT1 and the polar motion, using the IAU 2000A precession-nutation model.</p><p><strong>Input</strong></p><ul><li><code>tta, ttb</code> – TT as a 2-part Julian Date (Note 1)</li><li><code>uta, utb</code> – UT1 as a 2-part Julian Date (Note 1)</li><li><code>xp, yp</code>   – CIP coordinates (radians, Note 2)</li></ul><p><strong>Outpu</strong></p><ul><li><code>rc2t</code>  – celestial-to-terrestrial matrix (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT and UT1 dates tta+ttb and uta+utb are Julian Dates, apportioned in any convenient way between the arguments uta and utb.  For example, JD(UT1)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    uta            utb

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 and MJD methods are good compromises between resolution and convenience.  In the case of uta,utb, the date &amp; time method is best matched to the Earth rotation angle algorithm used: maximum precision is delivered when the uta argument is for 0hrs UT1 on the day in question and the utb argument lies in the range 0 to 1, or vice versa.</p></li><li><p>The arguments xp and yp are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.</p></li><li><p>The matrix rc2t transforms from celestial to terrestrial coordinates:</p><p>[TRS] = RPOM * R_3(ERA) * RC2I * [CRS]</p><pre><code class="nohighlight hljs">     = rc2t * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), RC2I is the celestial-to-intermediate matrix, ERA is the Earth rotation angle and RPOM is the polar motion matrix.</p></li><li><p>A faster, but slightly less accurate, result (about 1 mas) can be obtained by using instead the eraC2t00b function.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L609-L674">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2t00b" href="#AstroCouch.SOFA.c2t00b"><code>AstroCouch.SOFA.c2t00b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2t00b(tt1::Float64, tt2::Float64, ut1::Float64, ut2::Float64, x::Float64,
       y::Float64)</code></pre><p>Form the celestial to terrestrial matrix given the date, the UT1 and the polar motion, using the IAU 2000B precession-nutation model.</p><p><strong>Input</strong></p><ul><li><code>tta, ttb</code> – TT as a 2-part Julian Date (Note 1)</li><li><code>uta, utb</code> – UT1 as a 2-part Julian Date (Note 1)</li><li><code>xp, yp</code>   – coordinates of the pole (radians, Note 2)</li></ul><p><strong>Output</strong></p><ul><li><code>rc2t</code>  – celestial-to-terrestrial matrix (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT and UT1 dates tta+ttb and uta+utb are Julian Dates, apportioned in any convenient way between the arguments uta and utb.  For example, JD(UT1)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    uta            utb

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 and MJD methods are good compromises between resolution and convenience.  In the case of uta,utb, the date &amp; time method is best matched to the Earth rotation angle algorithm used: maximum precision is delivered when the uta argument is for 0hrs UT1 on the day in question and the utb argument lies in the range 0 to 1, or vice versa.</p></li><li><p>The arguments xp and yp are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.</p></li><li><p>The matrix rc2t transforms from celestial to terrestrial coordinates:</p><p>[TRS] = RPOM * R_3(ERA) * RC2I * [CRS]</p><pre><code class="nohighlight hljs">     = rc2t * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), RC2I is the celestial-to-intermediate matrix, ERA is the Earth rotation angle and RPOM is the polar motion matrix.</p></li><li><p>The present function is faster, but slightly less accurate (about 1 mas), than the eraC2t00a function.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L684-L749">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2t06a" href="#AstroCouch.SOFA.c2t06a"><code>AstroCouch.SOFA.c2t06a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2t06a(tt1::Float64, tt2::Float64, ut1::Float64, ut2::Float64, x::Float64,
       y::Float64)</code></pre><p>Form the celestial to terrestrial matrix given the date, the UT1 and the polar motion, using the IAU 2006/2000A precession-nutation model.</p><p><strong>Input</strong></p><ul><li><code>tta, ttb</code> – TT as a 2-part Julian Date (Note 1)</li><li><code>uta, utb</code> – UT1 as a 2-part Julian Date (Note 1)</li><li><code>xp, yp</code>   – coordinates of the pole (radians, Note 2)</li></ul><p><strong>Output</strong></p><ul><li><code>rc2t</code>   – celestial-to-terrestrial matrix (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT and UT1 dates tta+ttb and uta+utb are Julian Dates, apportioned in any convenient way between the two arguments uta and utb.  For example, JD(UT1)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    uta            utb

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 and MJD methods are good compromises between resolution and convenience.  In the case of uta,utb, the date &amp; time method is best matched to the Earth rotation angle algorithm used: maximum precision is delivered when the uta argument is for 0hrs UT1 on the day in question and the utb argument lies in the range 0 to 1, or vice versa.</p><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), RC2I is the celestial-to-intermediate matrix, ERA is the Earth rotation angle and RPOM is the polar motion matrix.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), 2004, IERS Conventions (2003), IERS Technical Note No. 32, BKG</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L759-L809">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2tpe" href="#AstroCouch.SOFA.c2tpe"><code>AstroCouch.SOFA.c2tpe</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2tpe(tt1::Float64, tt2::Float64, ut1::Float64, ut2::Float64, ψ::Float64,
      ϵ::Float64, xp::Float64, yp::Float64)</code></pre><p>Form the celestial to terrestrial matrix given the date, the UT1, the nutation and the polar motion.  IAU 2000.</p><p><strong>Input</strong></p><ul><li><code>tta, ttb</code>   – TT as a 2-part Julian Date (Note 1)</li><li><code>uta, utb</code>   – UT1 as a 2-part Julian Date (Note 1)</li><li><code>dpsi, deps</code> – nutation (Note 2)</li><li><code>xp, yp</code>     – coordinates of the pole (radians, Note 3)</li></ul><p><strong>Output</strong></p><ul><li><code>rc2t</code>  – celestial-to-terrestrial matrix (Note 4)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT and UT1 dates tta+ttb and uta+utb are Julian Dates, apportioned in any convenient way between the arguments uta and utb.  For example, JD(UT1)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    uta            utb

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 and MJD methods are good compromises between resolution and convenience.  In the case of uta,utb, the date &amp; time method is best matched to the Earth rotation angle algorithm used: maximum precision is delivered when the uta argument is for 0hrs UT1 on the day in question and the utb argument lies in the range 0 to 1, or vice versa.</p></li><li><p>The caller is responsible for providing the nutation components; they are in longitude and obliquity, in radians and are with respect to the equinox and ecliptic of date.  For high-accuracy applications, free core nutation should be included as well as any other relevant corrections to the position of the CIP.</p></li><li><p>The arguments xp and yp are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.</p></li><li><p>The matrix rc2t transforms from celestial to terrestrial coordinates:</p><p>[TRS] = RPOM * R_3(GST) * RBPN * [CRS]</p><pre><code class="nohighlight hljs">     = rc2t * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), RBPN is the bias-precession-nutation matrix, GST is the Greenwich (apparent) Sidereal Time and RPOM is the polar motion matrix.</p></li><li><p>Although its name does not include &quot;00&quot;, This function is in fact specific to the IAU 2000 models.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L913-L985">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2txy" href="#AstroCouch.SOFA.c2txy"><code>AstroCouch.SOFA.c2txy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2txy(tt1::Float64, tt2::Float64, ut1::Float64, ut2::Float64, x, y, xp, yp)</code></pre><p>Form the celestial to terrestrial matrix given the date, the UT1, the CIP coordinates and the polar motion.  IAU 2000.</p><p><strong>Output</strong></p><ul><li><code>tta, ttb</code> – TT as a 2-part Julian Date (Note 1)</li><li><code>uta, utb</code> – UT1 as a 2-part Julian Date (Note 1)</li><li><code>x, y</code>     – Celestial Intermediate Pole (Note 2)</li><li><code>xp, yp</code>   – coordinates of the pole (radians, Note 3)</li></ul><p><strong>Output</strong></p><ul><li><code>rc2t</code>  – celestial-to-terrestrial matrix (Note 4)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT and UT1 dates tta+ttb and uta+utb are Julian Dates, apportioned in any convenient way between the arguments uta and utb.  For example, JD(UT1)=2450123.7 could be expressed in any o these ways, among others:</p><pre><code class="nohighlight hljs">    uta            utb

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 and MJD methods are good compromises between resolution and convenience.  In the case of uta,utb, the date &amp; time method is best matched to the Earth rotation angle algorithm used: maximum precision is delivered when the uta argument is for 0hrs UT1 on the day in question and the utb argument lies in the range 0 to 1, or vice versa.</p></li><li><p>The Celestial Intermediate Pole coordinates are the x,y components of the unit vector in the Geocentric Celestial Reference System.</p></li><li><p>The arguments xp and yp are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.</p></li><li><p>The matrix rc2t transforms from celestial to terrestrial coordinates:</p><p>[TRS] = RPOM * R_3(ERA) * RC2I * [CRS]</p><pre><code class="nohighlight hljs">     = rc2t * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003), ERA is the Earth Rotation Angle and RPOM is the polar motion matrix.</p></li><li><p>Although its name does not include &quot;00&quot;, This function is in fact specific to the IAU 2000 models.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L998-L1065">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.eo06a" href="#AstroCouch.SOFA.eo06a"><code>AstroCouch.SOFA.eo06a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eo06a(day1::Float64, day2::Float64)</code></pre><p>Equation of the origins, IAU 2006 precession and IAU 2000A nutation.</p><p><strong>Output</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>eos</code>   – the equation of the origins in radians</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The equation of the origins is the distance between the true equinox and the celestial intermediate origin and, equivalently, the difference between Earth rotation angle and Greenwich apparent sidereal time (ERA-GST).  It comprises the precession (since J2000.0) in right ascension plus the equation of the equinoxes (including the small correction terms).</p></li></ol><p><strong>References</strong></p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p><p>Wallace, P.T. &amp; Capitaine, N., 2006, Astron.Astrophys. 459, 981</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1073-L1120">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.eors" href="#AstroCouch.SOFA.eors"><code>AstroCouch.SOFA.eors</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">eors(r::Matrix{Float64}, s::Float64)</code></pre><p>Equation of the origins, given the classical NPB matrix and the quantity s.</p><p><strong>Input</strong></p><ul><li><code>rnpb</code>  – classical nutation x precession x bias matrix</li><li><code>s</code>     – the quantity s (the CIO locator) in radians</li></ul><p><strong>Output</strong></p><ul><li><code>eos</code>   – the equation of the origins in radians</li></ul><p><strong>Note</strong></p><ol><li><p>The equation of the origins is the distance between the true  equinox and the celestial intermediate origin and, equivalently,  the difference between Earth rotation angle and Greenwich apparent  sidereal time (ERA-GST).  It comprises the precession (since  J2000.0) in right ascension plus the equation of the equinoxes  (including the small correction terms).</p></li><li><p>The algorithm is from Wallace &amp; Capitaine (2006).</p></li></ol><p><strong>References</strong></p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p><p>Wallace, P. &amp; Capitaine, N., 2006, Astron.Astrophys. 459, 981</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1129-L1160">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.fw2xy" href="#AstroCouch.SOFA.fw2xy"><code>AstroCouch.SOFA.fw2xy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fw2xy(γ::Float64, ϕ::Float64, ψ::Float64, ϵ::Float64)</code></pre><p>CIP X,Y given Fukushima-Williams bias-precession-nutation angles.</p><p><strong>Input</strong></p><ul><li><code>γb</code>    – F-W angle gamma_bar (radians)</li><li><code>ϕb</code>    – F-W angle phi_bar (radians)</li><li><code>ψ</code>     – F-W angle psi (radians)</li><li><code>ϵ</code>     – F-W angle epsilon (radians)</li></ul><p><strong>Output</strong></p><ul><li><code>x, y</code>  – CIP unit vector X,Y</li></ul><p><strong>Note</strong></p><ol><li><p>Naming the following points:</p><pre><code class="nohighlight hljs">  e = J2000.0 ecliptic pole,
  p = GCRS pole
  E = ecliptic pole of date,</code></pre><p>and   P = CIP,</p><p>the four Fukushima-Williams angles are as follows:</p><p>γb = γ = epE    ϕb = ϕ = pE    ψ = ψ = pEP    ϵ = ϵ = EP</p></li><li><p>The matrix representing the combined effects of frame bias, precession and nutation is:</p><p>NxPxB = R<em>1(-ϵA).R</em>3(-ψ).R<em>1(ϕb).R</em>3(γb)</p><p>The returned values x,y are elements [2][0] and [2][1] of the matrix.  Near J2000.0, they are essentially angles in radians.</p></li></ol><p><strong>References</strong></p><p>Hilton, J. et al., 2006, Celest.Mech.Dyn.Astron. 94, 351</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1230-L1273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.ltp" href="#AstroCouch.SOFA.ltp"><code>AstroCouch.SOFA.ltp</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ltp(epoch::Float64)</code></pre><p>Long-term precession matrix.</p><p><strong>Input</strong></p><ul><li><code>epoch</code> – Julian epoch (TT)</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>     – precession matrix, J2000.0 to date</li></ul><p><strong>Note</strong></p><ol><li><p>The matrix is in the sense</p><p>P<em>date = rp x P</em>J2000,</p><p>where P<em>J2000 is a vector with respect to the J2000.0 mean equator and equinox and P</em>date is the same vector with respect to the equator and equinox of epoch epj.</p></li><li><p>The Vondrak et al. (2011, 2012) 400 millennia precession model agrees with the IAU 2006 precession at J2000.0 and stays within 100 microarcseconds during the 20th and 21st centuries.  It is accurate to a few arcseconds throughout the historical period, worsening to a few tenths of a degree at the end of the +/- 200,000 year time span.</p></li></ol><p><strong>References</strong></p><p>Vondrak, J., Capitaine, N. and Wallace, P., 2011, New precession expressions, valid for long time intervals, Astron.Astrophys. 534, A22</p><p>Vondrak, J., Capitaine, N. and Wallace, P., 2012, New precession expressions, valid for long time intervals (Corrigendum), Astron.Astrophys. 541, C1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1278-L1316">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.ltpb" href="#AstroCouch.SOFA.ltpb"><code>AstroCouch.SOFA.ltpb</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ltpb(epoch::Float64)</code></pre><p>Long-term precession matrix, including ICRS frame bias.</p><p><strong>Input</strong></p><ul><li><code>epoch</code> – Julian epoch (TT)</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>     – precession-bias matrix, J2000.0 to date</li></ul><p><strong>Note</strong></p><ol><li><p>The matrix is in the sense</p><p>P<em>date = rpb x P</em>ICRS,</p><p>where P<em>ICRS is a vector in the Geocentric Celestial Reference System, and P</em>date is the vector with respect to the Celestial Intermediate Reference System at that date but with nutation neglected.</p></li><li><p>A first order frame bias formulation is used, of sub- microarcsecond accuracy compared with a full 3D rotation.</p></li><li><p>The Vondrak et al. (2011, 2012) 400 millennia precession model agrees with the IAU 2006 precession at J2000.0 and stays within 100 microarcseconds during the 20th and 21st centuries.  It is accurate to a few arcseconds throughout the historical period, worsening to a few tenths of a degree at the end of the +/- 200,000 year time span.</p></li></ol><p><strong>References</strong></p><p>Vondrak, J., Capitaine, N. and Wallace, P., 2011, New precession expressions, valid for long time intervals, Astron.Astrophys. 534, A22</p><p>Vondrak, J., Capitaine, N. and Wallace, P., 2012, New precession expressions, valid for long time intervals (Corrigendum), Astron.Astrophys. 541, C1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1326-L1368">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.ltpecl" href="#AstroCouch.SOFA.ltpecl"><code>AstroCouch.SOFA.ltpecl</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ltpecl(epoch::Float64)</code></pre><p>Long-term precession of the ecliptic.</p><p><strong>Input</strong></p><ul><li><code>epoch</code> – Julian epoch (TT)</li></ul><p><strong>Output</strong></p><ul><li><code>pos</code>   – ecliptic pole unit vector</li></ul><p><strong>Note</strong></p><ol><li><p>The returned vector is with respect to the J2000.0 mean equator and equinox.</p></li><li><p>The Vondrak et al. (2011, 2012) 400 millennia precession model agrees with the IAU 2006 precession at J2000.0 and stays within 100 microarcseconds during the 20th and 21st centuries.  It is accurate to a few arcseconds throughout the historical period, worsening to a few tenths of a degree at the end of the +/- 200,000 year time span.</p></li></ol><p><strong>References</strong></p><p>Vondrak, J., Capitaine, N. and Wallace, P., 2011, New precession expressions, valid for long time intervals, Astron.Astrophys. 534, A22</p><p>Vondrak, J., Capitaine, N. and Wallace, P., 2012, New precession expressions, valid for long time intervals (Corrigendum), Astron.Astrophys. 541, C1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1376-L1409">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.ltpequ" href="#AstroCouch.SOFA.ltpequ"><code>AstroCouch.SOFA.ltpequ</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ltpequ(epoch::Float64)</code></pre><p>Long-term precession of the equator.</p><p><strong>Input</strong></p><ul><li><code>epoch</code> – Julian epoch (TT)</li></ul><p><strong>Output</strong></p><ul><li><code>pos</code>   – equator pole unit vector</li></ul><p><strong>Note</strong></p><ol><li><p>The returned vector is with respect to the J2000.0 mean equator and equinox.</p></li><li><p>The Vondrak et al. (2011, 2012) 400 millennia precession model agrees with the IAU 2006 precession at J2000.0 and stays within 100 microarcseconds during the 20th and 21st centuries.  It is accurate to a few arcseconds throughout the historical period, worsening to a few tenths of a degree at the end of the +/- 200,000 year time span.</p></li></ol><p><strong>References</strong></p><p>Vondrak, J., Capitaine, N. and Wallace, P., 2011, New precession expressions, valid for long time intervals, Astron.Astrophys. 534, A22</p><p>Vondrak, J., Capitaine, N. and Wallace, P., 2012, New precession expressions, valid for long time intervals (Corrigendum), Astron.Astrophys. 541, C1</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1423-L1456">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.num06a" href="#AstroCouch.SOFA.num06a"><code>AstroCouch.SOFA.num06a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">num06a(day1::Float64, day2::Float64)</code></pre><p>Form the matrix of nutation for a given date, IAU 2006/2000A model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rmatn</code> – nutation matrix</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(true) = rmatn * V(mean), where the p-vector V(true) is with respect to the true equatorial triad of date and the p-vector V(mean) is with respect to the mean equatorial triad of date.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1571-L1610">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.numat" href="#AstroCouch.SOFA.numat"><code>AstroCouch.SOFA.numat</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">numat(ϵA::Float64, δψ::Float64, δϵ::Float64)</code></pre><p>Form the matrix of nutation.</p><p><strong>Input</strong></p><ul><li><code>epsa</code>  – mean obliquity of date (Note 1)</li><li><code>dpsi, deps</code> – nutation (Note 2)</li></ul><p><strong>Output</strong></p><ul><li><code>rmatn</code> – nutation matrix (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The supplied mean obliquity epsa, must be consistent with the precession-nutation models from which dpsi and deps were obtained.</p></li><li><p>The caller is responsible for providing the nutation components; they are in longitude and obliquity, in radians and are with respect to the equinox and ecliptic of date.</p></li><li><p>The matrix operates in the sense V(true) = rmatn * V(mean), where the p-vector V(true) is with respect to the true equatorial triad of date and the p-vector V(mean) is with respect to the mean equatorial triad of date.</p></li></ol><p><strong>References</strong></p><p>Explanatory Supplement to the Astronomical Almanac, P. Kenneth Seidelmann (ed), University Science Books (1992), Section 3.222-3 (p114).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1616-L1649">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.nut00a" href="#AstroCouch.SOFA.nut00a"><code>AstroCouch.SOFA.nut00a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nut00a(day1::Float64, day2::Float64)</code></pre><p>Nutation, IAU 2000A model (MHB2000 luni-solar and planetary nutation with free core nutation omitted).</p><p><strong>Input</strong></p><ul><li><code>day1</code>   – TT as Julian Date (Note 1)</li><li><code>day2</code>   – ... as Julian Date</li></ul><p><strong>Ouput</strong></p><ul><li><code>dpsi, deps</code> – nutation, luni-solar + planetary (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The nutation components in longitude and obliquity are in radians and with respect to the equinox and ecliptic of date.  The obliquity at J2000.0 is assumed to be the Lieske et al. (1977) value of 84381.448 arcsec.</p><p>Both the luni-solar and planetary nutations are included.  The latter are due to direct planetary nutations and the perturbations of the lunar and terrestrial orbits.</p></li><li><p>The function computes the MHB2000 nutation series with the associated corrections for planetary nutations.  It is an implementation of the nutation part of the IAU 2000A precession- nutation model, formally adopted by the IAU General Assembly in 2000, namely MHB2000 (Mathews et al. 2002), but with the free core nutation (FCN - see Note 4) omitted.</p></li><li><p>The full MHB2000 model also contains contributions to the nutations in longitude and obliquity due to the free-excitation of the free-core-nutation during the period 1979-2000.  These FCN terms, which are time-dependent and unpredictable, are NOT included in the present function and, if required, must be independently computed. With the FCN corrections included, the present function delivers a pole which is at current epochs accurate to a few hundred microarcseconds.  The omission of FCN introduces further errors of about that size.</p></li><li><p>The present function provides classical nutation.  The MHB2000 algorithm, from which it is adapted, deals also with (i) the offsets between the GCRS and mean poles and (ii) the adjustments in longitude and obliquity due to the changed precession rates.  These additional functions, namely frame bias and precession adjustments, are supported by the ERFA functions eraBi00 and eraPr00.</p></li><li><p>The MHB2000 algorithm also provides &quot;total&quot; nutations, comprising the arithmetic sum of the frame bias, precession adjustments, luni-solar nutation and planetary nutation.  These total nutations can be used in combination with an existing IAU 1976 precession implementation, such as eraPmat76, to deliver GCRS- to-true predictions of sub-mas accuracy at current dates.  However, there are three shortcomings in the MHB2000 model that must be taken into account if more accurate or definitive results are required (see Wallace 2002):</p><p>(i) The MHB2000 total nutations are simply arithmetic sums,       yet in reality the various components are successive Euler       rotations.  This slight lack of rigor leads to cross terms       that exceed 1 mas after a century.  The rigorous procedure       is to form the GCRS-to-true rotation matrix by applying the       bias, precession and nutation in that order.</p><p>(ii) Although the precession adjustments are stated to be with       respect to Lieske et al. (1977), the MHB2000 model does       not specify which set of Euler angles are to be used and       how the adjustments are to be applied.  The most literal       and straightforward procedure is to adopt the 4-rotation       epsilon<em>0, psi</em>A, omega<em>A, xi</em>A option, and to add DPSIPR       to psi<em>A and DEPSPR to both omega</em>A and eps_A.</p><p>(iii) The MHB2000 model predates the determination by Chapront       et al. (2002) of a 14.6 mas displacement between the       J2000.0 mean equinox and the origin of the ICRS frame.  It       should, however, be noted that neglecting this displacement       when calculating star coordinates does not lead to a       14.6 mas change in right ascension, only a small second-       order distortion in the pattern of the precession-nutation       effect.</p><p>For these reasons, the ERFA functions do not generate the &quot;total nutations&quot; directly, though they can of course easily be generated by calling eraBi00, eraPr00 and the present function and adding the results.</p></li><li><p>The MHB2000 model contains 41 instances where the same frequency appears multiple times, of which 38 are duplicates and three are triplicates.  To keep the present code close to the original MHB algorithm, this small inefficiency has not been corrected.</p></li></ol><p><strong>References</strong></p><p>Chapront, J., Chapront-Touze, M. &amp; Francou, G. 2002, Astron.Astrophys. 387, 700</p><p>Lieske, J.H., Lederle, T., Fricke, W. &amp; Morando, B. 1977, Astron.Astrophys. 58, 1-16</p><p>Mathews, P.M., Herring, T.A., Buffet, B.A. 2002, J.Geophys.Res.  107, B4.  The MHB_2000 code itself was obtained on 9th September 2002 from ftp//maia.usno.navy.mil/conv2000/chapter5/IAU2000A.</p><p>Simon, J.-L., Bretagnon, P., Chapront, J., Chapront-Touze, M., Francou, G., Laskar, J. 1994, Astron.Astrophys. 282, 663-683</p><p>Souchay, J., Loysel, B., Kinoshita, H., Folgueira, M. 1999, Astron.Astrophys.Supp.Ser. 135, 111</p><p>Wallace, P.T., &quot;Software for Implementing the IAU 2000 Resolutions&quot;, in IERS Workshop 5.1 (2002)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1654-L1787">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.nut00b" href="#AstroCouch.SOFA.nut00b"><code>AstroCouch.SOFA.nut00b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nut00b(day1::Float64, day2::Float64)</code></pre><p>Nutation, IAU 2000B model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>dpsi, deps</code> – nutation, luni-solar + planetary (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The nutation components in longitude and obliquity are in radians and with respect to the equinox and ecliptic of date.  The obliquity at J2000.0 is assumed to be the Lieske et al. (1977) value of 84381.448 arcsec.  (The errors that result from using this function with the IAU 2006 value of 84381.406 arcsec can be neglected.)</p><p>The nutation model consists only of luni-solar terms, but includes also a fixed offset which compensates for certain long- period planetary terms (Note 7).</p></li><li><p>This function is an implementation of the IAU 2000B abridged nutation model formally adopted by the IAU General Assembly in</p><ol><li>The function computes the MHB<em>2000</em>SHORT luni-solar nutation</li></ol><p>series (Luzum 2001), but without the associated corrections for the precession rate adjustments and the offset between the GCRS and J2000.0 mean poles.</p></li><li><p>The full IAU 2000A (MHB2000) nutation model contains nearly 1400 terms.  The IAU 2000B model (McCarthy &amp; Luzum 2003) contains only 77 terms, plus additional simplifications, yet still delivers results of 1 mas accuracy at present epochs.  This combination of accuracy and size makes the IAU 2000B abridged nutation model suitable for most practical applications.</p><p>The function delivers a pole accurate to 1 mas from 1900 to 2100 (usually better than 1 mas, very occasionally just outside 1 mas). The full IAU 2000A model, which is implemented in the function eraNut00a (q.v.), delivers considerably greater accuracy at current dates; however, to realize this improved accuracy, corrections for the essentially unpredictable free-core-nutation (FCN) must also be included.</p></li><li><p>The present function provides classical nutation.  The MHB<em>2000</em>SHORT algorithm, from which it is adapted, deals also with (i) the offsets between the GCRS and mean poles and (ii) the adjustments in longitude and obliquity due to the changed precession rates.  These additional functions, namely frame bias and precession adjustments, are supported by the ERFA functions eraBi00 and eraPr00.</p></li><li><p>The MHB<em>2000</em>SHORT algorithm also provides &quot;total&quot; nutations, comprising the arithmetic sum of the frame bias, precession adjustments, and nutation (luni-solar + planetary).  These total nutations can be used in combination with an existing IAU 1976 precession implementation, such as eraPmat76, to deliver GCRS- to-true predictions of mas accuracy at current epochs.  However, for symmetry with the eraNut00a function (q.v. for the reasons), the ERFA functions do not generate the &quot;total nutations&quot; directly. Should they be required, they could of course easily be generated by calling eraBi00, eraPr00 and the present function and adding the results.</p></li><li><p>The IAU 2000B model includes &quot;planetary bias&quot; terms that are fixed in size but compensate for long-period nutations.  The amplitudes quoted in McCarthy &amp; Luzum (2003), namely Dpsi = -1.5835 mas and Depsilon = +1.6339 mas, are optimized for the &quot;total nutations&quot; method described in Note 6.  The Luzum (2001) values used in this ERFA implementation, namely -0.135 mas and +0.388 mas, are optimized for the &quot;rigorous&quot; method, where frame bias, precession and nutation are applied separately and in that order.  During the interval 1995-2050, the ERFA implementation delivers a maximum error of 1.001 mas (not including FCN).</p></li></ol><p><strong>References</strong></p><p>Lieske, J.H., Lederle, T., Fricke, W., Morando, B., &quot;Expressions for the precession quantities based upon the IAU /1976/ system of astronomical constants&quot;, Astron.Astrophys. 58, 1-2, 1-16. (1977)</p><p>Luzum, B., private communication, 2001 (Fortran code MHB<em>2000</em>SHORT)</p><p>McCarthy, D.D. &amp; Luzum, B.J., &quot;An abridged model of the precession-nutation of the celestial pole&quot;, Cel.Mech.Dyn.Astron.  85, 37-49 (2003)</p><p>Simon, J.-L., Bretagnon, P., Chapront, J., Chapront-Touze, M., Francou, G., Laskar, J., Astron.Astrophys. 282, 663-683 (1994)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1859-L1972">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.nut06a" href="#AstroCouch.SOFA.nut06a"><code>AstroCouch.SOFA.nut06a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nut06a(day1::Float64, day2::Float64)</code></pre><p>IAU 2000A nutation with adjustments to match the IAU 2006 precession.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>dpsi, deps</code> – nutation, luni-solar + planetary (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The nutation components in longitude and obliquity are in radians and with respect to the mean equinox and ecliptic of date, IAU 2006 precession model (Hilton et al. 2006, Capitaine et al.  2005).</p></li><li><p>The function first computes the IAU 2000A nutation, then applies adjustments for (i) the consequences of the change in obliquity from the IAU 1980 ecliptic to the IAU 2006 ecliptic and (ii) the secular variation in the Earth&#39;s dynamical form factor J2.</p></li><li><p>The present function provides classical nutation, complementing the IAU 2000 frame bias and IAU 2006 precession.  It delivers a pole which is at current epochs accurate to a few tens of microarcseconds, apart from the free core nutation.</p></li></ol><p><strong>References</strong></p><p>Chapront, J., Chapront-Touze, M. &amp; Francou, G. 2002, Astron.Astrophys. 387, 700</p><p>Lieske, J.H., Lederle, T., Fricke, W. &amp; Morando, B. 1977, Astron.Astrophys. 58, 1-16</p><p>Mathews, P.M., Herring, T.A., Buffet, B.A. 2002, J.Geophys.Res.  107, B4.  The MHB_2000 code itself was obtained on 9th September 2002 from ftp//maia.usno.navy.mil/conv2000/chapter5/IAU2000A.</p><p>Simon, J.-L., Bretagnon, P., Chapront, J., Chapront-Touze, M., Francou, G., Laskar, J. 1994, Astron.Astrophys. 282, 663-683</p><p>Souchay, J., Loysel, B., Kinoshita, H., Folgueira, M. 1999, Astron.Astrophys.Supp.Ser. 135, 111</p><p>Wallace, P.T., &quot;Software for Implementing the IAU 2000 Resolutions&quot;, in IERS Workshop 5.1 (2002)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2009-L2078">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.nut80" href="#AstroCouch.SOFA.nut80"><code>AstroCouch.SOFA.nut80</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nut80(day1::Float64, day2::Float64)</code></pre><p>Nutation, IAU 1980 model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>   – TT as Julian Date (Note 1)</li><li><code>day2</code>   – ... Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>dpsi</code>   – nutation in longitude (radians)</li><li><code>deps</code>   – nutation in obliquity (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The nutation components are with respect to the ecliptic of date.</p></li></ol><p><strong>References</strong></p><p>Explanatory Supplement to the Astronomical Almanac, P. Kenneth Seidelmann (ed), University Science Books (1992), Section 3.222 (p111).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2089-L2132">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.nutm80" href="#AstroCouch.SOFA.nutm80"><code>AstroCouch.SOFA.nutm80</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">nutm80(day1::Float64, day2::Float64)</code></pre><p>Form the matrix of nutation for a given date, IAU 1980 model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TDB date (Note 1)</li><li><code>day2</code>  – ... TDB date</li></ul><p><strong>Output</strong></p><p>rmatn          double[3][3]    nutation matrix</p><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(true) = rmatn * V(mean), where the p-vector V(true) is with respect to the true equatorial triad of date and the p-vector V(mean) is with respect to the mean equatorial triad of date.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2166-L2204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.obl06" href="#AstroCouch.SOFA.obl06"><code>AstroCouch.SOFA.obl06</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obl06(day1::Float64, day2::Float64)</code></pre><p>Mean obliquity of the ecliptic, IAU 2006 precession model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>ϵ</code>     – obliquity of the ecliptic (radians, Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date day1+day2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   day1          day2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The result is the angle between the ecliptic and mean equator of date day1+day2.</p></li></ol><p><strong>References</strong></p><p>Hilton, J. et al., 2006, Celest.Mech.Dyn.Astron. 94, 351</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2211-L2252">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.obl80" href="#AstroCouch.SOFA.obl80"><code>AstroCouch.SOFA.obl80</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">obl80(day1::Float64, day2::Float64)</code></pre><p>Mean obliquity of the ecliptic, IAU 1980 model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>obl</code>   – obliquity of the ecliptic (radians, Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The result is the angle between the ecliptic and mean equator of date date1+date2.</p></li></ol><p><strong>References</strong></p><p>Explanatory Supplement to the Astronomical Almanac, P. Kenneth Seidelmann (ed), University Science Books (1992), Expression 3.222-1 (p114).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2257-L2301">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.p06e" href="#AstroCouch.SOFA.p06e"><code>AstroCouch.SOFA.p06e</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">p06e(day1::Float64, day2::Float64)</code></pre><p>Precession angles, IAU 2006, equinox based.</p><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>This function returns the set of equinox based angles for the Capitaine et al. &quot;P03&quot; precession theory, adopted by the IAU in</p><ol><li>The angles are set out in Table 1 of Hilton et al. (2006):</li></ol><p>eps0   epsilon<em>0   obliquity at J2000.0 psia   psi</em>A       luni-solar precession oma    omega<em>A     inclination of equator wrt J2000.0 ecliptic bpa    P</em>A         ecliptic pole x, J2000.0 ecliptic triad bqa    Q<em>A         ecliptic pole -y, J2000.0 ecliptic triad pia    pi</em>A        angle between moving and J2000.0 ecliptics bpia   Pi<em>A        longitude of ascending node of the ecliptic epsa   epsilon</em>A   obliquity of the ecliptic chia   chi<em>A       planetary precession za     z</em>A         equatorial precession: -3rd 323 Euler angle zetaa  zeta<em>A      equatorial precession: -1st 323 Euler angle thetaa theta</em>A     equatorial precession: 2nd 323 Euler angle pa     p<em>A         general precession (n.b. see below) gam    gamma</em>J2000 J2000.0 RA difference of ecliptic poles phi    phi<em>J2000   J2000.0 codeclination of ecliptic pole psi    psi</em>J2000   longitude difference of equator poles, J2000.0</p><p>The returned values are all radians.</p><p>Note that the t^5 coefficient in the series for p_A from Capitaine et al. (2003) is incorrectly signed in Hilton et al.  (2006).</p></li><li><p>Hilton et al. (2006) Table 1 also contains angles that depend on models distinct from the P03 precession theory itself, namely the IAU 2000A frame bias and nutation.  The quoted polynomials are used in other ERFA functions:</p><p>. eraXy06  contains the polynomial parts of the X and Y series.</p><p>. eraS06  contains the polynomial part of the s+XY/2 series.</p><p>. eraPfw06  implements the series for the Fukushima-Williams   angles that are with respect to the GCRS pole (i.e. the variants   that include frame bias).</p></li><li><p>The IAU resolution stipulated that the choice of parameterization was left to the user, and so an IAU compliant precession implementation can be constructed using various combinations of the angles returned by the present function.</p></li><li><p>The parameterization used by ERFA is the version of the Fukushima- Williams angles that refers directly to the GCRS pole.  These angles may be calculated by calling the function eraPfw06.  ERFA also supports the direct computation of the CIP GCRS X,Y by series, available by calling eraXy06.</p></li><li><p>The agreement between the different parameterizations is at the 1 microarcsecond level in the present era.</p></li><li><p>When constructing a precession formulation that refers to the GCRS pole rather than the dynamical pole, it may (depending on the choice of angles) be necessary to introduce the frame bias explicitly.</p></li><li><p>It is permissible to re-use the same variable in the returned arguments.  The quantities are stored in the stated order.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Wallace, P.T. &amp; Chapront, J., 2003, Astron.Astrophys., 412, 567</p><p>Hilton, J. et al., 2006, Celest.Mech.Dyn.Astron. 94, 351</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2306-L2399">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pb06" href="#AstroCouch.SOFA.pb06"><code>AstroCouch.SOFA.pb06</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pb06(day1::Float64, day2::Float64)</code></pre><p>This function forms three Euler angles which implement general precession from epoch J2000.0, using the IAU 2006 model.  Frame bias (the offset between ICRS and mean J2000.0) is included.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>ζ</code>    – 1st rotation: radians cw around z</li><li><code>θ</code>    – 2nd rotation: radians ccw around y</li><li><code>z</code>    – 3rd rotation: radians cw around z</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The traditional accumulated precession angles zeta<em>A, z</em>A, theta_A cannot be obtained in the usual way, namely through polynomial expressions, because of the frame bias.  The latter means that two of the angles undergo rapid changes near this date.  They are instead the results of decomposing the precession-bias matrix obtained by using the Fukushima-Williams method, which does not suffer from the problem.  The decomposition returns values which can be used in the conventional formulation and which include frame bias.</p></li><li><p>The three angles are returned in the conventional order, which is not the same as the order of the corresponding Euler rotations. The precession-bias matrix is R<em>3(-z) x R</em>2(+theta) x R_3(-zeta).</p></li><li><p>Should zeta<em>A, z</em>A, theta_A angles be required that do not contain frame bias, they are available by calling the ERFA function eraP06e.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2436-L2492">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pfw06" href="#AstroCouch.SOFA.pfw06"><code>AstroCouch.SOFA.pfw06</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pfw06(day1::Float64, day2::Float64)</code></pre><p>Precession angles, IAU 2006 (Fukushima-Williams 4-angle formulation).</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>gamb</code>  – F-W angle gamma_bar (radians)</li><li><code>phib</code>  – F-W angle phi_bar (radians)</li><li><code>psib</code>  – F-W angle psi_bar (radians)</li><li><code>epsa</code>  – F-W angle epsilon_A (radians)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>Naming the following points:</p><pre><code class="nohighlight hljs">  e = J2000.0 ecliptic pole,
  p = GCRS pole,
  E = mean ecliptic pole of date,</code></pre><p>and   P = mean pole of date,</p><p>the four Fukushima-Williams angles are as follows:</p><p>gamb = gamma<em>bar = epE    phib = phi</em>bar = pE    psib = psi<em>bar = pEP    epsa = epsilon</em>A = EP</p></li><li><p>The matrix representing the combined effects of frame bias and precession is:</p><p>PxB = R<em>1(-epsa).R</em>3(-psib).R<em>1(phib).R</em>3(gamb)</p></li><li><p>The matrix representing the combined effects of frame bias, precession and nutation is simply:</p><p>NxPxB = R<em>1(-epsa-dE).R</em>3(-psib-dP).R<em>1(phib).R</em>3(gamb)</p><p>where dP and dE are the nutation components with respect to the ecliptic of date.</p></li></ol><p><strong>References</strong></p><p>Hilton, J. et al., 2006, Celest.Mech.Dyn.Astron. 94, 351</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2506-L2574">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pmat00" href="#AstroCouch.SOFA.pmat00"><code>AstroCouch.SOFA.pmat00</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pmat00(day1::Float64, day2::Float64)</code></pre><p>Precession matrix (including frame bias) from GCRS to a specified date, IAU 2000 model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rbp</code>   – bias-precession matrix (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(date) = rbp * V(GCRS), where the p-vector V(GCRS) is with respect to the Geocentric Celestial Reference System (IAU, 2000) and the p-vector V(date) is with respect to the mean equatorial triad of the given date.</p></li></ol><p><strong>References</strong></p><p>IAU: Trans. International Astronomical Union, Vol. XXIVB; Proc.  24th General Assembly, Manchester, UK.  Resolutions B1.3, B1.6.  (2000)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2583-L2628">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pmat06" href="#AstroCouch.SOFA.pmat06"><code>AstroCouch.SOFA.pmat06</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pmat06(day1::Float64, day2::Float64)</code></pre><p>Precession matrix (including frame bias) from GCRS to a specified date, IAU 2006 model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>     – bias-precession matrix (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date day1+day2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   day1          day2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(date) = rbp * V(GCRS), where the p-vector V(GCRS) is with respect to the Geocentric Celestial Reference System (IAU, 2000) and the p-vector V(date) is with respect to the mean equatorial triad of the given date.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p><p>IAU: Trans. International Astronomical Union, Vol. XXIVB; Proc.  24th General Assembly, Manchester, UK.  Resolutions B1.3, B1.6.  (2000)</p><p>Wallace, P.T. &amp; Capitaine, N., 2006, Astron.Astrophys. 459, 981</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2634-L2683">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pmat76" href="#AstroCouch.SOFA.pmat76"><code>AstroCouch.SOFA.pmat76</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pmat76(day1::Float64, day2::Float64)</code></pre><p>Precession matrix from J2000.0 to a specified date, IAU 1976 model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – ending date, TT (Note 1)</li><li><code>day2</code>  – ending date, TT (Note 1)</li></ul><p><strong>Output</strong></p><ul><li><code>rmatp</code> – precession matrix, J2000.0 -&gt; date1+date2</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(date) = RMATP * V(J2000), where the p-vector V(J2000) is with respect to the mean equatorial triad of epoch J2000.0 and the p-vector V(date) is with respect to the mean equatorial triad of the given date.</p></li><li><p>Though the matrix method itself is rigorous, the precession angles are expressed through canonical polynomials which are valid only for a limited time span.  In addition, the IAU 1976 precession rate is known to be imperfect.  The absolute accuracy of the present formulation is better than 0.1 arcsec from 1960AD to 2040AD, better than 1 arcsec from 1640AD to 2360AD, and remains below 3 arcsec for the whole of the period 500BC to 3000AD.  The errors exceed 10 arcsec outside the range 1200BC to 3900AD, exceed 100 arcsec outside 4200BC to 5600AD and exceed 1000 arcsec outside 6800BC to 8200AD.</p></li></ol><p><strong>References</strong></p><p>Lieske, J.H., 1979, Astron.Astrophys. 73, 282.  equations (6) &amp; (7), p283.</p><p>Kaplan,G.H., 1981. USNO circular no. 163, pA2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2692-L2749">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pn00" href="#AstroCouch.SOFA.pn00"><code>AstroCouch.SOFA.pn00</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pn00(day1::Float64, day2::Float64, ψ::Float64, ϵ::Float64)</code></pre><p>Precession-nutation, IAU 2000 model: a multi-purpose function, supporting classical (equinox-based) use directly and CIO-based use indirectly.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li><li><code>dpsi,deps</code> – nutation (Note 2)</li></ul><p><strong>Output</strong></p><ul><li><code>epsa</code>  – mean obliquity (Note 3)</li><li><code>rb</code>    – frame bias matrix (Note 4)</li><li><code>rp</code>    – precession matrix (Note 5)</li><li><code>rbp</code>   – bias-precession matrix (Note 6)</li><li><code>rn</code>    – nutation matrix (Note 7)</li><li><code>rbpn</code>  – GCRS-to-true matrix (Note 8)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The caller is responsible for providing the nutation components; they are in longitude and obliquity, in radians and are with respect to the equinox and ecliptic of date.  For high-accuracy applications, free core nutation should be included as well as any other relevant corrections to the position of the CIP.</p></li><li><p>The returned mean obliquity is consistent with the IAU 2000 precession-nutation models.</p></li><li><p>The matrix rb transforms vectors from GCRS to J2000.0 mean equator and equinox by applying frame bias.</p></li><li><p>The matrix rp transforms vectors from J2000.0 mean equator and equinox to mean equator and equinox of date by applying precession.</p></li><li><p>The matrix rbp transforms vectors from GCRS to mean equator and equinox of date by applying frame bias then precession.  It is the product rp x rb.</p></li><li><p>The matrix rn transforms vectors from mean equator and equinox of date to true equator and equinox of date by applying the nutation (luni-solar + planetary).</p></li><li><p>The matrix rbpn transforms vectors from GCRS to true equator and equinox of date.  It is the product rn x rbp, applying frame bias, precession and nutation in that order.</p></li><li><p>It is permissible to re-use the same array in the returned arguments.  The arrays are filled in the order given.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Chapront, J., Lambert, S. and Wallace, P., &quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2756-L2838">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pn00a" href="#AstroCouch.SOFA.pn00a"><code>AstroCouch.SOFA.pn00a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pn00a(day1::Float64, day2::Float64)</code></pre><p>Precession-nutation, IAU 2000A model: a multi-purpose function, supporting classical (equinox-based) use directly and CIO-based use indirectly.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li>`day2   – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>dpsi, deps</code> – nutation (Note 2)</li><li><code>epsa</code>  – mean obliquity (Note 3)</li><li><code>rb</code>    – frame bias matrix (Note 4)</li><li><code>rp</code>    – precession matrix (Note 5)</li><li><code>rbp</code>   – bias-precession matrix (Note 6)</li><li><code>rn</code>    – nutation matrix (Note 7)</li><li><code>rbpn</code>  – GCRS-to-true matrix (Notes 8,9)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    date1          date2

 2450123.7           0.0       (JD method)
 2451545.0       -1421.3       (J2000 method)
 2400000.5       50123.2       (MJD method)
 2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The nutation components (luni-solar + planetary, IAU 2000A) in longitude and obliquity are in radians and with respect to the equinox and ecliptic of date.  Free core nutation is omitted; for the utmost accuracy, use the eraPn00 function, where the nutation components are caller-specified.  For faster but slightly less accurate results, use the eraPn00b function.</p></li><li><p>The mean obliquity is consistent with the IAU 2000 precession.</p></li><li><p>The matrix rb transforms vectors from GCRS to J2000.0 mean equator and equinox by applying frame bias.</p></li><li><p>The matrix rp transforms vectors from J2000.0 mean equator and equinox to mean equator and equinox of date by applying precession.</p></li><li><p>The matrix rbp transforms vectors from GCRS to mean equator and equinox of date by applying frame bias then precession.  It is the product rp x rb.</p></li><li><p>The matrix rn transforms vectors from mean equator and equinox of date to true equator and equinox of date by applying the nutation (luni-solar + planetary).</p></li><li><p>The matrix rbpn transforms vectors from GCRS to true equator and equinox of date.  It is the product rn x rbp, applying frame bias, precession and nutation in that order.</p></li><li><p>The X,Y,Z coordinates of the IAU 2000A Celestial Intermediate Pole are elements (3,1-3) of the GCRS-to-true matrix, i.e. rbpn[2][0-2].</p></li><li><p>It is permissible to re-use the same array in the returned  arguments.  The arrays are filled in the stated order.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Chapront, J., Lambert, S. and Wallace, P., &quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2852-L2937">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pn00b" href="#AstroCouch.SOFA.pn00b"><code>AstroCouch.SOFA.pn00b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pn00b(day1::Float64, day2::Float64)</code></pre><p>Precession-nutation, IAU 2000B model: a multi-purpose function, supporting classical (equinox-based) use directly and CIO-based use indirectly.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>dpsi, deps</code> – nutation (Note 2)</li><li><code>epsa</code>  – mean obliquity (Note 3)</li><li><code>rb</code>    – frame bias matrix (Note 4)</li><li><code>rp</code>    – precession matrix (Note 5)</li><li><code>rbp</code>   – bias-precession matrix (Note 6)</li><li><code>rn</code>    – nutation matrix (Note 7)</li><li><code>rbpn</code>  – GCRS-to-true matrix (Notes 8,9)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    date1          date2

 2450123.7           0.0       (JD method)
 2451545.0       -1421.3       (J2000 method)
 2400000.5       50123.2       (MJD method)
 2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The nutation components (luni-solar + planetary, IAU 2000B) in longitude and obliquity are in radians and with respect to the equinox and ecliptic of date.  For more accurate results, but at the cost of increased computation, use the eraPn00a function.  For the utmost accuracy, use the eraPn00 function, where the nutation components are caller-specified.</p></li><li><p>The mean obliquity is consistent with the IAU 2000 precession.</p></li><li><p>The matrix rb transforms vectors from GCRS to J2000.0 mean equator and equinox by applying frame bias.</p></li><li><p>The matrix rp transforms vectors from J2000.0 mean equator and equinox to mean equator and equinox of date by applying precession.</p></li><li><p>The matrix rbp transforms vectors from GCRS to mean equator and equinox of date by applying frame bias then precession.  It is the product rp x rb.</p></li><li><p>The matrix rn transforms vectors from mean equator and equinox of date to true equator and equinox of date by applying the nutation (luni-solar + planetary).</p></li><li><p>The matrix rbpn transforms vectors from GCRS to true equator and equinox of date.  It is the product rn x rbp, applying frame bias, precession and nutation in that order.</p></li><li><p>The X,Y,Z coordinates of the IAU 2000B Celestial Intermediate Pole are elements (3,1-3) of the GCRS-to-true matrix, i.e. rbpn[2][0-2].</p></li><li><p>It is permissible to re-use the same array in the returned  arguments.  The arrays are filled in the stated order.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Chapront, J., Lambert, S. and Wallace, P., &quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003).</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L2944-L3029">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pn06" href="#AstroCouch.SOFA.pn06"><code>AstroCouch.SOFA.pn06</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pn06(day1::Float64, day2::Float64, δψ::Float64, δϵ::Float64)</code></pre><p>Precession-nutation, IAU 2006 model: a multi-purpose function, supporting classical (equinox-based) use directly and CIO-based use indirectly.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li><li><code>dpsi</code>  – nutation (Note 2)</li><li><code>deps</code>  – nutation (Note 2)</li></ul><p><strong>Output</strong></p><ul><li><code>epsa</code>  – mean obliquity (Note 3)</li><li><code>rb</code>    – frame bias matrix (Note 4)</li><li><code>rp</code>    – precession matrix (Note 5)</li><li><code>rbp</code>   – bias-precession matrix (Note 6)</li><li><code>rn</code>    – nutation matrix (Note 7)</li><li><code>rbpn</code>  – GCRS-to-true matrix (Notes 8,9)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    date1          date2

 2450123.7           0.0       (JD method)
 2451545.0       -1421.3       (J2000 method)
 2400000.5       50123.2       (MJD method)
 2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The caller is responsible for providing the nutation components; they are in longitude and obliquity, in radians and are with respect to the equinox and ecliptic of date.  For high-accuracy applications, free core nutation should be included as well as any other relevant corrections to the position of the CIP.</p></li><li><p>The returned mean obliquity is consistent with the IAU 2006 precession.</p></li><li><p>The matrix rb transforms vectors from GCRS to J2000.0 mean equator and equinox by applying frame bias.</p></li><li><p>The matrix rp transforms vectors from J2000.0 mean equator and equinox to mean equator and equinox of date by applying precession.</p></li><li><p>The matrix rbp transforms vectors from GCRS to mean equator and equinox of date by applying frame bias then precession.  It is the product rp x rb.</p></li><li><p>The matrix rn transforms vectors from mean equator and equinox of date to true equator and equinox of date by applying the nutation (luni-solar + planetary).</p></li><li><p>The matrix rbpn transforms vectors from GCRS to true equator and equinox of date.  It is the product rn x rbp, applying frame bias, precession and nutation in that order.</p></li><li><p>The X,Y,Z coordinates of the Celestial Intermediate Pole are elements (3,1-3) of the GCRS-to-true matrix, i.e. rbpn[2][0-2].</p></li><li><p>It is permissible to re-use the same array in the returned  arguments.  The arrays are filled in the stated order.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p><p>Wallace, P.T. &amp; Capitaine, N., 2006, Astron.Astrophys. 459, 981</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3036-L3118">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pn06a" href="#AstroCouch.SOFA.pn06a"><code>AstroCouch.SOFA.pn06a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pn06a(day1::Float64, day2::Float64)</code></pre><p>Precession-nutation, IAU 2006/2000A models: a multi-purpose function, supporting classical (equinox-based) use directly and CIO-based use indirectly.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>dpsi, deps</code> – nutation (Note 2)</li><li><code>epsa</code>  – mean obliquity (Note 3)</li><li><code>rb</code>    – frame bias matrix (Note 4)</li><li><code>rp</code>    – precession matrix (Note 5)</li><li><code>rbp</code>   – bias-precession matrix (Note 6)</li><li><code>rn</code>    – nutation matrix (Note 7)</li><li><code>rbpn</code>  – GCRS-to-true matrix (Notes 8,9)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">    date1          date2

 2450123.7           0.0       (JD method)
 2451545.0       -1421.3       (J2000 method)
 2400000.5       50123.2       (MJD method)
 2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The nutation components (luni-solar + planetary, IAU 2000A) in longitude and obliquity are in radians and with respect to the equinox and ecliptic of date.  Free core nutation is omitted; for the utmost accuracy, use the eraPn06 function, where the nutation components are caller-specified.</p></li><li><p>The mean obliquity is consistent with the IAU 2006 precession.</p></li><li><p>The matrix rb transforms vectors from GCRS to mean J2000.0 by applying frame bias.</p></li><li><p>The matrix rp transforms vectors from mean J2000.0 to mean of date by applying precession.</p></li><li><p>The matrix rbp transforms vectors from GCRS to mean of date by applying frame bias then precession.  It is the product rp x rb.</p></li><li><p>The matrix rn transforms vectors from mean of date to true of date by applying the nutation (luni-solar + planetary).</p></li><li><p>The matrix rbpn transforms vectors from GCRS to true of date (CIP/equinox).  It is the product rn x rbp, applying frame bias, precession and nutation in that order.</p></li><li><p>The X,Y,Z coordinates of the IAU 2006/2000A Celestial Intermediate Pole are elements (3,1-3) of the GCRS-to-true matrix, i.e. rbpn[2][0-2].</p></li><li><p>It is permissible to re-use the same array in the returned  arguments.  The arrays are filled in the stated order.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3135-L3212">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pnm00a" href="#AstroCouch.SOFA.pnm00a"><code>AstroCouch.SOFA.pnm00a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pnm00a(day1::Float64, day2::Float64)</code></pre><p>Form the matrix of precession-nutation for a given date (including frame bias), equinox based, IAU 2000A model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rbpn</code>  – bias-precession-nutation matrix (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(date) = rbpn * V(GCRS), where the p-vector V(date) is with respect to the true equatorial triad of date date1+date2 and the p-vector V(GCRS) is with respect to the Geocentric Celestial Reference System (IAU, 2000).</p></li><li><p>A faster, but slightly less accurate, result (about 1 mas) can be obtained by using instead the eraPnm00b function.</p></li></ol><p><strong>References</strong></p><p>IAU: Trans. International Astronomical Union, Vol. XXIVB; Proc.  24th General Assembly, Manchester, UK.  Resolutions B1.3, B1.6.  (2000)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3219-L3268">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pnm00b" href="#AstroCouch.SOFA.pnm00b"><code>AstroCouch.SOFA.pnm00b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pnm00b(day1::Float64, day2::Float64)</code></pre><p>Form the matrix of precession-nutation for a given date (including frame bias), equinox-based, IAU 2000B model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rbpn</code>  – bias-precession-nutation matrix (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(date) = rbpn * V(GCRS), where the p-vector V(date) is with respect to the true equatorial triad of date date1+date2 and the p-vector V(GCRS) is with respect to the Geocentric Celestial Reference System (IAU, 2000).</p></li><li><p>The present function is faster, but slightly less accurate (about 1 mas), than the eraPnm00a function.</p></li></ol><p><strong>References</strong></p><p>IAU: Trans. International Astronomical Union, Vol. XXIVB; Proc.  24th General Assembly, Manchester, UK.  Resolutions B1.3, B1.6.  (2000)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3273-L3321">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pnm06a" href="#AstroCouch.SOFA.pnm06a"><code>AstroCouch.SOFA.pnm06a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pnm06a(day1::Float64, day2::Float64)</code></pre><p>Form the matrix of precession-nutation for a given date (including frame bias), equinox based, IAU 2006 precession and IAU 2000A nutation models.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rbpn</code>  – bias-precession-nutation matrix (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(date) = rbpn * V(GCRS), where the p-vector V(date) is with respect to the true equatorial triad of date date1+date2 and the p-vector V(GCRS) is with respect to the Geocentric Celestial Reference System (IAU, 2000).</p></li></ol><p><strong>References</strong></p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3326-L3371">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pnm80" href="#AstroCouch.SOFA.pnm80"><code>AstroCouch.SOFA.pnm80</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pnm80(day1::Float64, day2::Float64)</code></pre><p>Form the matrix of precession/nutation for a given date, IAU 1976 precession model, IAU 1980 nutation model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rmatpn</code> – combined precession/nutation matrix</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(date) = rmatpn * V(J2000), where the p-vector V(date) is with respect to the true equatorial triad of date date1+date2 and the p-vector V(J2000) is with respect to the mean equatorial triad of epoch J2000.0.</p></li></ol><p><strong>References</strong></p><p>Explanatory Supplement to the Astronomical Almanac, P. Kenneth Seidelmann (ed), University Science Books (1992), Section 3.3 (p145).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3381-L3426">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pr00" href="#AstroCouch.SOFA.pr00"><code>AstroCouch.SOFA.pr00</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pr00(day1::Float64, day2::Float64)</code></pre><p>Precession-rate part of the IAU 2000 precession-nutation models (part of MHB2000).</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>dpsipr, depspr</code> – precession corrections (Notes 2,3)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The precession adjustments are expressed as &quot;nutation components&quot;, corrections in longitude and obliquity with respect to the J2000.0 equinox and ecliptic.</p></li><li><p>Although the precession adjustments are stated to be with respect to Lieske et al. (1977), the MHB2000 model does not specify which set of Euler angles are to be used and how the adjustments are to be applied.  The most literal and straightforward procedure is to adopt the 4-rotation epsilon<em>0, psi</em>A, omega<em>A, xi</em>A option, and to add dpsipr to psi<em>A and depspr to both omega</em>A and eps_A.</p></li><li><p>This is an implementation of one aspect of the IAU 2000A nutation model, formally adopted by the IAU General Assembly in 2000, namely MHB2000 (Mathews et al. 2002).</p></li></ol><p><strong>References</strong></p><p>Lieske, J.H., Lederle, T., Fricke, W. &amp; Morando, B., &quot;Expressions for the precession quantities based upon the IAU (1976) System of Astronomical Constants&quot;, Astron.Astrophys., 58, 1-16 (1977)</p><p>Mathews, P.M., Herring, T.A., Buffet, B.A., &quot;Modeling of nutation and precession New nutation series for nonrigid Earth and insights into the Earth&#39;s interior&quot;, J.Geophys.Res., 107, B4, 2002.  The MHB2000 code itself was obtained on 9th September 2002 from ftp://maia.usno.navy.mil/conv2000/chapter5/IAU2000A.</p><p>Wallace, P.T., &quot;Software for Implementing the IAU 2000 Resolutions&quot;, in IERS Workshop 5.1 (2002).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3472-L3537">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.prec76" href="#AstroCouch.SOFA.prec76"><code>AstroCouch.SOFA.prec76</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prec76(day11::Float64, day12::Float64, day21::Float64, day22::Float64)</code></pre><p>IAU 1976 precession model.</p><p>This function forms the three Euler angles which implement general precession between two dates, using the IAU 1976 model (as for the FK5 catalog).</p><p><strong>Input</strong></p><ul><li><code>day01</code> – TDB starting date (Note 1)</li><li><code>day02</code> – ... starting date</li><li><code>day11</code> – TDB ending date (Note 1)</li><li><code>day12</code> – ... starting date</li></ul><p><strong>Output</strong></p><ul><li><code>zeta</code>  – 1st rotation: radians cw around z</li><li><code>z</code>     – 3rd rotation: radians cw around z</li><li><code>theta</code> – 2nd rotation: radians ccw around y</li></ul><p><strong>Note</strong></p><ol><li><p>The dates date01+date02 and date11+date12 are Julian Dates, apportioned in any convenient way between the arguments daten1 and daten2.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">  daten1        daten2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  The two dates may be expressed using different methods, but at the risk of losing some resolution.</p></li><li><p>The accumulated precession angles zeta, z, theta are expressed through canonical polynomials which are valid only for a limited time span.  In addition, the IAU 1976 precession rate is known to be imperfect.  The absolute accuracy of the present formulation is better than 0.1 arcsec from 1960AD to 2040AD, better than 1 arcsec from 1640AD to 2360AD, and remains below 3 arcsec for the whole of the period 500BC to 3000AD.  The errors exceed 10 arcsec outside the range 1200BC to 3900AD, exceed 100 arcsec outside 4200BC to 5600AD and exceed 1000 arcsec outside 6800BC to 8200AD.</p></li><li><p>The three angles are returned in the conventional order, which is not the same as the order of the corresponding Euler rotations. The precession matrix is R<em>3(-z) x R</em>2(+theta) x R_3(-zeta).</p></li></ol><p><strong>References</strong></p><p>Lieske, J.H., 1979, Astron.Astrophys. 73, 282, equations (6) &amp; (7), p283.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3546-L3609">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.s00" href="#AstroCouch.SOFA.s00"><code>AstroCouch.SOFA.s00</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s00(day1::Float64, day2::Float64, x::Float64, y::Float64)</code></pre><p>The CIO locator s, positioning the Celestial Intermediate Origin on the equator of the Celestial Intermediate Pole, given the CIP&#39;s X,Y coordinates.  Compatible with IAU 2000A precession-nutation.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li><li><code>x, y</code>  – CIP coordinates (Note 3)</li></ul><p><strong>Output</strong></p><ul><li><code>s</code>     – the CIO locator s in radians (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The CIO locator s is the difference between the right ascensions of the same point in two systems: the two systems are the GCRS and the CIP,CIO, and the point is the ascending node of the CIP equator. The quantity s remains below 0.1 arcsecond throughout 1900-2100.</p></li><li><p>The series used to compute s is in fact for s+XY/2, where X and Y are the x and y components of the CIP unit vector; this series is more compact than a direct series for s would be.  This function requires X,Y to be supplied by the caller, who is responsible for providing values that are consistent with the supplied date.</p></li><li><p>The model is consistent with the IAU 2000A precession-nutation.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Chapront, J., Lambert, S. and Wallace, P., &quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial     intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3624-L3687">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.s00a" href="#AstroCouch.SOFA.s00a"><code>AstroCouch.SOFA.s00a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s00a(day1::Float64, day2::Float64)</code></pre><p>The CIO locator s, positioning the Celestial Intermediate Origin on the equator of the Celestial Intermediate Pole, using the IAU 2000A precession-nutation model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>s</code>     – the CIO locator s in radians (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The CIO locator s is the difference between the right ascensions of the same point in two systems.  The two systems are the GCRS and the CIP,CIO, and the point is the ascending node of the CIP equator.  The CIO locator s remains a small fraction of 1 arcsecond throughout 1900-2100.</p></li><li><p>The series used to compute s is in fact for s+XY/2, where X and Y are the x and y components of the CIP unit vector; this series is more compact than a direct series for s would be.  The present function uses the full IAU 2000A nutation model when predicting the CIP position.  Faster results, with no significant loss of accuracy, can be obtained via the function eraS00b, which uses instead the IAU 2000B truncated model.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Chapront, J., Lambert, S. and Wallace, P., &quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3730-L3793">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.s00b" href="#AstroCouch.SOFA.s00b"><code>AstroCouch.SOFA.s00b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s00b(day1::Float64, day2::Float64)</code></pre><p>The CIO locator s, positioning the Celestial Intermediate Origin on the equator of the Celestial Intermediate Pole, using the IAU 2000B precession-nutation model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li>&#39;s&#39;     – the CIO locator s in radians (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The CIO locator s is the difference between the right ascensions of the same point in two systems.  The two systems are the GCRS and the CIP,CIO, and the point is the ascending node of the CIP equator.  The CIO locator s remains a small fraction of 1 arcsecond throughout 1900-2100.</p></li><li><p>The series used to compute s is in fact for s+XY/2, where X and Y are the x and y components of the CIP unit vector; this series is more compact than a direct series for s would be.  The present function uses the IAU 2000B truncated nutation model when predicting the CIP position.  The function eraS00a uses instead the full IAU 2000A model, but with no significant increase in accuracy and at some cost in speed.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Chapront, J., Lambert, S. and Wallace, P., &quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3800-L3863">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.s06" href="#AstroCouch.SOFA.s06"><code>AstroCouch.SOFA.s06</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s06(day1::Float64, day2::Float64, x::Float64, y::Float64)</code></pre><p>The CIO locator s, positioning the Celestial Intermediate Origin on the equator of the Celestial Intermediate Pole, given the CIP&#39;s X,Y coordinates.  Compatible with IAU 2006/2000A precession-nutation.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li><li><code>x, y</code>  – CIP coordinates (Note 3)</li></ul><p><strong>Output</strong></p><ul><li><code>s</code>     – the CIO locator s in radians (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The CIO locator s is the difference between the right ascensions of the same point in two systems: the two systems are the GCRS and the CIP,CIO, and the point is the ascending node of the CIP equator. The quantity s remains below 0.1 arcsecond throughout 1900-2100.</p></li><li><p>The series used to compute s is in fact for s+XY/2, where X and Y are the x and y components of the CIP unit vector; this series is more compact than a direct series for s would be.  This function requires X,Y to be supplied by the caller, who is responsible for providing values that are consistent with the supplied date.</p></li><li><p>The model is consistent with the &quot;P03&quot; precession (Capitaine et al. 2003), adopted by IAU 2006 Resolution 1, 2006, and the IAU 2000A nutation (with P03 adjustments).</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Wallace, P.T. &amp; Chapront, J., 2003, Astron. Astrophys. 432, 355</p><p>McCarthy, D.D., Petit, G. (eds.) 2004, IERS Conventions (2003), IERS Technical Note No. 32, BKG</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3870-L3930">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.s06a" href="#AstroCouch.SOFA.s06a"><code>AstroCouch.SOFA.s06a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">s06a(day1::Float64, day2::Float64)</code></pre><p>The CIO locator s, positioning the Celestial Intermediate Origin on the equator of the Celestial Intermediate Pole, using the IAU 2006 precession and IAU 2000A nutation models.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>s</code>     – the CIO locator s in radians (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The CIO locator s is the difference between the right ascensions of the same point in two systems.  The two systems are the GCRS and the CIP,CIO, and the point is the ascending node of the CIP equator.  The CIO locator s remains a small fraction of 1 arcsecond throughout 1900-2100.</p></li><li><p>The series used to compute s is in fact for s+XY/2, where X and Y are the x and y components of the CIP unit vector; this series is more compact than a direct series for s would be.  The present function uses the full IAU 2000A nutation model when predicting the CIP position.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Chapront, J., Lambert, S. and Wallace, P., &quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p><p>McCarthy, D. D., Petit, G. (eds.), 2004, IERS Conventions (2003), IERS Technical Note No. 32, BKG</p><p>Wallace, P.T. &amp; Capitaine, N., 2006, Astron.Astrophys. 459, 981</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3973-L4038">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.sp00" href="#AstroCouch.SOFA.sp00"><code>AstroCouch.SOFA.sp00</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sp00(day1::Float64, day2::Float64)</code></pre><p>The TIO locator s&#39;, positioning the Terrestrial Intermediate Origin on the equator of the Celestial Intermediate Pole.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>s</code>     – the TIO locator s&#39; in radians (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The TIO locator s&#39; is obtained from polar motion observations by numerical integration, and so is in essence unpredictable. However, it is dominated by a secular drift of about 47 microarcseconds per century, which is the approximation evaluated by the present function.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L4045-L4091">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.xy06" href="#AstroCouch.SOFA.xy06"><code>AstroCouch.SOFA.xy06</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xy06(day1::Float64, day2::Float64)</code></pre><p>X,Y coordinates of celestial intermediate pole from series based on IAU 2006 precession and IAU 2000A nutation.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>x, y</code>  – CIP X,Y coordinates (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The X,Y coordinates are those of the unit vector towards the celestial intermediate pole.  They represent the combined effects of frame bias, precession and nutation.</p></li><li><p>The fundamental arguments used are as adopted in IERS Conventions (2003) and are from Simon et al. (1994) and Souchay et al.  (1999).</p></li><li><p>This is an alternative to the angles-based method, via the ERFA function eraFw2xy and as used in eraXys06a for example.  The two methods agree at the 1 microarcsecond level (at present), a negligible amount compared with the intrinsic accuracy of the models.  However, it would be unwise to mix the two methods (angles-based and series-based) in a single application.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N., Wallace, P.T. &amp; Chapront, J., 2003, Astron.Astrophys., 412, 567</p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p><p>McCarthy, D. D., Petit, G. (eds.), 2004, IERS Conventions (2003), IERS Technical Note No. 32, BKG</p><p>Simon, J.L., Bretagnon, P., Chapront, J., Chapront-Touze, M., Francou, G. &amp; Laskar, J., Astron.Astrophys., 1994, 282, 663</p><p>Souchay, J., Loysel, B., Kinoshita, H., Folgueira, M., 1999, Astron.Astrophys.Supp.Ser. 135, 111</p><p>Wallace, P.T. &amp; Capitaine, N., 2006, Astron.Astrophys. 459, 981</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L4096-L4163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.xys00a" href="#AstroCouch.SOFA.xys00a"><code>AstroCouch.SOFA.xys00a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xys00a(day1::Float64, day2::Float64)</code></pre><p>For a given TT date, compute the X,Y coordinates of the Celestial Intermediate Pole and the CIO locator s, using the IAU 2000A precession-nutation model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as a 2-part Julian Date (Note 1)</li><li><code>day2</code>  – TT as a 2-part Julian Date (Note 1)</li></ul><p><strong>Output</strong></p><ul><li><code>x, y</code>  – Celestial Intermediate Pole (Note 2)</li><li><code>s</code>     – the CIO locator s (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The Celestial Intermediate Pole coordinates are the x,y components of the unit vector in the Geocentric Celestial Reference System.</p></li><li><p>The CIO locator s (in radians) positions the Celestial Intermediate Origin on the equator of the CIP.</p></li><li><p>A faster, but slightly less accurate result (about 1 mas for X,Y), can be obtained by using instead the eraXys00b function.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L4222-L4273">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.xys00b" href="#AstroCouch.SOFA.xys00b"><code>AstroCouch.SOFA.xys00b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xys00b(day1::Float64, day2::Float64)</code></pre><p>For a given TT date, compute the X,Y coordinates of the Celestial Intermediate Pole and the CIO locator s, using the IAU 2000B precession-nutation model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>x, y</code>  – Celestial Intermediate Pole (Note 2)</li><li><code>s</code>     – the CIO locator s (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The Celestial Intermediate Pole coordinates are the x,y components of the unit vector in the Geocentric Celestial Reference System.</p></li><li><p>The CIO locator s (in radians) positions the Celestial Intermediate Origin on the equator of the CIP.</p></li><li><p>The present function is faster, but slightly less accurate (about 1 mas in X,Y), than the eraXys00a function.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L4281-L4332">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.xys06a" href="#AstroCouch.SOFA.xys06a"><code>AstroCouch.SOFA.xys06a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">xys06a(day1::Float64, day2::Float64)</code></pre><p>For a given TT date, compute the X,Y coordinates of the Celestial Intermediate Pole and the CIO locator s, using the IAU 2006 precession and IAU 2000A nutation models.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>x, y</code>  – Celestial Intermediate Pole (Note 2)</li><li><code>s</code>     – the CIO locator s (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The Celestial Intermediate Pole coordinates are the x,y components of the unit vector in the Geocentric Celestial Reference System.</p></li><li><p>The CIO locator s (in radians) positions the Celestial Intermediate Origin on the equator of the CIP.</p></li><li><p>Series-based solutions for generating X and Y are also available: see Capitaine &amp; Wallace (2006) and eraXy06.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p><p>Wallace, P.T. &amp; Capitaine, N., 2006, Astron.Astrophys. 459, 981</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L4340-L4392">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.bpn2xy" href="#AstroCouch.SOFA.bpn2xy"><code>AstroCouch.SOFA.bpn2xy</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">bpn2xy(r::Matrix{Float64})</code></pre><p>Extract from the bias-precession-nutation matrix the X,Y coordinates of the Celestial Intermediate Pole.</p><p><strong>Input</strong></p><ul><li><code>rbpn</code>  – celestial-to-true matrix (Note 1)</li></ul><p><strong>Output</strong></p><ul><li><code>x, y</code>  – Celestial Intermediate Pole (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>The matrix rbpn transforms vectors from GCRS to true equator (and CIO or equinox) of date, and therefore the Celestial Intermediate Pole unit vector is the bottom row of the matrix.</p></li><li><p>The arguments x,y are components of the Celestial Intermediate Pole unit vector in the Geocentric Celestial Reference System.</p></li></ol><p><strong>References</strong></p><p>&quot;Expressions for the Celestial Intermediate Pole and Celestial Ephemeris Origin consistent with the IAU 2000A precession- nutation model&quot;, Astron.Astrophys. 400, 1145-1154 (2003)</p><p>n.b. The celestial ephemeris origin (CEO) was renamed &quot;celestial      intermediate origin&quot; (CIO) by IAU 2006 Resolution 2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L195-L226">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2tcio" href="#AstroCouch.SOFA.c2tcio"><code>AstroCouch.SOFA.c2tcio</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2tcio(c2i::Matrix{Float64}, era::Float64, pm::Matrix{Float64}) = pm*Rz(era)*c2i</code></pre><p>Assemble the celestial to terrestrial matrix from CIO-based components (the celestial-to-intermediate matrix, the Earth Rotation Angle and the polar motion matrix).</p><p><strong>Input</strong></p><ul><li><code>rc2i</code>  – celestial-to-intermediate matrix</li><li><code>era</code>   – Earth rotation angle (radians)</li><li><code>rpom</code>  – polar-motion matrix</li></ul><p><strong>Output</strong></p><ul><li><code>rc2t</code>  – celestial-to-terrestrial matrix</li></ul><p><strong>Note</strong></p><ol><li><p>This function constructs the rotation matrix that transforms vectors in the celestial system into vectors in the terrestrial system.  It does so starting from precomputed components, namely the matrix which rotates from celestial coordinates to the intermediate frame, the Earth rotation angle and the polar motion matrix.  One use of the present function is when generating a series of celestial-to-terrestrial matrices where only the Earth Rotation Angle changes, avoiding the considerable overhead of recomputing the precession-nutation more often than necessary to achieve given accuracy objectives.</p></li><li><p>The relationship between the arguments is as follows:</p><p>[TRS] = RPOM * R_3(ERA) * rc2i * [CRS]</p><pre><code class="nohighlight hljs">     = rc2t * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003).</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), 2004, IERS Conventions (2003), IERS Technical Note No. 32, BKG</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L819-L863">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.c2teqx" href="#AstroCouch.SOFA.c2teqx"><code>AstroCouch.SOFA.c2teqx</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">c2teqx(bpn::Matrix{Float64}, gst::Float64, pm::Matrix{Float64}) = pm*Rz(gst)*bpn</code></pre><p>Assemble the celestial to terrestrial matrix from equinox-based components (the celestial-to-true matrix, the Greenwich Apparent Sidereal Time and the polar motion matrix).</p><p><strong>Input</strong></p><ul><li><code>rbpn</code>  – celestial-to-true matrix</li><li><code>gst</code>   – Greenwich (apparent) Sidereal Time (radians)</li><li><code>rpom</code>  – polar-motion matrix</li></ul><p><strong>Output</strong></p><ul><li><code>rc2t</code>  – celestial-to-terrestrial matrix (Note 2)</li></ul><p><strong>Note</strong></p><ol><li><p>This function constructs the rotation matrix that transforms vectors in the celestial system into vectors in the terrestrial system.  It does so starting from precomputed components, namely the matrix which rotates from celestial coordinates to the true equator and equinox of date, the Greenwich Apparent Sidereal Time and the polar motion matrix.  One use of the present function is when generating a series of celestial-to-terrestrial matrices where only the Sidereal Time changes, avoiding the considerable overhead of recomputing the precession-nutation more often than necessary to achieve given accuracy objectives.</p></li><li><p>The relationship between the arguments is as follows:</p><p>[TRS] = rpom * R_3(gst) * rbpn * [CRS]</p><pre><code class="nohighlight hljs">     = rc2t * [CRS]</code></pre><p>where [CRS] is a vector in the Geocentric Celestial Reference System and [TRS] is a vector in the International Terrestrial Reference System (see IERS Conventions 2003).</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L866-L910">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.fw2m" href="#AstroCouch.SOFA.fw2m"><code>AstroCouch.SOFA.fw2m</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fw2m(γ::Float64, ϕ::Float64, ψ::Float64, ϵ::Float64)</code></pre><p>Form rotation matrix given the Fukushima-Williams angles.</p><p><strong>Input</strong></p><ul><li><code>γb</code>    – F-W angle γ_bar (radians)</li><li><code>ϕb</code>    – F-W angle ϕ_bar (radians)</li><li><code>ψ</code>     – F-W angle ψ (radians)</li><li><code>ϵ</code>     – F-W angle ϵ (radians)</li></ul><p><strong>Output</strong></p><ul><li><code>r</code>     – rotation matrix</li></ul><p><strong>Note</strong></p><ol><li><p>Naming the following points:</p><pre><code class="nohighlight hljs">  e = J2000.0 ecliptic pole,
  p = GCRS pole,
  E = ecliptic pole of date,</code></pre><p>and   P = CIP,</p><p>the four Fukushima-Williams angles are as follows:</p><p>γb = γ = epE    ϕb = ϕ = pE    ψ  = ψ = pEP    ϵ  = ϵ = EP</p></li><li><p>The matrix representing the combined effects of frame bias, precession and nutation is:</p><p>NxPxB = R<em>1(-ϵ).R</em>3(-ψ).R<em>1(ϕb).R</em>3(γb)</p></li><li><p>The present function can construct three different matrices, depending on which angles are supplied as the arguments gamb, ϕb, ψ and ϵ:</p><p>o To obtain the nutation x precession x frame bias matrix, first    generate the four precession angles known conventionally as    γ<em>bar, ϕ</em>bar, ψ<em>bar and ϵ</em>A, then generate the nutation    components Dψ and Dϵ and add them to ψ<em>bar and ϵ</em>A, and finally    call the present function using those four angles as arguments.</p><p>o To obtain the precession x frame bias matrix, generate the four    precession angles and call the present function.</p><p>o To obtain the frame bias matrix, generate the four precession    angles for date J2000.0 and call the present function. The    nutation-only and precession-only matrices can if necessary be    obtained by combining these three appropriately.</p></li></ol><p><strong>References</strong></p><p>Capitaine, N. &amp; Wallace, P.T., 2006, Astron.Astrophys. 450, 855</p><p>Hilton, J. et al., 2006, Celest.Mech.Dyn.Astron. 94, 351</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1167-L1227">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.num00a" href="#AstroCouch.SOFA.num00a"><code>AstroCouch.SOFA.num00a</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">num00a(day1::Float64, day2::Float64)</code></pre><p>Form the matrix of nutation for a given date, IAU 2000A model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... as Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rmatn</code> – nutation matrix</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(true) = rmatn * V(mean), where the p-vector V(true) is with respect to the true equatorial triad of date and the p-vector V(mean) is with respect to the mean equatorial triad of date.</p></li><li><p>A faster, but slightly less accurate, result (about 1 mas) can be obtained by using instead the eraNum00b function.</p></li></ol><p><strong>References</strong></p><p>Explanatory Supplement to the Astronomical Almanac, P. Kenneth Seidelmann (ed), University Science Books (1992), Section 3.222-3 (p114).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1469-L1517">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.num00b" href="#AstroCouch.SOFA.num00b"><code>AstroCouch.SOFA.num00b</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">num00b(day1::Float64, day2::Float64)</code></pre><p>Form the matrix of nutation for a given date, IAU 2000B model.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT as Julian Date (Note 1)</li><li><code>day2</code>  – ... Julian Date</li></ul><p><strong>Output</strong></p><ul><li><code>rmatn</code> – nutation matrix</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.</p></li><li><p>The matrix operates in the sense V(true) = rmatn * V(mean), where the p-vector V(true) is with respect to the true equatorial triad of date and the p-vector V(mean) is with respect to the mean equatorial triad of date.</p></li><li><p>The present function is faster, but slightly less accurate (about 1 mas), than the eraNum00a function.</p></li></ol><p><strong>References</strong></p><p>Explanatory Supplement to the Astronomical Almanac, P. Kenneth Seidelmann (ed), University Science Books (1992), Section 3.222-3 (p114).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L1520-L1568">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pom00" href="#AstroCouch.SOFA.pom00"><code>AstroCouch.SOFA.pom00</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pom00(x::Float64, y::Float64, s::Float64)</code></pre><p>Form the matrix of polar motion for a given date, IAU 2000.</p><p><strong>Input</strong></p><ul><li><code>xp, yp</code> – coordinates of the pole (radians, Note 1)</li><li><code>sp</code>     – the TIO locator s&#39; (radians, Note 2)</li></ul><p><strong>Output</strong></p><ul><li><code>rpom</code>  – polar-motion matrix (Note 3)</li></ul><p><strong>Note</strong></p><ol><li><p>The arguments xp and yp are the coordinates (in radians) of the Celestial Intermediate Pole with respect to the International Terrestrial Reference System (see IERS Conventions 2003), measured along the meridians 0 and 90 deg west respectively.</p></li><li><p>The argument sp is the TIO locator s&#39;, in radians, which positions the Terrestrial Intermediate Origin on the equator.  It is obtained from polar motion observations by numerical integration, and so is in essence unpredictable.  However, it is dominated by a secular drift of about 47 microarcseconds per century, and so can be taken into account by using s&#39; = -47*t, where t is centuries since J2000.0.  The function eraSp00 implements this approximation.</p></li><li><p>The matrix operates in the sense V(TRS) = rpom * V(CIP), meaning that it is the final rotation when computing the pointing direction to a celestial source.</p></li></ol><p><strong>References</strong></p><p>McCarthy, D. D., Petit, G. (eds.), IERS Conventions (2003), IERS Technical Note No. 32, BKG (2004)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/precession.jl#L3432-L3469">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gnomonic/">« Gnomonic</a><a class="docs-footer-nextpage" href="../rotations/">Rotations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 21 October 2025 08:49">Tuesday 21 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
