<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Space Motion · AstroCouch.jl</title><meta name="title" content="Space Motion · AstroCouch.jl"/><meta property="og:title" content="Space Motion · AstroCouch.jl"/><meta property="twitter:title" content="Space Motion · AstroCouch.jl"/><meta name="description" content="Documentation for AstroCouch.jl."/><meta property="og:description" content="Documentation for AstroCouch.jl."/><meta property="twitter:description" content="Documentation for AstroCouch.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">The SOFA sub-package</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../astrometry/">Astrometry</a></li><li><a class="tocitem" href="../calendars/">Calendars</a></li><li><a class="tocitem" href="../coefficients/">Coefficients</a></li><li><a class="tocitem" href="../ecliptic/">Ecliptic</a></li><li><a class="tocitem" href="../ephemerides/">Ephemerides</a></li><li><a class="tocitem" href="../equatorial/">Equatorial</a></li><li><a class="tocitem" href="../galactic/">Galactic</a></li><li><a class="tocitem" href="../geocentric/">Geocentric</a></li><li><a class="tocitem" href="../gnomonic/">Gnomonic</a></li><li><a class="tocitem" href="../precession/">Precession</a></li><li><a class="tocitem" href="../rotations/">Rotations</a></li><li class="is-active"><a class="tocitem" href>Space Motion</a></li><li><a class="tocitem" href="../starcatalogs/">Star Catalogs</a></li><li><a class="tocitem" href="../timescales/">Timescales</a></li><li><a class="tocitem" href="../vectorops/">Vectorops</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">The SOFA sub-package</a></li><li class="is-active"><a href>Space Motion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Space Motion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tamasgal/AstroCouch.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tamasgal/AstroCouch.jl/blob/main/docs/src/SOFA/spacemotion.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="spacemotion.jl"><a class="docs-heading-anchor" href="#spacemotion.jl">spacemotion.jl</a><a id="spacemotion.jl-1"></a><a class="docs-heading-anchor-permalink" href="#spacemotion.jl" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.pvstar" href="#AstroCouch.SOFA.pvstar"><code>AstroCouch.SOFA.pvstar</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">pvstar(pv::Vector{Vector{Float64}})</code></pre><p>Convert star position &amp; velocity vector to catalog coordinates.</p><p><strong>Input (Note 1)</strong></p><ul><li><code>pv</code>  – pv-vector (AU, AU/day)</li></ul><p><strong>Output (Note 2)</strong></p><ul><li><code>ra</code>  – right ascension (radians)</li><li><code>dec</code> – declination (radians)</li><li><code>pmr</code> – RA proper motion (radians/year)</li><li><code>pmd</code> – Dec proper motion (radians/year)</li><li><code>px</code>  – parallax (arcsec)</li><li><code>rv</code>  – radial velocity (km/s, positive = receding)</li></ul><p><strong>Note</strong></p><ol><li><p>The specified pv-vector is the coordinate direction (and its rate of change) for the date at which the light leaving the star reached the solar-system barycenter.</p></li><li><p>The star data returned by this function are &quot;observables&quot; for an imaginary observer at the solar-system barycenter.  Proper motion and radial velocity are, strictly, in terms of barycentric coordinate time, TCB.  For most practical applications, it is permissible to neglect the distinction between TCB and ordinary &quot;proper&quot; time on Earth (TT/TAI).  The result will, as a rule, be limited by the intrinsic accuracy of the proper-motion and radial-velocity data; moreover, the supplied pv-vector is likely to be merely an intermediate result (for example generated by the function eraStarpv), so that a change of time unit will cancel out overall.</p><p>In accordance with normal star-catalog conventions, the object&#39;s right ascension and declination are freed from the effects of secular aberration.  The frame, which is aligned to the catalog equator and equinox, is Lorentzian and centered on the SSB.</p><p>Summarizing, the specified pv-vector is for most stars almost identical to the result of applying the standard geometrical &quot;space motion&quot; transformation to the catalog data.  The differences, which are the subject of the Stumpff paper cited below, are:</p><p>(i) In stars with significant radial velocity and proper motion, the constantly changing light-time distorts the apparent proper motion.  Note that this is a classical, not a relativistic, effect.</p><p>(ii) The transformation complies with special relativity.</p></li><li><p>Care is needed with units.  The star coordinates are in radians and the proper motions in radians per Julian year, but the parallax is in arcseconds; the radial velocity is in km/s, but the pv-vector result is in au and au/day.</p></li><li><p>The proper motions are the rate of change of the right ascension and declination at the catalog epoch and are in radians per Julian year.  The RA proper motion is in terms of coordinate angle, not true angle, and will thus be numerically larger at high declinations.</p></li><li><p>Straight-line motion at constant speed in the inertial frame is assumed.  If the speed is greater than or equal to the speed of light, the function aborts with an error status.</p></li><li><p>The inverse transformation is performed by the function <code>starpv</code>.</p></li></ol><p><strong>References</strong></p><p>Stumpff, P., 1985, Astron.Astrophys. 144, 232-240.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/spacemotion.jl#L3-L75">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.starpv" href="#AstroCouch.SOFA.starpv"><code>AstroCouch.SOFA.starpv</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">starpv(ras::Float64, dec::Float64, pmras::Float64, pmdec::Float64,
       plx::Float64, rvel::Float64)</code></pre><p>Convert star catalog coordinates to position+velocity vector.</p><p><strong>Input (Note 1)</strong></p><ul><li><code>ra</code>  – right ascension (radians)</li><li><code>dec</code> – declination (radians)</li><li><code>pmr</code> – RA proper motion (radians/year)</li><li><code>pmd</code> – Dec proper motion (radians/year)</li><li><code>px</code>  – parallax (arcseconds)</li><li><code>rv</code>  – radial velocity (km/s, positive = receding)</li></ul><p><strong>Output (Note 2)</strong></p><ul><li><code>pv</code> – pv-vector (au, au/day)</li></ul><p><strong>Note</strong></p><ol><li><p>The star data accepted by this function are &quot;observables&quot; for an imaginary observer at the solar-system barycenter.  Proper motion and radial velocity are, strictly, in terms of barycentric coordinate time, TCB.  For most practical applications, it is permissible to neglect the distinction between TCB and ordinary &quot;proper&quot; time on Earth (TT/TAI).  The result will, as a rule, be limited by the intrinsic accuracy of the proper-motion and radial-velocity data; moreover, the pv-vector is likely to be merely an intermediate result, so that a change of time unit would cancel out overall.</p><p>In accordance with normal star-catalog conventions, the object&#39;s right ascension and declination are freed from the effects of secular aberration.  The frame, which is aligned to the catalog equator and equinox, is Lorentzian and centered on the SSB.</p></li><li><p>The resulting position and velocity pv-vector is with respect to the same frame and, like the catalog coordinates, is freed from the effects of secular aberration.  Should the &quot;coordinate direction&quot;, where the object was located at the catalog epoch, be required, it may be obtained by calculating the magnitude of the position vector pv[1][1:3] dividing by the speed of light in au/day to give the light-time, and then multiplying the space velocity pv[2][1:3] by this light-time and adding the result to pv[1][1:3].</p><p>Summarizing, the pv-vector returned is for most stars almost identical to the result of applying the standard geometrical &quot;space motion&quot; transformation.  The differences, which are the subject of the Stumpff paper referenced below, are:</p><p>(i) In stars with significant radial velocity and proper motion, the constantly changing light-time distorts the apparent proper motion.  Note that this is a classical, not a relativistic, effect.</p><p>(ii) The transformation complies with special relativity.</p></li><li><p>Care is needed with units.  The star coordinates are in radians and the proper motions in radians per Julian year, but the parallax is in arcseconds; the radial velocity is in km/s, but the pv-vector result is in au and au/day.</p></li><li><p>The RA proper motion is in terms of coordinate angle, not true angle.  If the catalog uses arcseconds for both RA and Dec proper motions, the RA proper motion will need to be divided by cos(Dec) before use.</p></li><li><p>Straight-line motion at constant speed, in the inertial frame, is assumed.</p></li><li><p>An extremely small (or zero or negative) parallax is interpreted to mean that the object is on the &quot;celestial sphere&quot;, the radius of which is an arbitrary (large) value (see the constant PXMIN).  When the distance is overridden in this way, the status, initially zero, has 1 added to it.</p></li><li><p>If the space velocity is a significant fraction of c (see the constant VMAX), it is arbitrarily set to zero.  When this action occurs, 2 is added to the status.</p></li><li><p>The relativistic adjustment involves an iterative calculation.  If the process fails to converge within a set number (IMAX) of iterations, 4 is added to the status.</p></li><li><p>The inverse transformation is performed by the function <code>pvstar</code>.</p></li></ol><p><strong>References</strong></p><p>Stumpff, P., 1985, Astron.Astrophys. 144, 232-240.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/spacemotion.jl#L103-L192">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../rotations/">« Rotations</a><a class="docs-footer-nextpage" href="../starcatalogs/">Star Catalogs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 21 October 2025 08:49">Tuesday 21 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
