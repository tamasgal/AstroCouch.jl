<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Ephemerides · AstroCouch.jl</title><meta name="title" content="Ephemerides · AstroCouch.jl"/><meta property="og:title" content="Ephemerides · AstroCouch.jl"/><meta property="twitter:title" content="Ephemerides · AstroCouch.jl"/><meta name="description" content="Documentation for AstroCouch.jl."/><meta property="og:description" content="Documentation for AstroCouch.jl."/><meta property="twitter:description" content="Documentation for AstroCouch.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">The SOFA sub-package</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../">Introduction</a></li><li><a class="tocitem" href="../astrometry/">Astrometry</a></li><li><a class="tocitem" href="../calendars/">Calendars</a></li><li><a class="tocitem" href="../coefficients/">Coefficients</a></li><li><a class="tocitem" href="../ecliptic/">Ecliptic</a></li><li class="is-active"><a class="tocitem" href>Ephemerides</a></li><li><a class="tocitem" href="../equatorial/">Equatorial</a></li><li><a class="tocitem" href="../galactic/">Galactic</a></li><li><a class="tocitem" href="../geocentric/">Geocentric</a></li><li><a class="tocitem" href="../gnomonic/">Gnomonic</a></li><li><a class="tocitem" href="../precession/">Precession</a></li><li><a class="tocitem" href="../rotations/">Rotations</a></li><li><a class="tocitem" href="../spacemotion/">Space Motion</a></li><li><a class="tocitem" href="../starcatalogs/">Star Catalogs</a></li><li><a class="tocitem" href="../timescales/">Timescales</a></li><li><a class="tocitem" href="../vectorops/">Vectorops</a></li></ul></li><li><a class="tocitem" href="../../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">The SOFA sub-package</a></li><li class="is-active"><a href>Ephemerides</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Ephemerides</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/tamasgal/AstroCouch.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/tamasgal/AstroCouch.jl/blob/main/docs/src/SOFA/ephemerides.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="ephemerides.jl"><a class="docs-heading-anchor" href="#ephemerides.jl">ephemerides.jl</a><a id="ephemerides.jl-1"></a><a class="docs-heading-anchor-permalink" href="#ephemerides.jl" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.epv00" href="#AstroCouch.SOFA.epv00"><code>AstroCouch.SOFA.epv00</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">epv00(day1::Float64, day2::Float64)</code></pre><p>Earth position and velocity, heliocentric and barycentric, with respect to the Barycentric Celestial Reference System.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TDB date (Note 1)</li><li><code>day2</code>  – TDB date (Note 1)</li></ul><p><strong>Output</strong></p><ul><li><code>pvh</code>   – heliocentric Earth position/velocity</li><li><code>pvb</code>   – barycentric Earth position/velocity</li></ul><p><strong>Note</strong></p><ol><li><p>The TDB date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  However, the accuracy of the result is more likely to be limited by the algorithm itself than the way the date has been expressed.</p><p>n.b. TT can be used instead of TDB in most applications.</p></li><li><p>On return, the arrays pvh and pvb contain the following:</p><p>pvh[0][0]  x       }    pvh[0][1]  y       } heliocentric position, au    pvh[0][2]  z       }</p><p>pvh[1][0]  xdot    }    pvh[1][1]  ydot    } heliocentric velocity, au/d    pvh[1][2]  zdot    }</p><p>pvb[0][0]  x       }    pvb[0][1]  y       } barycentric position, au    pvb[0][2]  z       }</p><p>pvb[1][0]  xdot    }    pvb[1][1]  ydot    } barycentric velocity, au/d    pvb[1][2]  zdot    }</p><p>The vectors are with respect to the Barycentric Celestial Reference System.  The time unit is one day in TDB.</p></li><li><p>The function is a SIMPLIFIED SOLUTION from the planetary theory VSOP2000 (X. Moisson, P. Bretagnon, 2001, Celes. Mechanics &amp; Dyn. Astron., 80, 3/4, 205-213) and is an adaptation of original Fortran code supplied by P. Bretagnon (private comm., 2000).</p></li><li><p>Comparisons over the time span 1900-2100 with this simplified solution and the JPL DE405 ephemeris give the following results:</p><pre><code class="nohighlight hljs">                       RMS    max
  Heliocentric:
     position error    3.7   11.2   km
     velocity error    1.4    5.0   mm/s

  Barycentric:
     position error    4.6   13.4   km
     velocity error    1.4    4.9   mm/s</code></pre><p>Comparisons with the JPL DE406 ephemeris show that by 1800 and 2200 the position errors are approximately double their 1900-2100 size. By 1500 and 2500 the deterioration is a factor of 10 and by 1000 and 3000 a factor of 60.  The velocity accuracy falls off at about half that rate.</p></li><li><p>It is permissible to use the same array for pvh and pvb, which will receive the barycentric values.</p></li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/ephemerides.jl#L3-L90">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.moon98" href="#AstroCouch.SOFA.moon98"><code>AstroCouch.SOFA.moon98</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">moon98(day1::Float64, day2::Float64)</code></pre><p>Approximate geocentric position and velocity of the Moon.</p><p>n.b. Not IAU-endorsed and without canonical status.</p><p><strong>Input</strong></p><ul><li><code>day1</code>  – TT date part A (Notes 1,4)</li><li><code>day2</code>  – TT date part B (Notes 1,4)</li></ul><p><strong>Output</strong></p><ul><li><code>pv</code>    – Moon p,v, GCRS (AU, AU/d, Note 5)</li></ul><p><strong>Note</strong></p><ol><li><p>The TT date date1+date2 is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TT)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  The limited accuracy of the present algorithm is such that any of the methods is satisfactory.</p></li><li><p>This function is a full implementation of the algorithm published by Meeus (see reference) except that the light-time correction to the Moon&#39;s mean longitude has been omitted.</p></li><li><p>Comparisons with ELP/MPP02 over the interval 1950-2100 gave RMS errors of 2.9 arcsec in geocentric direction, 6.1 km in position and 36 mm/s in velocity.  The worst case errors were 18.3 arcsec in geocentric direction, 31.7 km in position and 172 mm/s in velocity.</p></li><li><p>The original algorithm is expressed in terms of &quot;dynamical time&quot;, which can either be TDB or TT without any significant change in accuracy.  UT cannot be used without incurring significant errors (30 arcsec in the present era) due to the Moon&#39;s 0.5 arcsec/sec movement.</p></li><li><p>The result is with respect to the GCRS (the same as J2000.0 mean equator and equinox to within 23 mas).</p></li><li><p>Velocity is obtained by a complete analytical differentiation of the Meeus model.</p></li><li><p>The Meeus algorithm generates position and velocity in mean ecliptic coordinates of date, which the present function then rotates into GCRS.  Because the ecliptic system is precessing, there is a coupling between this spin (about 1.4 degrees per century) and the Moon position that produces a small velocity contribution.  In the present function this effect is neglected as it corresponds to a maximum difference of less than 3 mm/s and increases the RMS error by only 0.4%.</p></li></ol><p><strong>References</strong></p><p>Meeus, J., Astronomical Algorithms, 2nd edition, Willmann-Bell, 1998, p337.</p><p>Simon, J.L., Bretagnon, P., Chapront, J., Chapront-Touze, M., Francou, G. &amp; Laskar, J., Astron.Astrophys., 1994, 282, 663</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/ephemerides.jl#L118-L194">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="AstroCouch.SOFA.plan94" href="#AstroCouch.SOFA.plan94"><code>AstroCouch.SOFA.plan94</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">plan94(day1::Float64, day2::Float64, planet::Int)</code></pre><p>Approximate heliocentric position and velocity of a nominated major planet: Mercury, Venus, EMB, Mars, Jupiter, Saturn, Uranus or Neptune (but not the Earth itself).</p><p>n.b. Not IAU-endorsed and without canonical status.</p><p><strong>Input</strong></p><ul><li><code>day1</code>   – TDB date part A (Note 1)</li><li><code>day2</code>   – TDB date part B (Note 1)</li><li><code>planet</code> – planet (1=Mercury, 2=Venus, 3=EMB, 4=Mars, 5=Jupiter, 6=Saturn,                     7=Uranus, 8=Neptune)</li></ul><p><strong>Output</strong></p><ul><li><code>pv</code>     – planet p,v (heliocentric, J2000.0, au,au/d)</li></ul><p><strong>Note</strong></p><ol><li><p>The date date1+date2 is in the TDB time scale (in practice TT can be used) and is a Julian Date, apportioned in any convenient way between the two arguments.  For example, JD(TDB)=2450123.7 could be expressed in any of these ways, among others:</p><pre><code class="nohighlight hljs">   date1          date2

2450123.7           0.0       (JD method)
2451545.0       -1421.3       (J2000 method)
2400000.5       50123.2       (MJD method)
2450123.5           0.2       (date &amp; time method)</code></pre><p>The JD method is the most natural and convenient to use in cases where the loss of several decimal digits of resolution is acceptable.  The J2000 method is best matched to the way the argument is handled internally and will deliver the optimum resolution.  The MJD method and the date &amp; time methods are both good compromises between resolution and convenience.  The limited accuracy of the present algorithm is such that any of the methods is satisfactory.</p></li><li><p>If an np value outside the range 1-8 is supplied, an error status (function value -1) is returned and the pv vector set to zeroes.</p></li><li><p>For np=3 the result is for the Earth-Moon Barycenter.  To obtain the heliocentric position and velocity of the Earth, use instead the ERFA function eraEpv00.</p></li><li><p>On successful return, the array pv contains the following:</p><p>pv[0][0]   x      }    pv[0][1]   y      } heliocentric position, au    pv[0][2]   z      }</p><p>pv[1][0]   xdot   }    pv[1][1]   ydot   } heliocentric velocity, au/d    pv[1][2]   zdot   }</p><p>The reference frame is equatorial and is with respect to the mean equator and equinox of epoch J2000.0.</p></li><li><p>The algorithm is due to J.L. Simon, P. Bretagnon, J. Chapront, M. Chapront-Touze, G. Francou and J. Laskar (Bureau des Longitudes, Paris, France).  From comparisons with JPL ephemeris DE102, they quote the following maximum errors over the interval 1800-2050:</p><pre><code class="nohighlight hljs">            L (arcsec)    B (arcsec)      R (km)</code></pre><p>Mercury          4             1             300    Venus            5             1             800    EMB              6             1            1000    Mars            17             1            7700    Jupiter         71             5           76000    Saturn          81            13          267000    Uranus          86             7          712000    Neptune         11             1          253000</p><p>Over the interval 1000-3000, they report that the accuracy is no worse than 1.5 times that over 1800-2050.  Outside 1000-3000 the accuracy declines.</p><p>Comparisons of the present function with the JPL DE200 ephemeris give the following RMS errors over the interval 1960-2025:</p><pre><code class="nohighlight hljs">             position (km)     velocity (m/s)</code></pre><p>Mercury            334               0.437    Venus             1060               0.855    EMB               2010               0.815    Mars              7690               1.98    Jupiter          71700               7.70    Saturn          199000              19.4    Uranus          564000              16.4    Neptune         158000              14.4</p><p>Comparisons against DE200 over the interval 1800-2100 gave the following maximum absolute differences.  (The results using DE406 were essentially the same.)</p><pre><code class="nohighlight hljs">          L (arcsec)   B (arcsec)     R (km)   Rdot (m/s)</code></pre><p>Mercury        7            1            500       0.7    Venus          7            1           1100       0.9    EMB            9            1           1300       1.0    Mars          26            1           9000       2.5    Jupiter       78            6          82000       8.2    Saturn        87           14         263000      24.6    Uranus        86            7         661000      27.4    Neptune       11            2         248000      21.4</p></li><li><p>The present ERFA re-implementation of the original Simon et al. Fortran code differs from the original in the following respects:</p><ul><li><p>C instead of Fortran.</p></li><li><p>The date is supplied in two parts.</p></li><li><p>The result is returned only in equatorial Cartesian form;  the ecliptic longitude, latitude and radius vector are not  returned.</p></li><li><p>The result is in the J2000.0 equatorial frame, not ecliptic.</p></li><li><p>More is done in-line: there are fewer calls to subroutines.</p></li><li><p>Different error/warning status values are used.</p></li><li><p>A different Kepler&#39;s-equation-solver is used (avoiding  use of double precision complex).</p></li><li><p>Polynomials in t are nested to minimize rounding errors.</p></li><li><p>Explicit double constants are used to avoid mixed-mode  expressions.</p></li></ul><p>None of the above changes affects the result significantly.</p></li><li><p>The returned status indicates the most serious condition encountered during execution of the function.  Illegal np is considered the most serious, overriding failure to converge, which in turn takes precedence over the remote date warning.</p></li></ol><p><strong>References</strong></p><p>Simon, J.L, Bretagnon, P., Chapront, J., Chapront-Touze, M., Francou, G., and Laskar, J., Astron.Astrophys., 282, 663 (1994).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/tamasgal/AstroCouch.jl/blob/f583c8aa5ded24e11b1e1a8ecba42c99d3bd5657/src/SOFA/ephemerides.jl#L266-L414">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ecliptic/">« Ecliptic</a><a class="docs-footer-nextpage" href="../equatorial/">Equatorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 21 October 2025 08:49">Tuesday 21 October 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
